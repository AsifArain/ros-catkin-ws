<title>gdm_tdlas: QProblem.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">QProblem.cpp</div>  </div>
</div>
<div class="contents">
<a href="QProblem_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *      This file is part of qpOASES.</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> *      qpOASES -- An Implementation of the Online Active Set Strategy.</span>
<a name="l00005"></a>00005 <span class="comment"> *      Copyright (C) 2007-2012 by Hans Joachim Ferreau, Andreas Potschka,</span>
<a name="l00006"></a>00006 <span class="comment"> *      Christian Kirches et al. All rights reserved.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> *      qpOASES is free software; you can redistribute it and/or</span>
<a name="l00009"></a>00009 <span class="comment"> *      modify it under the terms of the GNU Lesser General Public</span>
<a name="l00010"></a>00010 <span class="comment"> *      License as published by the Free Software Foundation; either</span>
<a name="l00011"></a>00011 <span class="comment"> *      version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> *      qpOASES is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment"> *      but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment"> *      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<a name="l00016"></a>00016 <span class="comment"> *      See the GNU Lesser General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"> *</span>
<a name="l00018"></a>00018 <span class="comment"> *      You should have received a copy of the GNU Lesser General Public</span>
<a name="l00019"></a>00019 <span class="comment"> *      License along with qpOASES; if not, write to the Free Software</span>
<a name="l00020"></a>00020 <span class="comment"> *      Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="QProblem_8hpp.html">qpOASES/QProblem.hpp</a>&gt;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="comment">//#define __DEBUG_ITER__</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <a class="code" href="Types_8hpp.html#afd127fcb3c8f47975e9fa0ec2bacde52">BEGIN_NAMESPACE_QPOASES</a>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">/*****************************************************************************</span>
<a name="l00044"></a>00044 <span class="comment"> *  P U B L I C                                                              *</span>
<a name="l00045"></a>00045 <span class="comment"> *****************************************************************************/</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="comment">/*</span>
<a name="l00049"></a>00049 <span class="comment"> *      Q P r o b l e m</span>
<a name="l00050"></a>00050 <span class="comment"> */</span>
<a name="l00051"></a><a class="code" href="classQProblem.html#a616f7620819c532d2d58b4c792478d63">00051</a> <a class="code" href="classQProblem.html#a616f7620819c532d2d58b4c792478d63">QProblem::QProblem</a>( ) : <a class="code" href="classQProblemB.html" title="Implements the online active set strategy for box-constrained QPs.">QProblemB</a>( )
<a name="l00052"></a>00052 {
<a name="l00053"></a>00053         <a class="code" href="classQProblem.html#a3a4b41db599d522b459ac0a6065c346c">freeConstraintMatrix</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l00054"></a>00054         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> = 0;
<a name="l00055"></a>00055 
<a name="l00056"></a>00056         <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a> = 0;
<a name="l00057"></a>00057         <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> = 0;
<a name="l00058"></a>00058 
<a name="l00059"></a>00059         <a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a> = 0;
<a name="l00060"></a>00060         <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> = 0;
<a name="l00061"></a>00061         <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a> = 0;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063         <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a> = 0;
<a name="l00064"></a>00064         <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a> = 0;
<a name="l00065"></a>00065         <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a> = 0;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067         <a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a> = 0;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069         <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a> = 0;
<a name="l00070"></a>00070         <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a> = 0;
<a name="l00071"></a>00071         <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a> = 0;
<a name="l00072"></a>00072         <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a> = 0;
<a name="l00073"></a>00073         <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a> = 0;
<a name="l00074"></a>00074         <a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a> = 0;
<a name="l00075"></a>00075 }
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">/*</span>
<a name="l00079"></a>00079 <span class="comment"> *      Q P r o b l e m</span>
<a name="l00080"></a>00080 <span class="comment"> */</span>
<a name="l00081"></a><a class="code" href="classQProblem.html#a8b1e6daa6aaa78c9948c5c9ca457c81e">00081</a> <a class="code" href="classQProblem.html#a616f7620819c532d2d58b4c792478d63">QProblem::QProblem</a>( <span class="keywordtype">int</span> _nV, <span class="keywordtype">int</span> _nC, <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9">HessianType</a> _hessianType ) : <a class="code" href="classQProblemB.html" title="Implements the online active set strategy for box-constrained QPs.">QProblemB</a>( _nV,_hessianType )
<a name="l00082"></a>00082 {
<a name="l00083"></a>00083         <span class="comment">/* consistency checks */</span>
<a name="l00084"></a>00084         <span class="keywordflow">if</span> ( _nV &lt;= 0 )
<a name="l00085"></a>00085                 _nV = 1;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087         <span class="keywordflow">if</span> ( _nC &lt; 0 )
<a name="l00088"></a>00088         {
<a name="l00089"></a>00089                 _nC = 0;
<a name="l00090"></a>00090                 <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00091"></a>00091         }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093         <span class="keywordflow">if</span> ( _nC &gt; 0 )
<a name="l00094"></a>00094         {
<a name="l00095"></a>00095                 <a class="code" href="classQProblem.html#a3a4b41db599d522b459ac0a6065c346c">freeConstraintMatrix</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l00096"></a>00096                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> = 0;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l00099"></a>00099                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l00100"></a>00100         }
<a name="l00101"></a>00101         <span class="keywordflow">else</span>
<a name="l00102"></a>00102         {
<a name="l00103"></a>00103                 <span class="comment">/* prevent segmentation faults in case nC == 0 </span>
<a name="l00104"></a>00104 <span class="comment">                 * (avoiding checks for A!=0 around all calls to A-&gt;... */</span>
<a name="l00105"></a>00105                 <a class="code" href="classQProblem.html#a3a4b41db599d522b459ac0a6065c346c">freeConstraintMatrix</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l00106"></a>00106                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> = <span class="keyword">new</span> <a class="code" href="classDenseMatrix.html" title="Interfaces matrix-vector operations tailored to general dense matrices.">DenseMatrix</a>( );
<a name="l00107"></a>00107 
<a name="l00108"></a>00108                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a> = 0;
<a name="l00109"></a>00109                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> = 0;
<a name="l00110"></a>00110         }
<a name="l00111"></a>00111 
<a name="l00112"></a>00112         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a953ff0d47d33a2ed94587316a803b978">init</a>( _nC );
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <span class="keyword">delete</span>[] <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>; <span class="comment">/* y of no constraints version too short! */</span>
<a name="l00115"></a>00115         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV+_nC];
<a name="l00116"></a>00116 
<a name="l00117"></a>00117         <a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a> = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a>( _nC,_nV );
<a name="l00118"></a>00118         <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>*<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>];
<a name="l00119"></a>00119         <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV*_nV];
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         <span class="keywordflow">if</span> ( _nC &gt; 0 )
<a name="l00122"></a>00122         {
<a name="l00123"></a>00123                 <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l00124"></a>00124                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l00125"></a>00125                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l00126"></a>00126         }
<a name="l00127"></a>00127         <span class="keywordflow">else</span>
<a name="l00128"></a>00128         {
<a name="l00129"></a>00129                 <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a> = 0;
<a name="l00130"></a>00130                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a> = 0;
<a name="l00131"></a>00131                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a> = 0;
<a name="l00132"></a>00132         }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134         <a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a> = 0;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136         <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV];                        <span class="comment">/* nFR */</span>
<a name="l00137"></a>00137         <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV];       <span class="comment">/* nFR */</span>
<a name="l00138"></a>00138         <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV];           <span class="comment">/* nZ */</span>
<a name="l00139"></a>00139 
<a name="l00140"></a>00140         <span class="keywordflow">if</span> ( _nC &gt; 0 )
<a name="l00141"></a>00141         {
<a name="l00142"></a>00142                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];                        <span class="comment">/* nAC */</span>
<a name="l00143"></a>00143                 <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];           <span class="comment">/* nAC */</span>
<a name="l00144"></a>00144                 <a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];    <span class="comment">/* nAC */</span>
<a name="l00145"></a>00145         }
<a name="l00146"></a>00146         <span class="keywordflow">else</span>
<a name="l00147"></a>00147         {
<a name="l00148"></a>00148                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a> = 0;
<a name="l00149"></a>00149                 <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a> = 0;
<a name="l00150"></a>00150                 <a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a> = 0;
<a name="l00151"></a>00151         }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153         <a class="code" href="classQProblemB.html#afc23c08b6cdc0ca93f9c049e9a318744">flipper</a>.<a class="code" href="classFlipper.html#ab5e31dfda4904925b0884c6aa14c49dc">init</a>( _nV,_nC );
<a name="l00154"></a>00154 }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 <span class="comment">/*</span>
<a name="l00158"></a>00158 <span class="comment"> *      Q P r o b l e m</span>
<a name="l00159"></a>00159 <span class="comment"> */</span>
<a name="l00160"></a><a class="code" href="classQProblem.html#a35ed81509c1ec9cbbb33992257762da3">00160</a> <a class="code" href="classQProblem.html#a616f7620819c532d2d58b4c792478d63">QProblem::QProblem</a>( <span class="keyword">const</span> <a class="code" href="classQProblem.html" title="Implements the online active set strategy for QPs with general constraints.">QProblem</a>&amp; rhs ) : <a class="code" href="classQProblemB.html" title="Implements the online active set strategy for box-constrained QPs.">QProblemB</a>( rhs )
<a name="l00161"></a>00161 {
<a name="l00162"></a>00162         <a class="code" href="classQProblem.html#a3a4b41db599d522b459ac0a6065c346c">freeConstraintMatrix</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l00163"></a>00163         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> = 0;
<a name="l00164"></a>00164 
<a name="l00165"></a>00165         <a class="code" href="classQProblem.html#a368a4cf5e6133a1d851b720487fbb41f">copy</a>( rhs );
<a name="l00166"></a>00166 }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 <span class="comment">/*</span>
<a name="l00170"></a>00170 <span class="comment"> *      ~ Q P r o b l e m</span>
<a name="l00171"></a>00171 <span class="comment"> */</span>
<a name="l00172"></a><a class="code" href="classQProblem.html#aa3b77fe7ac77479aacee421fdeba5bca">00172</a> <a class="code" href="classQProblem.html#aa3b77fe7ac77479aacee421fdeba5bca">QProblem::~QProblem</a>( )
<a name="l00173"></a>00173 {
<a name="l00174"></a>00174         <a class="code" href="classQProblem.html#a9ccceb2ebb31fca9a6892b3da4286308">clear</a>( );
<a name="l00175"></a>00175 }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 <span class="comment">/*</span>
<a name="l00179"></a>00179 <span class="comment"> *      o p e r a t o r =</span>
<a name="l00180"></a>00180 <span class="comment"> */</span>
<a name="l00181"></a><a class="code" href="classQProblem.html#a70c1323e3b23d837b4723a6386f2b1d2">00181</a> <a class="code" href="classQProblem.html" title="Implements the online active set strategy for QPs with general constraints.">QProblem</a>&amp; <a class="code" href="classQProblem.html#a70c1323e3b23d837b4723a6386f2b1d2">QProblem::operator=</a>( <span class="keyword">const</span> <a class="code" href="classQProblem.html" title="Implements the online active set strategy for QPs with general constraints.">QProblem</a>&amp; rhs )
<a name="l00182"></a>00182 {
<a name="l00183"></a>00183         <span class="keywordflow">if</span> ( <span class="keyword">this</span> != &amp;rhs )
<a name="l00184"></a>00184         {
<a name="l00185"></a>00185                 <a class="code" href="classQProblem.html#a9ccceb2ebb31fca9a6892b3da4286308">clear</a>( );
<a name="l00186"></a>00186                 <a class="code" href="classQProblem.html#a70c1323e3b23d837b4723a6386f2b1d2">QProblemB::operator=</a>( rhs );
<a name="l00187"></a>00187                 <a class="code" href="classQProblem.html#a368a4cf5e6133a1d851b720487fbb41f">copy</a>( rhs );
<a name="l00188"></a>00188         }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00191"></a>00191 }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="comment">/*</span>
<a name="l00195"></a>00195 <span class="comment"> *      r e s e t</span>
<a name="l00196"></a>00196 <span class="comment"> */</span>
<a name="l00197"></a><a class="code" href="classQProblem.html#a2f752d39b6935d929b963363a314b6bd">00197</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a2f752d39b6935d929b963363a314b6bd">QProblem::reset</a>( )
<a name="l00198"></a>00198 {
<a name="l00199"></a>00199         <span class="keywordtype">int</span> i;
<a name="l00200"></a>00200         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l00201"></a>00201         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l00202"></a>00202 
<a name="l00203"></a>00203         <span class="keywordflow">if</span> ( nV == 0 )
<a name="l00204"></a>00204                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 
<a name="l00207"></a>00207         <span class="comment">/* 1) Reset bounds, Cholesky decomposition and status flags. */</span>
<a name="l00208"></a>00208         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a975c13e1a8fbe8c3e9c4dfbce9dc9a71">QProblemB::reset</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00209"></a>00209                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eafe6cfacaa204a0d5e63ec9635cc7d80d">RET_RESET_FAILED</a> );
<a name="l00210"></a>00210 
<a name="l00211"></a>00211         <span class="comment">/* 2) Reset constraints. */</span>
<a name="l00212"></a>00212         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a953ff0d47d33a2ed94587316a803b978">init</a>( nC );
<a name="l00213"></a>00213 
<a name="l00214"></a>00214         <span class="comment">/* 3) Reset TQ factorisation. */</span>
<a name="l00215"></a>00215         <span class="keywordflow">for</span>( i=0; i&lt;<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>*<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>; ++i )
<a name="l00216"></a>00216                 <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a>[i] = 0.0;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218         <span class="keywordflow">for</span>( i=0; i&lt;nV*nV; ++i )
<a name="l00219"></a>00219                 <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>[i] = 0.0;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         <span class="comment">/* 4) Reset constraint product pointer. */</span>
<a name="l00222"></a>00222         <a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a> = 0;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 <span class="comment">/*</span>
<a name="l00229"></a>00229 <span class="comment"> *      i n i t</span>
<a name="l00230"></a>00230 <span class="comment"> */</span>
<a name="l00231"></a><a class="code" href="classQProblem.html#aa286539b43de9a08bc18a9d70c799008">00231</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aa286539b43de9a08bc18a9d70c799008">QProblem::init</a>(     <a class="code" href="classSymmetricMatrix.html" title="Abstract base class for interfacing matrix-vector operations tailored to symmetric matrices...">SymmetricMatrix</a> *_H, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _g, <a class="code" href="classMatrix.html" title="Abstract base class for interfacing tailored matrix-vector operations.">Matrix</a> *_A,
<a name="l00232"></a>00232                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lb, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ub,
<a name="l00233"></a>00233                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lbA, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ubA,
<a name="l00234"></a>00234                                                         <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime
<a name="l00235"></a>00235                                                         )
<a name="l00236"></a>00236 {
<a name="l00237"></a>00237         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( ) == 0 )
<a name="l00238"></a>00238                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00239"></a>00239 
<a name="l00240"></a>00240         <span class="comment">/* 1) Consistency check. */</span>
<a name="l00241"></a>00241         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ace7ad79b45cadc772e4824523f633e58">isInitialised</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00242"></a>00242         {
<a name="l00243"></a>00243                 <a class="code" href="MessageHandling_8hpp.html#a733e8e8f13934b6799f96a6dc8185439">THROWWARNING</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea37e621bb9516e08bd37c3767e0fbe168">RET_QP_ALREADY_INITIALISED</a> );
<a name="l00244"></a>00244                 <a class="code" href="classQProblem.html#a2f752d39b6935d929b963363a314b6bd">reset</a>( );
<a name="l00245"></a>00245         }
<a name="l00246"></a>00246 
<a name="l00247"></a>00247         <span class="comment">/* 2) Setup QP data. */</span>
<a name="l00248"></a>00248         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a795e8ecc363ab25f15ffaf12a9ec4040">setupQPdata</a>( _H,_g,_A,_lb,_ub,_lbA,_ubA ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00249"></a>00249                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00250"></a>00250         ;
<a name="l00251"></a>00251         <span class="comment">/* 3) Call to main initialisation routine (without any additional information). */</span>
<a name="l00252"></a>00252         <span class="keywordflow">return</span> <a class="code" href="classQProblem.html#a048bbbe3969ccac99c5278d04dcbdd97">solveInitialQP</a>( 0,0,0,0, nWSR,cputime );
<a name="l00253"></a>00253 }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 <span class="comment">/*</span>
<a name="l00257"></a>00257 <span class="comment"> *      i n i t</span>
<a name="l00258"></a>00258 <span class="comment"> */</span>
<a name="l00259"></a><a class="code" href="classQProblem.html#a1f4f4cd427656ebfeee35cadbf755a4f">00259</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aa286539b43de9a08bc18a9d70c799008">QProblem::init</a>(     <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _H, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _g, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _A,
<a name="l00260"></a>00260                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lb, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ub,
<a name="l00261"></a>00261                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lbA, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ubA,
<a name="l00262"></a>00262                                                         <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime
<a name="l00263"></a>00263                                                         )
<a name="l00264"></a>00264 {
<a name="l00265"></a>00265         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( ) == 0 )
<a name="l00266"></a>00266                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00267"></a>00267 
<a name="l00268"></a>00268         <span class="comment">/* 1) Consistency check. */</span>
<a name="l00269"></a>00269         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ace7ad79b45cadc772e4824523f633e58">isInitialised</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00270"></a>00270         {
<a name="l00271"></a>00271                 <a class="code" href="MessageHandling_8hpp.html#a733e8e8f13934b6799f96a6dc8185439">THROWWARNING</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea37e621bb9516e08bd37c3767e0fbe168">RET_QP_ALREADY_INITIALISED</a> );
<a name="l00272"></a>00272                 <a class="code" href="classQProblem.html#a2f752d39b6935d929b963363a314b6bd">reset</a>( );
<a name="l00273"></a>00273         }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275         <span class="comment">/* 2) Setup QP data. */</span>
<a name="l00276"></a>00276         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a795e8ecc363ab25f15ffaf12a9ec4040">setupQPdata</a>( _H,_g,_A,_lb,_ub,_lbA,_ubA ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00277"></a>00277                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00278"></a>00278 
<a name="l00279"></a>00279         <span class="comment">/* 3) Call to main initialisation routine (without any additional information). */</span>
<a name="l00280"></a>00280         <span class="keywordflow">return</span> <a class="code" href="classQProblem.html#a048bbbe3969ccac99c5278d04dcbdd97">solveInitialQP</a>( 0,0,0,0, nWSR,cputime );
<a name="l00281"></a>00281 }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 
<a name="l00284"></a>00284 <span class="comment">/*</span>
<a name="l00285"></a>00285 <span class="comment"> *      i n i t</span>
<a name="l00286"></a>00286 <span class="comment"> */</span>
<a name="l00287"></a><a class="code" href="classQProblem.html#a268688ad715c38e6f6482e097d33c401">00287</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aa286539b43de9a08bc18a9d70c799008">QProblem::init</a>(     <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> H_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> g_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> A_file,
<a name="l00288"></a>00288                                                         <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lb_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ub_file,
<a name="l00289"></a>00289                                                         <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lbA_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ubA_file,
<a name="l00290"></a>00290                                                         <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime
<a name="l00291"></a>00291                                                         )
<a name="l00292"></a>00292 {
<a name="l00293"></a>00293         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( ) == 0 )
<a name="l00294"></a>00294                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00295"></a>00295 
<a name="l00296"></a>00296         <span class="comment">/* 1) Consistency check. */</span>
<a name="l00297"></a>00297         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ace7ad79b45cadc772e4824523f633e58">isInitialised</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00298"></a>00298         {
<a name="l00299"></a>00299                 <a class="code" href="MessageHandling_8hpp.html#a733e8e8f13934b6799f96a6dc8185439">THROWWARNING</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea37e621bb9516e08bd37c3767e0fbe168">RET_QP_ALREADY_INITIALISED</a> );
<a name="l00300"></a>00300                 <a class="code" href="classQProblem.html#a2f752d39b6935d929b963363a314b6bd">reset</a>( );
<a name="l00301"></a>00301         }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303         <span class="comment">/* 2) Setup QP data from files. */</span>
<a name="l00304"></a>00304         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a080fb229af9e97e338a543de442315d5">setupQPdataFromFile</a>( H_file,g_file,A_file,lb_file,ub_file,lbA_file,ubA_file ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00305"></a>00305                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea75a82ee30ebf002f5f8092258bafa76a">RET_UNABLE_TO_READ_FILE</a> );
<a name="l00306"></a>00306 
<a name="l00307"></a>00307         <span class="comment">/* 3) Call to main initialisation routine (without any additional information). */</span>
<a name="l00308"></a>00308         <span class="keywordflow">return</span> <a class="code" href="classQProblem.html#a048bbbe3969ccac99c5278d04dcbdd97">solveInitialQP</a>( 0,0,0,0, nWSR,cputime );
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 <span class="comment">/*</span>
<a name="l00313"></a>00313 <span class="comment"> *      i n i t</span>
<a name="l00314"></a>00314 <span class="comment"> */</span>
<a name="l00315"></a><a class="code" href="classQProblem.html#a6444fc29c6c81909799476b6e463f752">00315</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aa286539b43de9a08bc18a9d70c799008">QProblem::init</a>( <a class="code" href="classSymmetricMatrix.html" title="Abstract base class for interfacing matrix-vector operations tailored to symmetric matrices...">SymmetricMatrix</a> *_H, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _g, <a class="code" href="classMatrix.html" title="Abstract base class for interfacing tailored matrix-vector operations.">Matrix</a> *_A,
<a name="l00316"></a>00316                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lb, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ub,
<a name="l00317"></a>00317                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lbA, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ubA,
<a name="l00318"></a>00318                                                         <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime,
<a name="l00319"></a>00319                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> xOpt, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> yOpt,
<a name="l00320"></a>00320                                                         <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> guessedBounds, <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> guessedConstraints
<a name="l00321"></a>00321                                                         )
<a name="l00322"></a>00322 {
<a name="l00323"></a>00323         <span class="keywordtype">int</span> i;
<a name="l00324"></a>00324         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l00325"></a>00325         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l00326"></a>00326 
<a name="l00327"></a>00327         <span class="keywordflow">if</span> ( nV == 0 )
<a name="l00328"></a>00328                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00329"></a>00329 
<a name="l00330"></a>00330         <span class="comment">/* 1) Consistency checks. */</span>
<a name="l00331"></a>00331         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ace7ad79b45cadc772e4824523f633e58">isInitialised</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00332"></a>00332         {
<a name="l00333"></a>00333                 <a class="code" href="MessageHandling_8hpp.html#a733e8e8f13934b6799f96a6dc8185439">THROWWARNING</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea37e621bb9516e08bd37c3767e0fbe168">RET_QP_ALREADY_INITIALISED</a> );
<a name="l00334"></a>00334                 <a class="code" href="classQProblem.html#a2f752d39b6935d929b963363a314b6bd">reset</a>( );
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337         <span class="keywordflow">if</span> ( guessedBounds != 0 )
<a name="l00338"></a>00338         {
<a name="l00339"></a>00339                 <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l00340"></a>00340                 {
<a name="l00341"></a>00341                         <span class="keywordflow">if</span> ( guessedBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> )
<a name="l00342"></a>00342                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00343"></a>00343                 }
<a name="l00344"></a>00344         }
<a name="l00345"></a>00345 
<a name="l00346"></a>00346         <span class="keywordflow">if</span> ( guessedConstraints != 0 )
<a name="l00347"></a>00347         {
<a name="l00348"></a>00348                 <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l00349"></a>00349                         <span class="keywordflow">if</span> ( guessedConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> )
<a name="l00350"></a>00350                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353         <span class="comment">/* exclude these possibilities in order to avoid inconsistencies */</span>
<a name="l00354"></a>00354         <span class="keywordflow">if</span> ( ( xOpt == 0 ) &amp;&amp; ( yOpt != 0 ) &amp;&amp; ( ( guessedBounds != 0 ) || ( guessedConstraints != 0 ) ) )
<a name="l00355"></a>00355                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00356"></a>00356 
<a name="l00357"></a>00357         <span class="comment">/* 2) Setup QP data. */</span>
<a name="l00358"></a>00358         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a795e8ecc363ab25f15ffaf12a9ec4040">setupQPdata</a>( _H,_g,_A,_lb,_ub,_lbA,_ubA ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00359"></a>00359                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00360"></a>00360 
<a name="l00361"></a>00361         <span class="comment">/* 3) Call to main initialisation routine. */</span>
<a name="l00362"></a>00362         <span class="keywordflow">return</span> <a class="code" href="classQProblem.html#a048bbbe3969ccac99c5278d04dcbdd97">solveInitialQP</a>( xOpt,yOpt,guessedBounds,guessedConstraints, nWSR,cputime );
<a name="l00363"></a>00363 }
<a name="l00364"></a>00364 
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 <span class="comment">/*</span>
<a name="l00367"></a>00367 <span class="comment"> *      i n i t</span>
<a name="l00368"></a>00368 <span class="comment"> */</span>
<a name="l00369"></a><a class="code" href="classQProblem.html#add3bbe6d97f697be8d097d14008cbbcb">00369</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aa286539b43de9a08bc18a9d70c799008">QProblem::init</a>( <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _H, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _g, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _A,
<a name="l00370"></a>00370                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lb, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ub,
<a name="l00371"></a>00371                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lbA, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ubA,
<a name="l00372"></a>00372                                                         <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime,
<a name="l00373"></a>00373                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> xOpt, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> yOpt,
<a name="l00374"></a>00374                                                         <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> guessedBounds, <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> guessedConstraints
<a name="l00375"></a>00375                                                         )
<a name="l00376"></a>00376 {
<a name="l00377"></a>00377         <span class="keywordtype">int</span> i;
<a name="l00378"></a>00378         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l00379"></a>00379         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l00380"></a>00380 
<a name="l00381"></a>00381         <span class="keywordflow">if</span> ( nV == 0 )
<a name="l00382"></a>00382                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00383"></a>00383 
<a name="l00384"></a>00384         <span class="comment">/* 1) Consistency checks. */</span>
<a name="l00385"></a>00385         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ace7ad79b45cadc772e4824523f633e58">isInitialised</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00386"></a>00386         {
<a name="l00387"></a>00387                 <a class="code" href="MessageHandling_8hpp.html#a733e8e8f13934b6799f96a6dc8185439">THROWWARNING</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea37e621bb9516e08bd37c3767e0fbe168">RET_QP_ALREADY_INITIALISED</a> );
<a name="l00388"></a>00388                 <a class="code" href="classQProblem.html#a2f752d39b6935d929b963363a314b6bd">reset</a>( );
<a name="l00389"></a>00389         }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391         <span class="keywordflow">if</span> ( guessedBounds != 0 )
<a name="l00392"></a>00392         {
<a name="l00393"></a>00393                 <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l00394"></a>00394                 {
<a name="l00395"></a>00395                         <span class="keywordflow">if</span> ( guessedBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> )
<a name="l00396"></a>00396                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00397"></a>00397                 }
<a name="l00398"></a>00398         }
<a name="l00399"></a>00399 
<a name="l00400"></a>00400         <span class="keywordflow">if</span> ( guessedConstraints != 0 )
<a name="l00401"></a>00401         {
<a name="l00402"></a>00402                 <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l00403"></a>00403                         <span class="keywordflow">if</span> ( guessedConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> )
<a name="l00404"></a>00404                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00405"></a>00405         }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407         <span class="comment">/* exclude these possibilities in order to avoid inconsistencies */</span>
<a name="l00408"></a>00408         <span class="keywordflow">if</span> ( ( xOpt == 0 ) &amp;&amp; ( yOpt != 0 ) &amp;&amp; ( ( guessedBounds != 0 ) || ( guessedConstraints != 0 ) ) )
<a name="l00409"></a>00409                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00410"></a>00410 
<a name="l00411"></a>00411         <span class="comment">/* 2) Setup QP data. */</span>
<a name="l00412"></a>00412         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a795e8ecc363ab25f15ffaf12a9ec4040">setupQPdata</a>( _H,_g,_A,_lb,_ub,_lbA,_ubA ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00413"></a>00413                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00414"></a>00414 
<a name="l00415"></a>00415         <span class="comment">/* 3) Call to main initialisation routine. */</span>
<a name="l00416"></a>00416         <span class="keywordflow">return</span> <a class="code" href="classQProblem.html#a048bbbe3969ccac99c5278d04dcbdd97">solveInitialQP</a>( xOpt,yOpt,guessedBounds,guessedConstraints, nWSR,cputime );
<a name="l00417"></a>00417 }
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 <span class="comment">/*</span>
<a name="l00421"></a>00421 <span class="comment"> *      i n i t</span>
<a name="l00422"></a>00422 <span class="comment"> */</span>
<a name="l00423"></a><a class="code" href="classQProblem.html#a43f6bb9280bf92070177b4daccdd0bfc">00423</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aa286539b43de9a08bc18a9d70c799008">QProblem::init</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> H_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> g_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> A_file,
<a name="l00424"></a>00424                                                         <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lb_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ub_file,
<a name="l00425"></a>00425                                                         <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lbA_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ubA_file,
<a name="l00426"></a>00426                                                         <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime,
<a name="l00427"></a>00427                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> xOpt, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> yOpt,
<a name="l00428"></a>00428                                                         <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> guessedBounds, <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> guessedConstraints
<a name="l00429"></a>00429                                                         )
<a name="l00430"></a>00430 {
<a name="l00431"></a>00431         <span class="keywordtype">int</span> i;
<a name="l00432"></a>00432         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l00433"></a>00433         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l00434"></a>00434 
<a name="l00435"></a>00435         <span class="keywordflow">if</span> ( nV == 0 )
<a name="l00436"></a>00436                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00437"></a>00437 
<a name="l00438"></a>00438         <span class="comment">/* 1) Consistency checks. */</span>
<a name="l00439"></a>00439         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ace7ad79b45cadc772e4824523f633e58">isInitialised</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00440"></a>00440         {
<a name="l00441"></a>00441                 <a class="code" href="MessageHandling_8hpp.html#a733e8e8f13934b6799f96a6dc8185439">THROWWARNING</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea37e621bb9516e08bd37c3767e0fbe168">RET_QP_ALREADY_INITIALISED</a> );
<a name="l00442"></a>00442                 <a class="code" href="classQProblem.html#a2f752d39b6935d929b963363a314b6bd">reset</a>( );
<a name="l00443"></a>00443         }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445         <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l00446"></a>00446         {
<a name="l00447"></a>00447                 <span class="keywordflow">if</span> ( guessedBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> )
<a name="l00448"></a>00448                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00449"></a>00449         }
<a name="l00450"></a>00450 
<a name="l00451"></a>00451         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l00452"></a>00452                 <span class="keywordflow">if</span> ( guessedConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> )
<a name="l00453"></a>00453                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00454"></a>00454 
<a name="l00455"></a>00455         <span class="comment">/* exclude these possibilities in order to avoid inconsistencies */</span>
<a name="l00456"></a>00456         <span class="keywordflow">if</span> ( ( xOpt == 0 ) &amp;&amp; ( yOpt != 0 ) &amp;&amp; ( ( guessedBounds != 0 ) || ( guessedConstraints != 0 ) ) )
<a name="l00457"></a>00457                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00458"></a>00458 
<a name="l00459"></a>00459         <span class="comment">/* 2) Setup QP data from files. */</span>
<a name="l00460"></a>00460         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a080fb229af9e97e338a543de442315d5">setupQPdataFromFile</a>( H_file,g_file,A_file,lb_file,ub_file,lbA_file,ubA_file ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00461"></a>00461                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea75a82ee30ebf002f5f8092258bafa76a">RET_UNABLE_TO_READ_FILE</a> );
<a name="l00462"></a>00462 
<a name="l00463"></a>00463         <span class="comment">/* 3) Call to main initialisation routine. */</span>
<a name="l00464"></a>00464         <span class="keywordflow">return</span> <a class="code" href="classQProblem.html#a048bbbe3969ccac99c5278d04dcbdd97">solveInitialQP</a>( xOpt,yOpt,guessedBounds,guessedConstraints, nWSR,cputime );
<a name="l00465"></a>00465 }
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <span class="comment">/*</span>
<a name="l00469"></a>00469 <span class="comment"> * c o m p u t e I n i t i a l C h o l e s k y</span>
<a name="l00470"></a>00470 <span class="comment"> */</span>
<a name="l00471"></a><a class="code" href="classQProblem.html#a8937aefe11bd8d5d749b1b7d2f669e6f">00471</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a8937aefe11bd8d5d749b1b7d2f669e6f">QProblem::computeInitialCholesky</a>()
<a name="l00472"></a>00472 {
<a name="l00473"></a>00473         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalueCholesky;
<a name="l00474"></a>00474         
<a name="l00475"></a>00475         <span class="comment">/* Factorise projected Hessian </span>
<a name="l00476"></a>00476 <span class="comment">         * now handles all special cases (no active bounds/constraints, no nullspace) */</span>
<a name="l00477"></a>00477         returnvalueCholesky = <a class="code" href="classQProblem.html#a8587edd6e4cb55879d84a5297c4896fd">setupCholeskyDecompositionProjected</a>( );
<a name="l00478"></a>00478 
<a name="l00479"></a>00479         <span class="comment">/* If Hessian is not positive definite, regularise and try again. */</span>
<a name="l00480"></a>00480         <span class="keywordflow">if</span> ( returnvalueCholesky == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea02db76e7e6badd1b34350674562e9284">RET_HESSIAN_NOT_SPD</a> )
<a name="l00481"></a>00481         {
<a name="l00482"></a>00482                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a8377ea426acc7a7b78a0c78944ded1b4">regulariseHessian</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00483"></a>00483                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eae5b4905ad0f9a6a0334de5b06d22ed78">RET_INIT_FAILED_REGULARISATION</a> );
<a name="l00484"></a>00484 
<a name="l00485"></a>00485                 returnvalueCholesky = <a class="code" href="classQProblem.html#a8587edd6e4cb55879d84a5297c4896fd">setupCholeskyDecompositionProjected</a>( );
<a name="l00486"></a>00486         }
<a name="l00487"></a>00487 
<a name="l00488"></a>00488         <span class="keywordflow">if</span> ( returnvalueCholesky != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00489"></a>00489                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea3768850ebfac736764b93f14b4872a93">RET_INIT_FAILED_CHOLESKY</a> );
<a name="l00490"></a>00490 
<a name="l00491"></a>00491         <a class="code" href="classQProblemB.html#a3647c70d0d4fba3f2afe2cca4d289102">haveCholesky</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l00492"></a>00492         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l00493"></a>00493 }
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 <span class="comment">/*</span>
<a name="l00497"></a>00497 <span class="comment"> *      h o t s t a r t</span>
<a name="l00498"></a>00498 <span class="comment"> */</span>
<a name="l00499"></a><a class="code" href="classQProblem.html#ac4779ef92b0dda8a9dd283df2a910afc">00499</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#ac4779ef92b0dda8a9dd283df2a910afc">QProblem::hotstart</a>( <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> g_new,
<a name="l00500"></a>00500                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lb_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ub_new,
<a name="l00501"></a>00501                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lbA_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ubA_new,
<a name="l00502"></a>00502                                                                 <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime
<a name="l00503"></a>00503                                                                 )
<a name="l00504"></a>00504 {
<a name="l00505"></a>00505         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( ) == 0 )
<a name="l00506"></a>00506                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00507"></a>00507 
<a name="l00508"></a>00508         ++<a class="code" href="classQProblemB.html#acd42fb385651070ee34d7ad7802e924b">count</a>;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l00511"></a>00511         <span class="keywordtype">int</span> nFar, i;
<a name="l00512"></a>00512         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a> ();
<a name="l00513"></a>00513         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a> ();
<a name="l00514"></a>00514 
<a name="l00515"></a>00515         <span class="keywordtype">int</span> nWSR_max = nWSR;
<a name="l00516"></a>00516         <span class="keywordtype">int</span> nWSR_performed = 0;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> cputime_remaining = <a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a>, *pcputime_rem;
<a name="l00519"></a>00519         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> cputime_needed = 0.0;
<a name="l00520"></a>00520 
<a name="l00521"></a>00521         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> farbound = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a2ec58bd7731426a3eb260ed7a9ad481c">initialFarBounds</a>;
<a name="l00522"></a>00522         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> t, rampVal;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa691471f2994643343ddcf2b697a19aa">enableFarBounds</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l00525"></a>00525         {
<a name="l00526"></a>00526                 <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a3647c70d0d4fba3f2afe2cca4d289102">haveCholesky</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>)
<a name="l00527"></a>00527                 {
<a name="l00528"></a>00528                         returnvalue = <a class="code" href="classQProblem.html#a8937aefe11bd8d5d749b1b7d2f669e6f">computeInitialCholesky</a>();
<a name="l00529"></a>00529                         <span class="keywordflow">if</span> (returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>)
<a name="l00530"></a>00530                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>(returnvalue);
<a name="l00531"></a>00531                 }
<a name="l00532"></a>00532 
<a name="l00533"></a>00533                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ad3b0413d59cf68b7ee855561082b60ef">usingRegularisation</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00534"></a>00534                         returnvalue = <a class="code" href="classQProblem.html#a310214d78f1bf41c508fb08ee6b94664">solveRegularisedQP</a>( g_new,lb_new,ub_new,lbA_new,ubA_new, nWSR,cputime,0 );
<a name="l00535"></a>00535                 <span class="keywordflow">else</span>
<a name="l00536"></a>00536                         returnvalue = <a class="code" href="classQProblem.html#ab794bdf2eb366226da400441f2e0d365">solveQP</a>( g_new,lb_new,ub_new,lbA_new,ubA_new, nWSR,cputime,0 );
<a name="l00537"></a>00537         }
<a name="l00538"></a>00538         <span class="keywordflow">else</span>
<a name="l00539"></a>00539         {
<a name="l00540"></a>00540                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *ub_new_far = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l00541"></a>00541                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *lb_new_far = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l00542"></a>00542                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *ubA_new_far = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l00543"></a>00543                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *lbA_new_far = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l00544"></a>00544 
<a name="l00545"></a>00545                 <span class="comment">/* possibly extend initial far bounds to largest bound/constraint data */</span>
<a name="l00546"></a>00546                 <span class="keywordflow">if</span> (ub_new)
<a name="l00547"></a>00547                         <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++)
<a name="l00548"></a>00548                                 <span class="keywordflow">if</span> (ub_new[i] &lt; <a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> &amp;&amp; ub_new[i] &gt; farbound) farbound = ub_new[i];
<a name="l00549"></a>00549                 <span class="keywordflow">if</span> (lb_new)
<a name="l00550"></a>00550                         <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++)
<a name="l00551"></a>00551                                 <span class="keywordflow">if</span> (lb_new[i] &gt; -<a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> &amp;&amp; lb_new[i] &lt; -farbound) farbound = -lb_new[i];
<a name="l00552"></a>00552                 <span class="keywordflow">if</span> (ubA_new)
<a name="l00553"></a>00553                         <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++)
<a name="l00554"></a>00554                                 <span class="keywordflow">if</span> (ubA_new[i] &lt; <a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> &amp;&amp; ubA_new[i] &gt; farbound) farbound = ubA_new[i];
<a name="l00555"></a>00555                 <span class="keywordflow">if</span> (lbA_new)
<a name="l00556"></a>00556                         <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++)
<a name="l00557"></a>00557                                 <span class="keywordflow">if</span> (lbA_new[i] &gt; -<a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> &amp;&amp; lbA_new[i] &lt; -farbound) farbound = -lbA_new[i];
<a name="l00558"></a>00558                 
<a name="l00559"></a>00559                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a8346f6e9a849cc3da7cbbede72a10196">enableRamping</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00560"></a>00560                 {
<a name="l00561"></a>00561                         <span class="comment">/* TODO: encapsule this part to avoid code duplication! */</span>
<a name="l00562"></a>00562                         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l00563"></a>00563                         {
<a name="l00564"></a>00564                                 t = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((i + <a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % nV) / <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>(nV+nC-1);
<a name="l00565"></a>00565                                 rampVal = farbound * (1.0 + t * (<a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a> - <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a>));
<a name="l00566"></a>00566 
<a name="l00567"></a>00567                                 <span class="keywordflow">if</span> ( ( lb_new == 0 ) || ( lb_new[i] &lt;= -rampVal ) )
<a name="l00568"></a>00568                                         lb_new_far[i] = - rampVal;
<a name="l00569"></a>00569                                 <span class="keywordflow">else</span>
<a name="l00570"></a>00570                                         lb_new_far[i] = lb_new[i];
<a name="l00571"></a>00571                                 <span class="keywordflow">if</span> ( ( ub_new == 0 ) || ( ub_new[i] &gt;= rampVal ) )
<a name="l00572"></a>00572                                         ub_new_far[i] = rampVal;
<a name="l00573"></a>00573                                 <span class="keywordflow">else</span>
<a name="l00574"></a>00574                                         ub_new_far[i] = ub_new[i];
<a name="l00575"></a>00575                         }
<a name="l00576"></a>00576                         <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l00577"></a>00577                         {
<a name="l00578"></a>00578                                 t = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((nV+i + <a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % (nV+nC)) / static_cast&lt;real_t&gt;(nV+nC-1);
<a name="l00579"></a>00579                                 rampVal = farbound * (1.0 + t * (<a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a> - <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a>));
<a name="l00580"></a>00580 
<a name="l00581"></a>00581                                 <span class="keywordflow">if</span> ( ( lbA_new == 0 ) || ( lbA_new[i] &lt;= -rampVal ) )
<a name="l00582"></a>00582                                         lbA_new_far[i] = - rampVal;
<a name="l00583"></a>00583                                 <span class="keywordflow">else</span>
<a name="l00584"></a>00584                                         lbA_new_far[i] = lbA_new[i];
<a name="l00585"></a>00585                                 <span class="keywordflow">if</span> ( ( ubA_new == 0 ) || ( ubA_new[i] &gt;= rampVal ) )
<a name="l00586"></a>00586                                         ubA_new_far[i] = rampVal;
<a name="l00587"></a>00587                                 <span class="keywordflow">else</span>
<a name="l00588"></a>00588                                         ubA_new_far[i] = ubA_new[i];
<a name="l00589"></a>00589                         }
<a name="l00590"></a>00590                 }
<a name="l00591"></a>00591                 <span class="keywordflow">else</span>
<a name="l00592"></a>00592                 {
<a name="l00593"></a>00593                         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l00594"></a>00594                         {
<a name="l00595"></a>00595                                 lb_new_far[i] = lb_new[i];
<a name="l00596"></a>00596                                 ub_new_far[i] = ub_new[i];
<a name="l00597"></a>00597                         }
<a name="l00598"></a>00598                         
<a name="l00599"></a>00599                         <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l00600"></a>00600                         {
<a name="l00601"></a>00601                                 lbA_new_far[i] = lbA_new[i];
<a name="l00602"></a>00602                                 ubA_new_far[i] = ubA_new[i];
<a name="l00603"></a>00603                         }
<a name="l00604"></a>00604                 }
<a name="l00605"></a>00605                 
<a name="l00606"></a>00606                 <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a3647c70d0d4fba3f2afe2cca4d289102">haveCholesky</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>)
<a name="l00607"></a>00607                 {
<a name="l00608"></a>00608                         returnvalue = <a class="code" href="classQProblem.html#a8937aefe11bd8d5d749b1b7d2f669e6f">computeInitialCholesky</a>();
<a name="l00609"></a>00609                         <span class="keywordflow">if</span> (returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>)
<a name="l00610"></a>00610                                 <span class="keywordflow">goto</span> farewell;
<a name="l00611"></a>00611                 }
<a name="l00612"></a>00612 
<a name="l00613"></a>00613                 <span class="keywordflow">for</span> ( ;; )
<a name="l00614"></a>00614                 {
<a name="l00615"></a>00615                         nWSR = nWSR_max;
<a name="l00616"></a>00616                         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l00617"></a>00617                         {
<a name="l00618"></a>00618                                 cputime_remaining = *cputime - cputime_needed;
<a name="l00619"></a>00619                                 pcputime_rem = &amp;cputime_remaining;
<a name="l00620"></a>00620                         }
<a name="l00621"></a>00621                         <span class="keywordflow">else</span>
<a name="l00622"></a>00622                                 pcputime_rem = 0;
<a name="l00623"></a>00623 
<a name="l00624"></a>00624                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ad3b0413d59cf68b7ee855561082b60ef">usingRegularisation</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ){
<a name="l00625"></a>00625                                 returnvalue = <a class="code" href="classQProblem.html#a310214d78f1bf41c508fb08ee6b94664">solveRegularisedQP</a>( g_new,lb_new_far,ub_new_far,lbA_new_far,ubA_new_far, nWSR,pcputime_rem,nWSR_performed );
<a name="l00626"></a>00626                         }
<a name="l00627"></a>00627                         <span class="keywordflow">else</span>{
<a name="l00628"></a>00628                                 returnvalue = <a class="code" href="classQProblem.html#ab794bdf2eb366226da400441f2e0d365">solveQP</a>( g_new,lb_new_far,ub_new_far,lbA_new_far,ubA_new_far, nWSR,pcputime_rem,nWSR_performed );
<a name="l00629"></a>00629                         }
<a name="l00630"></a>00630                         nWSR_performed  = nWSR;
<a name="l00631"></a>00631                         cputime_needed += cputime_remaining;
<a name="l00632"></a>00632 
<a name="l00633"></a>00633                         <span class="comment">/* Check for active far-bounds and move them away */</span>
<a name="l00634"></a>00634                         nFar = 0;
<a name="l00635"></a>00635                         farbound *= <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a5331179ac3983d3e57d7d6a80e3c8175">growFarBounds</a>;
<a name="l00636"></a>00636 
<a name="l00637"></a>00637                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> maxFarbound = 1e20;
<a name="l00638"></a>00638                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#acfeba7662b0bc3050ae37b857e3ea419">infeasible</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00639"></a>00639                         {
<a name="l00640"></a>00640                                 <span class="keywordflow">if</span> ( farbound &gt; maxFarbound )
<a name="l00641"></a>00641                                 {
<a name="l00642"></a>00642                                         returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaa14167098be18a37cb7dd01f271d9c9c">RET_HOTSTART_STOPPED_INFEASIBILITY</a>;
<a name="l00643"></a>00643                                         <span class="keywordflow">break</span>; <span class="comment">// goto farewell;   </span>
<a name="l00644"></a>00644                                 }
<a name="l00645"></a>00645 
<a name="l00646"></a>00646                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a8346f6e9a849cc3da7cbbede72a10196">enableRamping</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00647"></a>00647                                 {
<a name="l00648"></a>00648                                         <span class="comment">/* TODO: encapsule this part to avoid code duplication! */</span>
<a name="l00649"></a>00649                                         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l00650"></a>00650                                         {
<a name="l00651"></a>00651                                                 t = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((i + <a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % (nV + nC)) / static_cast&lt;real_t&gt;(nV+nC-1);
<a name="l00652"></a>00652                                                 rampVal = farbound * (1.0 + t * (<a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a> - <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a>));
<a name="l00653"></a>00653 
<a name="l00654"></a>00654                                                 <span class="keywordflow">if</span> ( lb_new == 0 )
<a name="l00655"></a>00655                                                         lb_new_far[i] = - rampVal;
<a name="l00656"></a>00656                                                 <span class="keywordflow">else</span>
<a name="l00657"></a>00657                                                         lb_new_far[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (- rampVal, lb_new[i]);
<a name="l00658"></a>00658 
<a name="l00659"></a>00659                                                 <span class="keywordflow">if</span> ( ub_new == 0 )
<a name="l00660"></a>00660                                                         ub_new_far[i] = rampVal;
<a name="l00661"></a>00661                                                 <span class="keywordflow">else</span>
<a name="l00662"></a>00662                                                         ub_new_far[i] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (rampVal, ub_new[i]);
<a name="l00663"></a>00663                                         }
<a name="l00664"></a>00664                                         <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l00665"></a>00665                                         {
<a name="l00666"></a>00666                                                 t = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((nV+i + <a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % (nV + nC)) / static_cast&lt;real_t&gt;(nV+nC-1);
<a name="l00667"></a>00667                                                 rampVal = farbound * (1.0 + t * (<a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a> - <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a>));
<a name="l00668"></a>00668 
<a name="l00669"></a>00669                                                 <span class="keywordflow">if</span> ( lbA_new == 0 )
<a name="l00670"></a>00670                                                         lbA_new_far[i] = - rampVal;
<a name="l00671"></a>00671                                                 <span class="keywordflow">else</span>
<a name="l00672"></a>00672                                                         lbA_new_far[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (- rampVal, lbA_new[i]);
<a name="l00673"></a>00673 
<a name="l00674"></a>00674                                                 <span class="keywordflow">if</span> ( ubA_new == 0 )
<a name="l00675"></a>00675                                                         ubA_new_far[i] = rampVal;
<a name="l00676"></a>00676                                                 <span class="keywordflow">else</span>
<a name="l00677"></a>00677                                                         ubA_new_far[i] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (rampVal, ubA_new[i]);
<a name="l00678"></a>00678                                         }
<a name="l00679"></a>00679                                 }
<a name="l00680"></a>00680                                 <span class="keywordflow">else</span>
<a name="l00681"></a>00681                                 {
<a name="l00682"></a>00682                                         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l00683"></a>00683                                         {
<a name="l00684"></a>00684                                                 lb_new_far[i] = lb_new[i];
<a name="l00685"></a>00685                                                 ub_new_far[i] = ub_new[i];
<a name="l00686"></a>00686                                         }
<a name="l00687"></a>00687                                         
<a name="l00688"></a>00688                                         <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l00689"></a>00689                                         {
<a name="l00690"></a>00690                                                 lbA_new_far[i] = lbA_new[i];
<a name="l00691"></a>00691                                                 ubA_new_far[i] = ubA_new[i];
<a name="l00692"></a>00692                                         }
<a name="l00693"></a>00693                                 }
<a name="l00694"></a>00694                         }
<a name="l00695"></a>00695                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdaeaeec92065e112d99b1f82851e069bd3">QPS_SOLVED</a> )
<a name="l00696"></a>00696                         {
<a name="l00697"></a>00697                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> tol = farbound * <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a9cc43ec93c854bd0302de1a940fda5dd">boundTolerance</a>;
<a name="l00698"></a>00698                                 <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda6f8af598b9b98f5a3582f8063f3b3ecb">QPS_HOMOTOPYQPSOLVED</a>;
<a name="l00699"></a>00699                                 <span class="comment">/* TODO: encapsule this part to avoid code duplication! */</span>
<a name="l00700"></a>00700                                 nFar = 0;
<a name="l00701"></a>00701                                 <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l00702"></a>00702                                 {
<a name="l00703"></a>00703                                         <span class="keywordflow">if</span> ( ( ( lb_new == 0 ) || ( lb_new_far[i] &gt; lb_new[i] ) ) &amp;&amp; ( fabs ( lb_new_far[i] - <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] ) &lt; tol ) )
<a name="l00704"></a>00704                                                 ++nFar;
<a name="l00705"></a>00705                                         <span class="keywordflow">if</span> ( ( ( ub_new == 0 ) || ( ub_new_far[i] &lt; ub_new[i] ) ) &amp;&amp; ( fabs ( ub_new_far[i] - <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] ) &lt; tol ) )
<a name="l00706"></a>00706                                                 ++nFar;
<a name="l00707"></a>00707                                 }
<a name="l00708"></a>00708                                 <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l00709"></a>00709                                 {
<a name="l00710"></a>00710                                         <span class="keywordflow">if</span> ( ( ( lbA_new == 0 ) || ( lbA_new_far[i] &gt; lbA_new[i] ) ) &amp;&amp; ( fabs ( lbA_new_far[i] - <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i] ) &lt; tol ) )
<a name="l00711"></a>00711                                                 ++nFar;
<a name="l00712"></a>00712                                         <span class="keywordflow">if</span> ( ( ( ubA_new == 0 ) || ( ubA_new_far[i] &lt; ubA_new[i] ) ) &amp;&amp; ( fabs ( ubA_new_far[i] - <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i] ) &lt; tol ) )
<a name="l00713"></a>00713                                                 ++nFar;
<a name="l00714"></a>00714                                 }
<a name="l00715"></a>00715 
<a name="l00716"></a>00716                                 <span class="keywordflow">if</span> ( nFar == 0 )
<a name="l00717"></a>00717                                         <span class="keywordflow">break</span>;
<a name="l00718"></a>00718 
<a name="l00719"></a>00719                                 <span class="keywordflow">if</span> ( farbound &gt; maxFarbound )
<a name="l00720"></a>00720                                 {
<a name="l00721"></a>00721                                         <a class="code" href="classQProblemB.html#a689fdbbb9231d84e6c653da59d069963">unbounded</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l00722"></a>00722                                         returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadfc914d50d132f250df763ba5908246e">RET_HOTSTART_STOPPED_UNBOUNDEDNESS</a>;
<a name="l00723"></a>00723                                         <span class="keywordflow">goto</span> farewell;
<a name="l00724"></a>00724                                 }
<a name="l00725"></a>00725 
<a name="l00726"></a>00726                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a8346f6e9a849cc3da7cbbede72a10196">enableRamping</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l00727"></a>00727                                 {
<a name="l00728"></a>00728                                         <span class="comment">/* TODO: encapsule this part to avoid code duplication! */</span>
<a name="l00729"></a>00729                                         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l00730"></a>00730                                         {
<a name="l00731"></a>00731                                                 t = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((i + <a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % (nV + nC)) / static_cast&lt;real_t&gt;(nV+nC-1);
<a name="l00732"></a>00732                                                 rampVal = farbound + (1.0-t) * <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a> + t * <a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a>;
<a name="l00733"></a>00733 
<a name="l00734"></a>00734                                                 <span class="keywordflow">if</span> ( lb_new == 0 )
<a name="l00735"></a>00735                                                         lb_new_far[i] = - rampVal;
<a name="l00736"></a>00736                                                 <span class="keywordflow">else</span>
<a name="l00737"></a>00737                                                         lb_new_far[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (- rampVal, lb_new[i]);
<a name="l00738"></a>00738 
<a name="l00739"></a>00739                                                 <span class="keywordflow">if</span> ( ub_new == 0 )
<a name="l00740"></a>00740                                                         ub_new_far[i] = rampVal;
<a name="l00741"></a>00741                                                 <span class="keywordflow">else</span>
<a name="l00742"></a>00742                                                         ub_new_far[i] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (rampVal, ub_new[i]);
<a name="l00743"></a>00743                                         }
<a name="l00744"></a>00744                                         <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l00745"></a>00745                                         {
<a name="l00746"></a>00746                                                 t = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((nV+i + <a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % (nV + nC)) / static_cast&lt;real_t&gt;(nV+nC-1);
<a name="l00747"></a>00747                                                 rampVal = farbound * (1.0 + t * (<a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a> - <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a>));
<a name="l00748"></a>00748 
<a name="l00749"></a>00749                                                 <span class="keywordflow">if</span> ( lbA_new == 0 )
<a name="l00750"></a>00750                                                         lbA_new_far[i] = - rampVal;
<a name="l00751"></a>00751                                                 <span class="keywordflow">else</span>
<a name="l00752"></a>00752                                                         lbA_new_far[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (- rampVal, lbA_new[i]);
<a name="l00753"></a>00753 
<a name="l00754"></a>00754                                                 <span class="keywordflow">if</span> ( ubA_new == 0 )
<a name="l00755"></a>00755                                                         ubA_new_far[i] = rampVal;
<a name="l00756"></a>00756                                                 <span class="keywordflow">else</span>
<a name="l00757"></a>00757                                                         ubA_new_far[i] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (rampVal, ubA_new[i]);
<a name="l00758"></a>00758                                         }
<a name="l00759"></a>00759                                 }
<a name="l00760"></a>00760                                 <span class="keywordflow">else</span>
<a name="l00761"></a>00761                                 {
<a name="l00762"></a>00762                                         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l00763"></a>00763                                         {
<a name="l00764"></a>00764                                                 lb_new_far[i] = lb_new[i];
<a name="l00765"></a>00765                                                 ub_new_far[i] = ub_new[i];
<a name="l00766"></a>00766                                         }
<a name="l00767"></a>00767                                         
<a name="l00768"></a>00768                                         <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l00769"></a>00769                                         {
<a name="l00770"></a>00770                                                 lbA_new_far[i] = lbA_new[i];
<a name="l00771"></a>00771                                                 ubA_new_far[i] = ubA_new[i];
<a name="l00772"></a>00772                                         }
<a name="l00773"></a>00773                                 }
<a name="l00774"></a>00774                         }
<a name="l00775"></a>00775                         <span class="keywordflow">else</span>
<a name="l00776"></a>00776                         {
<a name="l00777"></a>00777                                 <span class="comment">/* some other error */</span>
<a name="l00778"></a>00778                                 <span class="keywordflow">break</span>;
<a name="l00779"></a>00779                         }
<a name="l00780"></a>00780 
<a name="l00781"></a>00781                         <span class="comment">/* advance ramp offset to avoid Ramping cycles */</span>
<a name="l00782"></a>00782                         <a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>++;
<a name="l00783"></a>00783                 }
<a name="l00784"></a>00784 
<a name="l00785"></a>00785                 farewell:
<a name="l00786"></a>00786                         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l00787"></a>00787                                 *cputime = cputime_needed;
<a name="l00788"></a>00788                         <span class="keyword">delete</span>[] lbA_new_far; <span class="keyword">delete</span>[] ubA_new_far;
<a name="l00789"></a>00789                         <span class="keyword">delete</span>[] lb_new_far; <span class="keyword">delete</span>[] ub_new_far;
<a name="l00790"></a>00790         }
<a name="l00791"></a>00791 
<a name="l00792"></a>00792         <span class="keywordflow">return</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> ) ? <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( returnvalue ) : returnvalue;
<a name="l00793"></a>00793 }
<a name="l00794"></a>00794 
<a name="l00795"></a>00795 
<a name="l00796"></a>00796 <span class="comment">/*</span>
<a name="l00797"></a>00797 <span class="comment"> *      h o t s t a r t</span>
<a name="l00798"></a>00798 <span class="comment"> */</span>
<a name="l00799"></a><a class="code" href="classQProblem.html#a3dcfc9199ff2391c25fb5c7cfdcfd2f9">00799</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#ac4779ef92b0dda8a9dd283df2a910afc">QProblem::hotstart</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> g_file,
<a name="l00800"></a>00800                                                                 <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lb_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ub_file,
<a name="l00801"></a>00801                                                                 <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lbA_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ubA_file,
<a name="l00802"></a>00802                                                                 <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime
<a name="l00803"></a>00803                                                                 )
<a name="l00804"></a>00804 {
<a name="l00805"></a>00805         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l00806"></a>00806         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l00807"></a>00807 
<a name="l00808"></a>00808         <span class="keywordflow">if</span> ( nV == 0 )
<a name="l00809"></a>00809                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00810"></a>00810 
<a name="l00811"></a>00811         <span class="comment">/* consistency check */</span>
<a name="l00812"></a>00812         <span class="keywordflow">if</span> ( g_file == 0 )
<a name="l00813"></a>00813                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00814"></a>00814 
<a name="l00815"></a>00815 
<a name="l00816"></a>00816         <span class="comment">/* 1) Allocate memory (if bounds exist). */</span>
<a name="l00817"></a>00817         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* g_new  = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l00818"></a>00818         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* lb_new = 0;
<a name="l00819"></a>00819         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* ub_new = 0;
<a name="l00820"></a>00820         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* lbA_new = 0;
<a name="l00821"></a>00821         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* ubA_new = 0;
<a name="l00822"></a>00822 
<a name="l00823"></a>00823         <span class="keywordflow">if</span> ( lb_file != 0 )
<a name="l00824"></a>00824                 lb_new = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l00825"></a>00825         <span class="keywordflow">if</span> ( ub_file != 0 )
<a name="l00826"></a>00826                 ub_new = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l00827"></a>00827         <span class="keywordflow">if</span> ( lbA_file != 0 )
<a name="l00828"></a>00828                 lbA_new = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l00829"></a>00829         <span class="keywordflow">if</span> ( ubA_file != 0 )
<a name="l00830"></a>00830                 ubA_new = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l00831"></a>00831 
<a name="l00832"></a>00832         <span class="comment">/* 2) Load new QP vectors from file. */</span>
<a name="l00833"></a>00833         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue;
<a name="l00834"></a>00834         returnvalue = <a class="code" href="classQProblem.html#aa9790815d74ce8e61005d130e333d6f4">loadQPvectorsFromFile</a>(    g_file,lb_file,ub_file,lbA_file,ubA_file,
<a name="l00835"></a>00835                                                                                         g_new,lb_new,ub_new,lbA_new,ubA_new
<a name="l00836"></a>00836                                                                                         );
<a name="l00837"></a>00837         <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00838"></a>00838         {
<a name="l00839"></a>00839                 <span class="keywordflow">if</span> ( ubA_file != 0 )
<a name="l00840"></a>00840                         <span class="keyword">delete</span>[] ubA_new;
<a name="l00841"></a>00841                 <span class="keywordflow">if</span> ( lbA_file != 0 )
<a name="l00842"></a>00842                         <span class="keyword">delete</span>[] lbA_new;
<a name="l00843"></a>00843                 <span class="keywordflow">if</span> ( ub_file != 0 )
<a name="l00844"></a>00844                         <span class="keyword">delete</span>[] ub_new;
<a name="l00845"></a>00845                 <span class="keywordflow">if</span> ( lb_file != 0 )
<a name="l00846"></a>00846                         <span class="keyword">delete</span>[] lb_new;
<a name="l00847"></a>00847                 <span class="keyword">delete</span>[] g_new;
<a name="l00848"></a>00848 
<a name="l00849"></a>00849                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea75a82ee30ebf002f5f8092258bafa76a">RET_UNABLE_TO_READ_FILE</a> );
<a name="l00850"></a>00850         }
<a name="l00851"></a>00851 
<a name="l00852"></a>00852         <span class="comment">/* 3) Actually perform hotstart. */</span>
<a name="l00853"></a>00853         returnvalue = <a class="code" href="classQProblem.html#ac4779ef92b0dda8a9dd283df2a910afc">hotstart</a>( g_new,lb_new,ub_new,lbA_new,ubA_new, nWSR,cputime );
<a name="l00854"></a>00854 
<a name="l00855"></a>00855         <span class="comment">/* 4) Free memory. */</span>
<a name="l00856"></a>00856         <span class="keywordflow">if</span> ( ubA_file != 0 )
<a name="l00857"></a>00857                 <span class="keyword">delete</span>[] ubA_new;
<a name="l00858"></a>00858         <span class="keywordflow">if</span> ( lbA_file != 0 )
<a name="l00859"></a>00859                 <span class="keyword">delete</span>[] lbA_new;
<a name="l00860"></a>00860         <span class="keywordflow">if</span> ( ub_file != 0 )
<a name="l00861"></a>00861                 <span class="keyword">delete</span>[] ub_new;
<a name="l00862"></a>00862         <span class="keywordflow">if</span> ( lb_file != 0 )
<a name="l00863"></a>00863                 <span class="keyword">delete</span>[] lb_new;
<a name="l00864"></a>00864         <span class="keyword">delete</span>[] g_new;
<a name="l00865"></a>00865 
<a name="l00866"></a>00866         <span class="keywordflow">return</span> returnvalue;
<a name="l00867"></a>00867 }
<a name="l00868"></a>00868 
<a name="l00869"></a>00869 
<a name="l00870"></a>00870 <span class="comment">/*</span>
<a name="l00871"></a>00871 <span class="comment"> *      h o t s t a r t</span>
<a name="l00872"></a>00872 <span class="comment"> */</span>
<a name="l00873"></a><a class="code" href="classQProblem.html#ac54d0d8ce4b025ec5d9eae3182b09687">00873</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#ac4779ef92b0dda8a9dd283df2a910afc">QProblem::hotstart</a>( <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> g_new,
<a name="l00874"></a>00874                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lb_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ub_new,
<a name="l00875"></a>00875                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lbA_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ubA_new,
<a name="l00876"></a>00876                                                                 <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime,
<a name="l00877"></a>00877                                                                 <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> guessedBounds, <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> guessedConstraints
<a name="l00878"></a>00878                                                                 )
<a name="l00879"></a>00879 {
<a name="l00880"></a>00880         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l00881"></a>00881         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l00882"></a>00882 
<a name="l00883"></a>00883         <span class="keywordflow">if</span> ( nV == 0 )
<a name="l00884"></a>00884                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00885"></a>00885 
<a name="l00886"></a>00886 
<a name="l00887"></a>00887         <span class="comment">/* start runtime measurement */</span>
<a name="l00888"></a>00888         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> starttime = 0.0;
<a name="l00889"></a>00889         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l00890"></a>00890                 starttime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( );
<a name="l00891"></a>00891 
<a name="l00892"></a>00892 
<a name="l00893"></a>00893         <span class="comment">/* 1) Update working sets according to guesses for working sets of bounds and constraints. */</span>
<a name="l00894"></a>00894         <span class="keywordflow">if</span> ( ( guessedBounds != 0 ) &amp;&amp; ( guessedConstraints != 0 ) )
<a name="l00895"></a>00895         {
<a name="l00896"></a>00896                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#af76db9fd0aa230001e11b5c86bbfbae9">setupAuxiliaryQP</a>( guessedBounds,guessedConstraints ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00897"></a>00897                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l00898"></a>00898         }
<a name="l00899"></a>00899 
<a name="l00900"></a>00900         <span class="keywordflow">if</span> ( ( guessedBounds == 0 ) &amp;&amp; ( guessedConstraints != 0 ) )
<a name="l00901"></a>00901         {
<a name="l00902"></a>00902                 <span class="comment">/* create empty bounds for setting up auxiliary QP */</span>
<a name="l00903"></a>00903                 <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a> emptyBounds( nV );
<a name="l00904"></a>00904                 <span class="keywordflow">if</span> ( emptyBounds.<a class="code" href="classBounds.html#ae2f0eb4f34eb9a16b7d036ce23fa7ad0">setupAllFree</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00905"></a>00905                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l00906"></a>00906 
<a name="l00907"></a>00907                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#af76db9fd0aa230001e11b5c86bbfbae9">setupAuxiliaryQP</a>( &amp;emptyBounds,guessedConstraints ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00908"></a>00908                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l00909"></a>00909         }
<a name="l00910"></a>00910 
<a name="l00911"></a>00911         <span class="keywordflow">if</span> ( ( guessedBounds != 0 ) &amp;&amp; ( guessedConstraints == 0 ) )
<a name="l00912"></a>00912         {
<a name="l00913"></a>00913                 <span class="comment">/* create empty constraints for setting up auxiliary QP */</span>
<a name="l00914"></a>00914                 <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a> emptyConstraints( nC );
<a name="l00915"></a>00915                 <span class="keywordflow">if</span> ( emptyConstraints.<a class="code" href="classConstraints.html#ac49c5bae8433f8c6623e55088f33d226">setupAllInactive</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00916"></a>00916                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l00917"></a>00917 
<a name="l00918"></a>00918                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#af76db9fd0aa230001e11b5c86bbfbae9">setupAuxiliaryQP</a>( guessedBounds,&amp;emptyConstraints ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00919"></a>00919                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l00920"></a>00920         }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922         <span class="keywordflow">if</span> ( ( guessedBounds == 0 ) &amp;&amp; ( guessedConstraints == 0 ) )
<a name="l00923"></a>00923         {
<a name="l00924"></a>00924                 <span class="comment">/* create empty bounds and constraints for setting up auxiliary QP */</span>
<a name="l00925"></a>00925                 <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a> emptyBounds( nV );
<a name="l00926"></a>00926                 <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a> emptyConstraints( nC );
<a name="l00927"></a>00927                 <span class="keywordflow">if</span> ( emptyBounds.<a class="code" href="classBounds.html#ae2f0eb4f34eb9a16b7d036ce23fa7ad0">setupAllFree</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00928"></a>00928                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l00929"></a>00929                 <span class="keywordflow">if</span> ( emptyConstraints.<a class="code" href="classConstraints.html#ac49c5bae8433f8c6623e55088f33d226">setupAllInactive</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00930"></a>00930                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l00931"></a>00931 
<a name="l00932"></a>00932                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#af76db9fd0aa230001e11b5c86bbfbae9">setupAuxiliaryQP</a>( &amp;emptyBounds,&amp;emptyConstraints ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l00933"></a>00933                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l00934"></a>00934         }
<a name="l00935"></a>00935 
<a name="l00936"></a>00936         <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda1ace398d1f8eddff294c06c72bc58fdb">QPS_AUXILIARYQPSOLVED</a>;
<a name="l00937"></a>00937 
<a name="l00938"></a>00938 
<a name="l00939"></a>00939         <span class="comment">/* 2) Perform usual homotopy. */</span>
<a name="l00940"></a>00940 
<a name="l00941"></a>00941         <span class="comment">/* Allow only remaining CPU time for usual hotstart. */</span>
<a name="l00942"></a>00942         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l00943"></a>00943                 *cputime -= <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l00944"></a>00944 
<a name="l00945"></a>00945         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="classQProblem.html#ac4779ef92b0dda8a9dd283df2a910afc">hotstart</a>( g_new,lb_new,ub_new,lbA_new,ubA_new, nWSR,cputime );
<a name="l00946"></a>00946 
<a name="l00947"></a>00947         <span class="comment">/* stop runtime measurement */</span>
<a name="l00948"></a>00948         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l00949"></a>00949                 *cputime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l00950"></a>00950 
<a name="l00951"></a>00951         <span class="keywordflow">return</span> returnvalue;
<a name="l00952"></a>00952 }
<a name="l00953"></a>00953 
<a name="l00954"></a>00954 
<a name="l00955"></a>00955 <span class="comment">/*</span>
<a name="l00956"></a>00956 <span class="comment"> *      h o t s t a r t</span>
<a name="l00957"></a>00957 <span class="comment"> */</span>
<a name="l00958"></a><a class="code" href="classQProblem.html#ab1c064ca7d61b33afa39e98311ea9f1f">00958</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#ac4779ef92b0dda8a9dd283df2a910afc">QProblem::hotstart</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> g_file,
<a name="l00959"></a>00959                                                                 <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lb_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ub_file,
<a name="l00960"></a>00960                                                                 <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lbA_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ubA_file,
<a name="l00961"></a>00961                                                                 <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime,
<a name="l00962"></a>00962                                                                 <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> guessedBounds, <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> guessedConstraints
<a name="l00963"></a>00963                                                                 )
<a name="l00964"></a>00964 {
<a name="l00965"></a>00965         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l00966"></a>00966         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l00967"></a>00967 
<a name="l00968"></a>00968         <span class="keywordflow">if</span> ( nV == 0 )
<a name="l00969"></a>00969                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea149376c1abe7c87dc927566e4e60af10">RET_QPOBJECT_NOT_SETUP</a> );
<a name="l00970"></a>00970 
<a name="l00971"></a>00971         <span class="comment">/* consistency check */</span>
<a name="l00972"></a>00972         <span class="keywordflow">if</span> ( g_file == 0 )
<a name="l00973"></a>00973                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l00974"></a>00974 
<a name="l00975"></a>00975         <span class="comment">/* 1) Allocate memory (if bounds exist). */</span>
<a name="l00976"></a>00976         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* g_new   = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l00977"></a>00977         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* lb_new  = ( lb_file != 0 ) ? <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV] : 0;
<a name="l00978"></a>00978         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* ub_new  = ( ub_file != 0 ) ? <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV] : 0;
<a name="l00979"></a>00979         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* lbA_new = ( lbA_file != 0 ) ? <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC] : 0;
<a name="l00980"></a>00980         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* ubA_new = ( ubA_file != 0 ) ? <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC] : 0;
<a name="l00981"></a>00981 
<a name="l00982"></a>00982         <span class="comment">/* 2) Load new QP vectors from file. */</span>
<a name="l00983"></a>00983         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue;
<a name="l00984"></a>00984         returnvalue = <a class="code" href="classQProblem.html#aa9790815d74ce8e61005d130e333d6f4">loadQPvectorsFromFile</a>(    g_file,lb_file,ub_file,lbA_file,ubA_file,
<a name="l00985"></a>00985                                                                                         g_new,lb_new,ub_new,lbA_new,ubA_new
<a name="l00986"></a>00986                                                                                         );
<a name="l00987"></a>00987         <span class="keywordflow">if</span> (returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>) {
<a name="l00988"></a>00988                 returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea75a82ee30ebf002f5f8092258bafa76a">RET_UNABLE_TO_READ_FILE</a>;
<a name="l00989"></a>00989                 <span class="keywordflow">goto</span> farewell;
<a name="l00990"></a>00990         }
<a name="l00991"></a>00991         
<a name="l00992"></a>00992         <span class="comment">/* 3) Actually perform hotstart using initialised homotopy. */</span>
<a name="l00993"></a>00993         returnvalue = <a class="code" href="classQProblem.html#ac4779ef92b0dda8a9dd283df2a910afc">hotstart</a>( g_new,lb_new,ub_new,lbA_new,ubA_new, nWSR,cputime,
<a name="l00994"></a>00994                                                         guessedBounds,guessedConstraints
<a name="l00995"></a>00995                                                         );
<a name="l00996"></a>00996 farewell:
<a name="l00997"></a>00997         <span class="comment">/* 4) Free memory. */</span>
<a name="l00998"></a>00998         <span class="keywordflow">if</span> ( ubA_file != 0 )
<a name="l00999"></a>00999                 <span class="keyword">delete</span>[] ubA_new;
<a name="l01000"></a>01000         <span class="keywordflow">if</span> ( lbA_file != 0 )
<a name="l01001"></a>01001                 <span class="keyword">delete</span>[] lbA_new;
<a name="l01002"></a>01002         <span class="keywordflow">if</span> ( ub_file != 0 )
<a name="l01003"></a>01003                 <span class="keyword">delete</span>[] ub_new;
<a name="l01004"></a>01004         <span class="keywordflow">if</span> ( lb_file != 0 )
<a name="l01005"></a>01005                 <span class="keyword">delete</span>[] lb_new;
<a name="l01006"></a>01006         <span class="keyword">delete</span>[] g_new;
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         <span class="keywordflow">return</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> ) ? <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a> ( returnvalue ) : returnvalue;
<a name="l01009"></a>01009 }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011 
<a name="l01012"></a>01012 <span class="comment">/*</span>
<a name="l01013"></a>01013 <span class="comment"> *</span>
<a name="l01014"></a>01014 <span class="comment"> */</span>
<a name="l01015"></a><a class="code" href="classQProblem.html#aca103ee979a809007e3bb832c687eb7a">01015</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aca103ee979a809007e3bb832c687eb7a">QProblem::solveCurrentEQP</a> ( <span class="keyword">const</span> <span class="keywordtype">int</span> n_rhs,
<a name="l01016"></a>01016                                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* g_in,
<a name="l01017"></a>01017                                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* lb_in,
<a name="l01018"></a>01018                                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* ub_in,
<a name="l01019"></a>01019                                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* lbA_in,
<a name="l01020"></a>01020                                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* ubA_in,
<a name="l01021"></a>01021                                                                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* x_out,
<a name="l01022"></a>01022                                                                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* y_out
<a name="l01023"></a>01023                                                                                 )
<a name="l01024"></a>01024 {
<a name="l01025"></a>01025         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l01026"></a>01026         <span class="keywordtype">int</span> ii, jj;
<a name="l01027"></a>01027         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l01028"></a>01028         <span class="keywordtype">int</span> nC  = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l01029"></a>01029         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l01030"></a>01030         <span class="keywordtype">int</span> nFX = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>( );
<a name="l01031"></a>01031         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l01032"></a>01032 
<a name="l01033"></a>01033         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_xFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l01034"></a>01034         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_xFR = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l01035"></a>01035         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_yAC = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l01036"></a>01036         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_yFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l01037"></a>01037 
<a name="l01038"></a>01038         <span class="comment">/* 1) Determine index arrays. */</span>
<a name="l01039"></a>01039         <span class="keywordtype">int</span>* FR_idx;
<a name="l01040"></a>01040         <span class="keywordtype">int</span>* FX_idx;
<a name="l01041"></a>01041         <span class="keywordtype">int</span>* AC_idx;
<a name="l01042"></a>01042 
<a name="l01043"></a>01043         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l01044"></a>01044         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FX_idx );
<a name="l01045"></a>01045         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l01046"></a>01046 
<a name="l01047"></a>01047         <span class="keywordflow">for</span> ( ii = 0 ; ii &lt; n_rhs; ++ii )
<a name="l01048"></a>01048         {
<a name="l01049"></a>01049                 returnvalue = <a class="code" href="classQProblem.html#a1b2636572bd7eeed4f23222a6a1653e1">determineStepDirection</a>(
<a name="l01050"></a>01050                         g_in, lbA_in, ubA_in, lb_in, ub_in, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,
<a name="l01051"></a>01051                         delta_xFX, delta_xFR, delta_yAC, delta_yFX );
<a name="l01052"></a>01052 
<a name="l01053"></a>01053                 <span class="keywordflow">for</span> ( jj = 0; jj &lt; nFX; ++jj )
<a name="l01054"></a>01054                         x_out[FX_idx[jj]] = delta_xFX[jj];
<a name="l01055"></a>01055                 <span class="keywordflow">for</span> ( jj = 0; jj &lt; nFR; ++jj )
<a name="l01056"></a>01056                         x_out[FR_idx[jj]] = delta_xFR[jj];
<a name="l01057"></a>01057                 <span class="keywordflow">for</span> ( jj = 0; jj &lt; nFX; ++jj )
<a name="l01058"></a>01058                         y_out[FX_idx[jj]] = delta_yFX[jj];
<a name="l01059"></a>01059                 <span class="keywordflow">for</span> ( jj = 0; jj &lt; nAC; ++jj )
<a name="l01060"></a>01060                         y_out[nV+AC_idx[jj]] = delta_yAC[jj];
<a name="l01061"></a>01061                 <span class="keywordflow">for</span> ( jj = 0; jj &lt; nFR; ++jj )
<a name="l01062"></a>01062                         y_out[FR_idx[jj]] = 0.0;
<a name="l01063"></a>01063 
<a name="l01064"></a>01064                 g_in += nV;
<a name="l01065"></a>01065                 lb_in += nV;
<a name="l01066"></a>01066                 ub_in += nV;
<a name="l01067"></a>01067                 lbA_in += nC;
<a name="l01068"></a>01068                 ubA_in += nC;
<a name="l01069"></a>01069                 x_out += nV;
<a name="l01070"></a>01070                 y_out += nV+nC;
<a name="l01071"></a>01071         }
<a name="l01072"></a>01072 
<a name="l01073"></a>01073 
<a name="l01074"></a>01074         <span class="keyword">delete</span>[] delta_yFX;
<a name="l01075"></a>01075         <span class="keyword">delete</span>[] delta_yAC;
<a name="l01076"></a>01076         <span class="keyword">delete</span>[] delta_xFR;
<a name="l01077"></a>01077         <span class="keyword">delete</span>[] delta_xFX;
<a name="l01078"></a>01078 
<a name="l01079"></a>01079         <span class="keywordflow">return</span> returnvalue;
<a name="l01080"></a>01080 }
<a name="l01081"></a>01081 
<a name="l01082"></a>01082 
<a name="l01083"></a>01083 
<a name="l01084"></a>01084 <span class="comment">/*</span>
<a name="l01085"></a>01085 <span class="comment"> *      g e t N Z</span>
<a name="l01086"></a>01086 <span class="comment"> */</span>
<a name="l01087"></a><a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">01087</a> <span class="keywordtype">int</span> <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">QProblem::getNZ</a>( )<span class="keyword"> const</span>
<a name="l01088"></a>01088 <span class="keyword"></span>{
<a name="l01089"></a>01089         <span class="comment">/* nZ = nFR - nAC */</span>
<a name="l01090"></a>01090         <span class="keywordflow">return</span> <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( ) - <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l01091"></a>01091 }
<a name="l01092"></a>01092 
<a name="l01093"></a>01093 
<a name="l01094"></a>01094 <span class="comment">/*</span>
<a name="l01095"></a>01095 <span class="comment"> *      g e t D u a l S o l u t i o n</span>
<a name="l01096"></a>01096 <span class="comment"> */</span>
<a name="l01097"></a><a class="code" href="classQProblem.html#a51ee667454957cfb4d4ac899aac96527">01097</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a51ee667454957cfb4d4ac899aac96527">QProblem::getDualSolution</a>( <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> yOpt )<span class="keyword"> const</span>
<a name="l01098"></a>01098 <span class="keyword"></span>{
<a name="l01099"></a>01099         <span class="keywordtype">int</span> i;
<a name="l01100"></a>01100         
<a name="l01101"></a>01101         <span class="keywordflow">for</span>( i=0; i&lt;<a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( )+<a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( ); ++i )
<a name="l01102"></a>01102                 yOpt[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i];
<a name="l01103"></a>01103 
<a name="l01104"></a>01104         <span class="comment">/* return optimal dual solution vector</span>
<a name="l01105"></a>01105 <span class="comment">         * only if current QP has been solved */</span>
<a name="l01106"></a>01106         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda1ace398d1f8eddff294c06c72bc58fdb">QPS_AUXILIARYQPSOLVED</a> ) ||
<a name="l01107"></a>01107                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda6f8af598b9b98f5a3582f8063f3b3ecb">QPS_HOMOTOPYQPSOLVED</a> )  ||
<a name="l01108"></a>01108                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdaeaeec92065e112d99b1f82851e069bd3">QPS_SOLVED</a> ) )
<a name="l01109"></a>01109         {
<a name="l01110"></a>01110                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l01111"></a>01111         }
<a name="l01112"></a>01112         <span class="keywordflow">else</span>
<a name="l01113"></a>01113         {
<a name="l01114"></a>01114                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea287dca546b474635c6d5622e921569c4">RET_QP_NOT_SOLVED</a>;
<a name="l01115"></a>01115         }
<a name="l01116"></a>01116 }
<a name="l01117"></a>01117 
<a name="l01118"></a>01118 
<a name="l01119"></a>01119 
<a name="l01120"></a>01120 <span class="comment">/*</span>
<a name="l01121"></a>01121 <span class="comment"> *      s e t C o n s t r a i n t P r o d u c t</span>
<a name="l01122"></a>01122 <span class="comment"> */</span>
<a name="l01123"></a><a class="code" href="classQProblem.html#a7405bfa255fa9d05172b2929a3d74825">01123</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a7405bfa255fa9d05172b2929a3d74825">QProblem::setConstraintProduct</a>( <a class="code" href="classConstraintProduct.html" title="Interface for specifying user-defined evaluations of constraint products.">ConstraintProduct</a>* <span class="keyword">const</span> _constraintProduct )
<a name="l01124"></a>01124 {
<a name="l01125"></a>01125         <a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a> = _constraintProduct;
<a name="l01126"></a>01126 
<a name="l01127"></a>01127         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l01128"></a>01128 }
<a name="l01129"></a>01129 
<a name="l01130"></a>01130 
<a name="l01131"></a>01131 <span class="comment">/*</span>
<a name="l01132"></a>01132 <span class="comment"> *      p r i n t P r o p e r t i e s</span>
<a name="l01133"></a>01133 <span class="comment"> */</span>
<a name="l01134"></a><a class="code" href="classQProblem.html#a589e2b01326f871820f24d47fa4372e8">01134</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a589e2b01326f871820f24d47fa4372e8">QProblem::printProperties</a>( )
<a name="l01135"></a>01135 {
<a name="l01136"></a>01136 <span class="preprocessor">        #ifndef __XPCTARGET__</span>
<a name="l01137"></a>01137 <span class="preprocessor"></span>        <span class="comment">/* Do not print properties if print level is set to none! */</span>
<a name="l01138"></a>01138         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3c7327943ce25f36479356d33a0b0723">printLevel</a> == <a class="code" href="Types_8hpp.html#a83ff212f474e3669d8fac2d727f65de5a8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a> )
<a name="l01139"></a>01139                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l01140"></a>01140 
<a name="l01141"></a>01141         <span class="keywordtype">char</span> myPrintfString[80];
<a name="l01142"></a>01142 
<a name="l01143"></a>01143         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;\n#################   qpOASES  --  QP PROPERTIES   #################\n&quot;</span> );
<a name="l01144"></a>01144         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;\n&quot;</span> );
<a name="l01145"></a>01145 
<a name="l01146"></a>01146         <span class="comment">/* 1) Variables properties. */</span>
<a name="l01147"></a>01147         snprintf( myPrintfString,80,  <span class="stringliteral">&quot;Number of Variables: %4.1d\n&quot;</span>,<a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( ) );
<a name="l01148"></a>01148         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( myPrintfString );
<a name="l01149"></a>01149 
<a name="l01150"></a>01150         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#af4b7739129483c2d7e67048f5f5ed54b">hasNoLower</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01151"></a>01151                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Variables are not bounded from below.\n&quot;</span> );
<a name="l01152"></a>01152                 <span class="keywordflow">else</span>
<a name="l01153"></a>01153                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Variables are bounded from below.\n&quot;</span> );
<a name="l01154"></a>01154 
<a name="l01155"></a>01155         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a53058aa23ff9f956de32494ae2d3eab2">hasNoUpper</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01156"></a>01156                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Variables are not bounded from above.\n&quot;</span> );
<a name="l01157"></a>01157                 <span class="keywordflow">else</span>
<a name="l01158"></a>01158                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Variables are bounded from above.\n&quot;</span> );
<a name="l01159"></a>01159 
<a name="l01160"></a>01160         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;\n&quot;</span> );
<a name="l01161"></a>01161 
<a name="l01162"></a>01162 
<a name="l01163"></a>01163         <span class="comment">/* 2) Constraints properties. */</span>
<a name="l01164"></a>01164         snprintf( myPrintfString,80,  <span class="stringliteral">&quot;Total number of Constraints:      %4.1d\n&quot;</span>,<a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( ) );
<a name="l01165"></a>01165         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( myPrintfString );
<a name="l01166"></a>01166 
<a name="l01167"></a>01167         snprintf( myPrintfString,80,  <span class="stringliteral">&quot;Number of Equality Constraints:   %4.1d\n&quot;</span>,<a class="code" href="classQProblem.html#a4f7a6a9b4e7c47910a65061612ad0adb">getNEC</a>( ) );
<a name="l01168"></a>01168         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( myPrintfString );
<a name="l01169"></a>01169 
<a name="l01170"></a>01170         snprintf( myPrintfString,80,  <span class="stringliteral">&quot;Number of Inequality Constraints: %4.1d\n&quot;</span>,<a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( )-<a class="code" href="classQProblem.html#a4f7a6a9b4e7c47910a65061612ad0adb">getNEC</a>( ) );
<a name="l01171"></a>01171         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( myPrintfString );
<a name="l01172"></a>01172 
<a name="l01173"></a>01173         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( ) &gt; 0 )
<a name="l01174"></a>01174         {
<a name="l01175"></a>01175                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#af4b7739129483c2d7e67048f5f5ed54b">hasNoLower</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01176"></a>01176                                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Constraints are not bounded from below.\n&quot;</span> );
<a name="l01177"></a>01177                         <span class="keywordflow">else</span>
<a name="l01178"></a>01178                                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Constraints are bounded from below.\n&quot;</span> );
<a name="l01179"></a>01179 
<a name="l01180"></a>01180                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a53058aa23ff9f956de32494ae2d3eab2">hasNoUpper</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01181"></a>01181                                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Constraints are not bounded from above.\n&quot;</span> );
<a name="l01182"></a>01182                         <span class="keywordflow">else</span>
<a name="l01183"></a>01183                                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Constraints are bounded from above.\n&quot;</span> );
<a name="l01184"></a>01184         }
<a name="l01185"></a>01185 
<a name="l01186"></a>01186         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;\n&quot;</span> );
<a name="l01187"></a>01187 
<a name="l01188"></a>01188 
<a name="l01189"></a>01189         <span class="comment">/* 3) Further properties. */</span>
<a name="l01190"></a>01190         <span class="keywordflow">switch</span> ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> )
<a name="l01191"></a>01191         {
<a name="l01192"></a>01192                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a>:
<a name="l01193"></a>01193                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Hessian is zero matrix (i.e. actually an LP is solved).\n&quot;</span> );
<a name="l01194"></a>01194                         <span class="keywordflow">break</span>;
<a name="l01195"></a>01195 
<a name="l01196"></a>01196                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a>:
<a name="l01197"></a>01197                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Hessian is identity matrix.\n&quot;</span> );
<a name="l01198"></a>01198                         <span class="keywordflow">break</span>;
<a name="l01199"></a>01199 
<a name="l01200"></a>01200                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a920b0622e0d6bc3e2f659ca878480bd2">HST_POSDEF</a>:
<a name="l01201"></a>01201                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Hessian matrix is (strictly) positive definite.\n&quot;</span> );
<a name="l01202"></a>01202                         <span class="keywordflow">break</span>;
<a name="l01203"></a>01203 
<a name="l01204"></a>01204                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a1e75e5ed8d1cfded9c619586b046ba2b">HST_POSDEF_NULLSPACE</a>:
<a name="l01205"></a>01205                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Hessian matrix is positive definite on null space of active constraints.\n&quot;</span> );
<a name="l01206"></a>01206                         <span class="keywordflow">break</span>;
<a name="l01207"></a>01207 
<a name="l01208"></a>01208                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a4bd6c8ccecaaf211801db7381f2361ec">HST_SEMIDEF</a>:
<a name="l01209"></a>01209                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Hessian matrix is positive semi-definite.\n&quot;</span> );
<a name="l01210"></a>01210                         <span class="keywordflow">break</span>;
<a name="l01211"></a>01211 
<a name="l01212"></a>01212                 <span class="keywordflow">default</span>:
<a name="l01213"></a>01213                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Hessian matrix has unknown type.\n&quot;</span> );
<a name="l01214"></a>01214                         <span class="keywordflow">break</span>;
<a name="l01215"></a>01215         }
<a name="l01216"></a>01216 
<a name="l01217"></a>01217         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#acfeba7662b0bc3050ae37b857e3ea419">infeasible</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01218"></a>01218                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;QP was found to be infeasible.\n&quot;</span> );
<a name="l01219"></a>01219         <span class="keywordflow">else</span>
<a name="l01220"></a>01220                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;QP seems to be feasible.\n&quot;</span> );
<a name="l01221"></a>01221 
<a name="l01222"></a>01222         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a689fdbbb9231d84e6c653da59d069963">unbounded</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01223"></a>01223                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;QP was found to be unbounded from below.\n&quot;</span> );
<a name="l01224"></a>01224         <span class="keywordflow">else</span>
<a name="l01225"></a>01225                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;QP seems to be bounded from below.\n&quot;</span> );
<a name="l01226"></a>01226 
<a name="l01227"></a>01227         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;\n&quot;</span> );
<a name="l01228"></a>01228 
<a name="l01229"></a>01229 
<a name="l01230"></a>01230         <span class="comment">/* 4) QP object properties. */</span>
<a name="l01231"></a>01231         <span class="keywordflow">switch</span> ( <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> )
<a name="l01232"></a>01232         {
<a name="l01233"></a>01233                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda5ce84ee8a93fc7e780e2c1e9440c95ed">QPS_NOTINITIALISED</a>:
<a name="l01234"></a>01234                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Status of QP object: freshly instantiated or reset.\n&quot;</span> );
<a name="l01235"></a>01235                         <span class="keywordflow">break</span>;
<a name="l01236"></a>01236 
<a name="l01237"></a>01237                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdac5afc0889e446a94b965bff2b1e823d6">QPS_PREPARINGAUXILIARYQP</a>:
<a name="l01238"></a>01238                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Status of QP object: an auxiliary QP is currently setup.\n&quot;</span> );
<a name="l01239"></a>01239                         <span class="keywordflow">break</span>;
<a name="l01240"></a>01240 
<a name="l01241"></a>01241                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda1ace398d1f8eddff294c06c72bc58fdb">QPS_AUXILIARYQPSOLVED</a>:
<a name="l01242"></a>01242                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Status of QP object: an auxilary QP was solved.\n&quot;</span> );
<a name="l01243"></a>01243                         <span class="keywordflow">break</span>;
<a name="l01244"></a>01244 
<a name="l01245"></a>01245                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdac817378114b9a25537c55a7b70bb0a4f">QPS_PERFORMINGHOMOTOPY</a>:
<a name="l01246"></a>01246                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Status of QP object: a homotopy step is performed.\n&quot;</span> );
<a name="l01247"></a>01247                         <span class="keywordflow">break</span>;
<a name="l01248"></a>01248 
<a name="l01249"></a>01249                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda6f8af598b9b98f5a3582f8063f3b3ecb">QPS_HOMOTOPYQPSOLVED</a>:
<a name="l01250"></a>01250                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Status of QP object: an intermediate QP along the homotopy path was solved.\n&quot;</span> );
<a name="l01251"></a>01251                         <span class="keywordflow">break</span>;
<a name="l01252"></a>01252 
<a name="l01253"></a>01253                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdaeaeec92065e112d99b1f82851e069bd3">QPS_SOLVED</a>:
<a name="l01254"></a>01254                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Status of QP object: solution of the actual QP was found.\n&quot;</span> );
<a name="l01255"></a>01255                         <span class="keywordflow">break</span>;
<a name="l01256"></a>01256         }
<a name="l01257"></a>01257 
<a name="l01258"></a>01258         <span class="keywordflow">switch</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3c7327943ce25f36479356d33a0b0723">printLevel</a> )
<a name="l01259"></a>01259         {
<a name="l01260"></a>01260                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a83ff212f474e3669d8fac2d727f65de5aa88c0e6f4348323d414d5153a13187be">PL_LOW</a>:
<a name="l01261"></a>01261                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Print level of QP object is low, i.e. only error are printed.\n&quot;</span> );
<a name="l01262"></a>01262                         <span class="keywordflow">break</span>;
<a name="l01263"></a>01263 
<a name="l01264"></a>01264                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a83ff212f474e3669d8fac2d727f65de5ad4184c636ebb71d54bd55080e3e5a4a4">PL_MEDIUM</a>:
<a name="l01265"></a>01265                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Print level of QP object is medium, i.e. error and warnings are printed.\n&quot;</span> );
<a name="l01266"></a>01266                         <span class="keywordflow">break</span>;
<a name="l01267"></a>01267 
<a name="l01268"></a>01268                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a83ff212f474e3669d8fac2d727f65de5a7c08272588ef93a63665031fe77a4cb2">PL_HIGH</a>:
<a name="l01269"></a>01269                         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;Print level of QP object is high, i.e. all available output is printed.\n&quot;</span> );
<a name="l01270"></a>01270                         <span class="keywordflow">break</span>;
<a name="l01271"></a>01271 
<a name="l01272"></a>01272                 <span class="keywordflow">default</span>:
<a name="l01273"></a>01273                         <span class="keywordflow">break</span>;
<a name="l01274"></a>01274         }
<a name="l01275"></a>01275 
<a name="l01276"></a>01276         <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;\n&quot;</span> );
<a name="l01277"></a>01277 <span class="preprocessor">        #endif</span>
<a name="l01278"></a>01278 <span class="preprocessor"></span>
<a name="l01279"></a>01279         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l01280"></a>01280 }
<a name="l01281"></a>01281 
<a name="l01282"></a>01282 
<a name="l01283"></a>01283 
<a name="l01284"></a>01284 <span class="comment">/*****************************************************************************</span>
<a name="l01285"></a>01285 <span class="comment"> *  P R O T E C T E D                                                        *</span>
<a name="l01286"></a>01286 <span class="comment"> *****************************************************************************/</span>
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 <span class="comment">/*</span>
<a name="l01289"></a>01289 <span class="comment"> *      c l e a r</span>
<a name="l01290"></a>01290 <span class="comment"> */</span>
<a name="l01291"></a><a class="code" href="classQProblem.html#a9ccceb2ebb31fca9a6892b3da4286308">01291</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a9ccceb2ebb31fca9a6892b3da4286308">QProblem::clear</a>( )
<a name="l01292"></a>01292 {
<a name="l01293"></a>01293         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblem.html#a3a4b41db599d522b459ac0a6065c346c">freeConstraintMatrix</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> != 0 ) )
<a name="l01294"></a>01294         {
<a name="l01295"></a>01295                 <span class="keyword">delete</span> <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>;
<a name="l01296"></a>01296                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> = 0;
<a name="l01297"></a>01297         }
<a name="l01298"></a>01298 
<a name="l01299"></a>01299         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a> != 0 )
<a name="l01300"></a>01300         {
<a name="l01301"></a>01301                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>;
<a name="l01302"></a>01302                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a> = 0;
<a name="l01303"></a>01303         }
<a name="l01304"></a>01304 
<a name="l01305"></a>01305         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> != 0 )
<a name="l01306"></a>01306         {
<a name="l01307"></a>01307                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>;
<a name="l01308"></a>01308                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> = 0;
<a name="l01309"></a>01309         }
<a name="l01310"></a>01310 
<a name="l01311"></a>01311         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> != 0 )
<a name="l01312"></a>01312         {
<a name="l01313"></a>01313                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a>;
<a name="l01314"></a>01314                 <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> = 0;
<a name="l01315"></a>01315         }
<a name="l01316"></a>01316 
<a name="l01317"></a>01317         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a> != 0 )
<a name="l01318"></a>01318         {
<a name="l01319"></a>01319                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>;
<a name="l01320"></a>01320                 <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a> = 0;
<a name="l01321"></a>01321         }
<a name="l01322"></a>01322 
<a name="l01323"></a>01323         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a> != 0 )
<a name="l01324"></a>01324         {
<a name="l01325"></a>01325                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>;
<a name="l01326"></a>01326                 <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a> = 0;
<a name="l01327"></a>01327         }
<a name="l01328"></a>01328 
<a name="l01329"></a>01329         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a> != 0 )
<a name="l01330"></a>01330         {
<a name="l01331"></a>01331                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>;
<a name="l01332"></a>01332                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a> = 0;
<a name="l01333"></a>01333         }
<a name="l01334"></a>01334 
<a name="l01335"></a>01335         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a> != 0 )
<a name="l01336"></a>01336         {
<a name="l01337"></a>01337                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>;
<a name="l01338"></a>01338                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a> = 0;
<a name="l01339"></a>01339         }
<a name="l01340"></a>01340 
<a name="l01341"></a>01341         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a> != 0 )
<a name="l01342"></a>01342         {
<a name="l01343"></a>01343                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>;
<a name="l01344"></a>01344                 <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a> = 0;
<a name="l01345"></a>01345         }
<a name="l01346"></a>01346 
<a name="l01347"></a>01347         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a> != 0 )
<a name="l01348"></a>01348         {
<a name="l01349"></a>01349                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a>;
<a name="l01350"></a>01350                 <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a> = 0;
<a name="l01351"></a>01351         }
<a name="l01352"></a>01352 
<a name="l01353"></a>01353         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a> != 0 )
<a name="l01354"></a>01354         {
<a name="l01355"></a>01355                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a>;
<a name="l01356"></a>01356                 <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a> = 0;
<a name="l01357"></a>01357         }
<a name="l01358"></a>01358 
<a name="l01359"></a>01359         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a> != 0 )
<a name="l01360"></a>01360         {
<a name="l01361"></a>01361                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a>;
<a name="l01362"></a>01362                 <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a> = 0;
<a name="l01363"></a>01363         }
<a name="l01364"></a>01364 
<a name="l01365"></a>01365         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a> != 0 )
<a name="l01366"></a>01366         {
<a name="l01367"></a>01367                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>;
<a name="l01368"></a>01368                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a> = 0;
<a name="l01369"></a>01369         }
<a name="l01370"></a>01370 
<a name="l01371"></a>01371         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a> != 0 )
<a name="l01372"></a>01372         {
<a name="l01373"></a>01373                 <span class="keyword">delete</span>[] <a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a>;
<a name="l01374"></a>01374                 <a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a> = 0;
<a name="l01375"></a>01375         }
<a name="l01376"></a>01376 
<a name="l01377"></a>01377         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l01378"></a>01378 }
<a name="l01379"></a>01379 
<a name="l01380"></a>01380 
<a name="l01381"></a>01381 <span class="comment">/*</span>
<a name="l01382"></a>01382 <span class="comment"> *      c o p y</span>
<a name="l01383"></a>01383 <span class="comment"> */</span>
<a name="l01384"></a><a class="code" href="classQProblem.html#a368a4cf5e6133a1d851b720487fbb41f">01384</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a368a4cf5e6133a1d851b720487fbb41f">QProblem::copy</a>(     <span class="keyword">const</span> <a class="code" href="classQProblem.html" title="Implements the online active set strategy for QPs with general constraints.">QProblem</a>&amp; rhs
<a name="l01385"></a>01385                                                         )
<a name="l01386"></a>01386 {
<a name="l01387"></a>01387         <span class="keywordtype">int</span> _nV = rhs.<a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l01388"></a>01388         <span class="keywordtype">int</span> _nC = rhs.<a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l01389"></a>01389 
<a name="l01390"></a>01390         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a> = rhs.<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>;
<a name="l01391"></a>01391 
<a name="l01392"></a>01392         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblem.html#a3a4b41db599d522b459ac0a6065c346c">freeConstraintMatrix</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> != 0 ) )
<a name="l01393"></a>01393         {
<a name="l01394"></a>01394                 <span class="keyword">delete</span> <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>;
<a name="l01395"></a>01395                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> = 0;
<a name="l01396"></a>01396         }
<a name="l01397"></a>01397 
<a name="l01398"></a>01398         <a class="code" href="classQProblem.html#a3a4b41db599d522b459ac0a6065c346c">freeConstraintMatrix</a> = rhs.<a class="code" href="classQProblem.html#a3a4b41db599d522b459ac0a6065c346c">freeConstraintMatrix</a>;
<a name="l01399"></a>01399 
<a name="l01400"></a>01400         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a3a4b41db599d522b459ac0a6065c346c">freeConstraintMatrix</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01401"></a>01401                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> = rhs.<a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#abf41d80f7392e9d63e9b2fa4b822d3b9">duplicate</a>();
<a name="l01402"></a>01402         <span class="keywordflow">else</span>
<a name="l01403"></a>01403                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a> = rhs.<a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>;
<a name="l01404"></a>01404 
<a name="l01405"></a>01405         <span class="keywordflow">if</span> ( rhs.<a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a> != 0 )
<a name="l01406"></a>01406         {
<a name="l01407"></a>01407                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l01408"></a>01408                 <a class="code" href="classQProblem.html#a48bae806d7e2703116749a6dba1f3330">setLBA</a>( rhs.<a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a> );
<a name="l01409"></a>01409         }
<a name="l01410"></a>01410         <span class="keywordflow">else</span>
<a name="l01411"></a>01411                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a> = 0;
<a name="l01412"></a>01412 
<a name="l01413"></a>01413         <span class="keywordflow">if</span> ( rhs.<a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> != 0 )
<a name="l01414"></a>01414         {
<a name="l01415"></a>01415                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l01416"></a>01416                 <a class="code" href="classQProblem.html#a354fa56e3cf364846f31dcd68e3b8d02">setUBA</a>( rhs.<a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> );
<a name="l01417"></a>01417         }
<a name="l01418"></a>01418         <span class="keywordflow">else</span>
<a name="l01419"></a>01419                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> = 0;
<a name="l01420"></a>01420 
<a name="l01421"></a>01421         <span class="keywordflow">if</span> ( rhs.<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a> != 0 )
<a name="l01422"></a>01422         {
<a name="l01423"></a>01423                 <span class="keyword">delete</span>[] <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>; <span class="comment">/* y of no constraints version too short! */</span>
<a name="l01424"></a>01424                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV+_nC];
<a name="l01425"></a>01425                 memcpy( <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>,rhs.<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>,(_nV+_nC)*<span class="keyword">sizeof</span>(<a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>) );
<a name="l01426"></a>01426         }
<a name="l01427"></a>01427         <span class="keywordflow">else</span>
<a name="l01428"></a>01428                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a> = 0;
<a name="l01429"></a>01429 
<a name="l01430"></a>01430         <a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a> = rhs.<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>;
<a name="l01431"></a>01431 
<a name="l01432"></a>01432         <span class="keywordflow">if</span> ( rhs.<a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> != 0 )
<a name="l01433"></a>01433         {
<a name="l01434"></a>01434                 <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>*<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>];
<a name="l01435"></a>01435                 memcpy( <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a>,rhs.<a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a>,<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>*<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>*<span class="keyword">sizeof</span>(<a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>) );
<a name="l01436"></a>01436         }
<a name="l01437"></a>01437         <span class="keywordflow">else</span>
<a name="l01438"></a>01438                 <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> = 0;
<a name="l01439"></a>01439 
<a name="l01440"></a>01440         <span class="keywordflow">if</span> ( rhs.<a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a> != 0 )
<a name="l01441"></a>01441         {
<a name="l01442"></a>01442                 <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV*_nV];
<a name="l01443"></a>01443                 memcpy( <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>,rhs.<a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>,_nV*_nV*<span class="keyword">sizeof</span>(<a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>) );
<a name="l01444"></a>01444         }
<a name="l01445"></a>01445         <span class="keywordflow">else</span>
<a name="l01446"></a>01446                 <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a> = 0;
<a name="l01447"></a>01447 
<a name="l01448"></a>01448         <span class="keywordflow">if</span> ( rhs.<a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a> != 0 )
<a name="l01449"></a>01449         {
<a name="l01450"></a>01450                 <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l01451"></a>01451                 memcpy( <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>,rhs.<a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>,_nC*<span class="keyword">sizeof</span>(<a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>) );
<a name="l01452"></a>01452         }
<a name="l01453"></a>01453         <span class="keywordflow">else</span>
<a name="l01454"></a>01454                 <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a> = 0;
<a name="l01455"></a>01455 
<a name="l01456"></a>01456         <span class="keywordflow">if</span> ( rhs.<a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a> != 0 )
<a name="l01457"></a>01457         {
<a name="l01458"></a>01458                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l01459"></a>01459                 memcpy( <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>,rhs.<a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>,_nC*<span class="keyword">sizeof</span>(<a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>) );
<a name="l01460"></a>01460         }
<a name="l01461"></a>01461         <span class="keywordflow">else</span>
<a name="l01462"></a>01462                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a> = 0;
<a name="l01463"></a>01463 
<a name="l01464"></a>01464         <span class="keywordflow">if</span> ( rhs.<a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a> != 0 )
<a name="l01465"></a>01465         {
<a name="l01466"></a>01466                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];
<a name="l01467"></a>01467                 memcpy( <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>,rhs.<a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>,_nC*<span class="keyword">sizeof</span>(<a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>) );
<a name="l01468"></a>01468         }
<a name="l01469"></a>01469         <span class="keywordflow">else</span>
<a name="l01470"></a>01470                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a> = 0;
<a name="l01471"></a>01471 
<a name="l01472"></a>01472         <span class="keywordflow">if</span> ( rhs.<a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a> != 0 )
<a name="l01473"></a>01473                 <a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a> = rhs.<a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a>;
<a name="l01474"></a>01474         <span class="keywordflow">else</span>
<a name="l01475"></a>01475                 <a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a> = 0;
<a name="l01476"></a>01476 
<a name="l01477"></a>01477         <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV];                        <span class="comment">/* nFR */</span>
<a name="l01478"></a>01478         <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV];       <span class="comment">/* nFR */</span>
<a name="l01479"></a>01479         <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nV];           <span class="comment">/* nZ */</span>
<a name="l01480"></a>01480 
<a name="l01481"></a>01481         <span class="keywordflow">if</span> ( _nC &gt; 0 )
<a name="l01482"></a>01482         {
<a name="l01483"></a>01483                 <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];           <span class="comment">/* nAC */</span>
<a name="l01484"></a>01484                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];                        <span class="comment">/* nAC */</span>
<a name="l01485"></a>01485                 <a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a> = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[_nC];    <span class="comment">/* nAC */</span>
<a name="l01486"></a>01486         }
<a name="l01487"></a>01487         <span class="keywordflow">else</span>
<a name="l01488"></a>01488         {
<a name="l01489"></a>01489                 <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a> = 0;
<a name="l01490"></a>01490                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a> = 0;
<a name="l01491"></a>01491                 <a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a> = 0;
<a name="l01492"></a>01492         }
<a name="l01493"></a>01493 
<a name="l01494"></a>01494         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l01495"></a>01495 }
<a name="l01496"></a>01496 
<a name="l01497"></a>01497 
<a name="l01498"></a>01498 
<a name="l01499"></a>01499 <span class="comment">/*</span>
<a name="l01500"></a>01500 <span class="comment"> *      s o l v e I n i t i a l Q P</span>
<a name="l01501"></a>01501 <span class="comment"> */</span>
<a name="l01502"></a><a class="code" href="classQProblem.html#a048bbbe3969ccac99c5278d04dcbdd97">01502</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a048bbbe3969ccac99c5278d04dcbdd97">QProblem::solveInitialQP</a>(   <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> xOpt, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> yOpt,
<a name="l01503"></a>01503                                                                                 <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> guessedBounds, <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> guessedConstraints,
<a name="l01504"></a>01504                                                                                 <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime
<a name="l01505"></a>01505                                                                                 )
<a name="l01506"></a>01506 {
<a name="l01507"></a>01507         <span class="keywordtype">int</span> i;
<a name="l01508"></a>01508         <span class="comment">/* some definitions */</span>
<a name="l01509"></a>01509         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l01510"></a>01510         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l01511"></a>01511 
<a name="l01512"></a>01512         <span class="comment">/* start runtime measurement */</span>
<a name="l01513"></a>01513         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> starttime = 0.0;
<a name="l01514"></a>01514         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01515"></a>01515                 starttime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( );
<a name="l01516"></a>01516 
<a name="l01517"></a>01517         <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda5ce84ee8a93fc7e780e2c1e9440c95ed">QPS_NOTINITIALISED</a>;
<a name="l01518"></a>01518 
<a name="l01519"></a>01519 
<a name="l01520"></a>01520         <span class="comment">/* I) ANALYSE QP DATA: */</span>
<a name="l01521"></a>01521 <span class="preprocessor">        #ifdef __MANY_CONSTRAINTS__</span>
<a name="l01522"></a>01522 <span class="preprocessor"></span>        <span class="comment">/* 0) Checks if l1-norm of each constraint is not greater than 1. */</span>
<a name="l01523"></a>01523         <span class="keywordtype">int</span> j;
<a name="l01524"></a>01524         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> l1;
<a name="l01525"></a>01525         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l01526"></a>01526         {
<a name="l01527"></a>01527                 l1 = 0.0;
<a name="l01528"></a>01528                 <span class="keywordflow">for</span>( j=0; j&lt;nV; ++j )
<a name="l01529"></a>01529                         l1 += fabs( AA(i,j) ); <span class="comment">/* Andreas: do many constraints case later */</span>
<a name="l01530"></a>01530 
<a name="l01531"></a>01531                 <span class="keywordflow">if</span> ( l1 &gt; 1.0 + 10.0*<a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> )
<a name="l01532"></a>01532                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea90ed48a04d457af36fa04e65d38533b5">RET_CONSTRAINTS_ARE_NOT_SCALED</a> );
<a name="l01533"></a>01533         }
<a name="l01534"></a>01534 <span class="preprocessor">        #endif</span>
<a name="l01535"></a>01535 <span class="preprocessor"></span>        
<a name="l01536"></a>01536         <span class="comment">/* 1) Check if Hessian happens to be the identity matrix. */</span>
<a name="l01537"></a>01537         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a05462a04d6ecec9f2f3d32b868ec546b">determineHessianType</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01538"></a>01538                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadb8ab9888977627abbebc017e9dcd083">RET_INIT_FAILED</a> );
<a name="l01539"></a>01539 
<a name="l01540"></a>01540         <span class="comment">/* 2) Setup type of bounds and constraints (i.e. unbounded, implicitly fixed etc.). */</span>
<a name="l01541"></a>01541         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#af024ebec53f988671f24ee98e71394a1">setupSubjectToType</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01542"></a>01542                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadb8ab9888977627abbebc017e9dcd083">RET_INIT_FAILED</a> );
<a name="l01543"></a>01543 
<a name="l01544"></a>01544         <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdac5afc0889e446a94b965bff2b1e823d6">QPS_PREPARINGAUXILIARYQP</a>;
<a name="l01545"></a>01545 
<a name="l01546"></a>01546 
<a name="l01547"></a>01547         <span class="comment">/* II) SETUP AUXILIARY QP WITH GIVEN OPTIMAL SOLUTION: */</span>
<a name="l01548"></a>01548         <span class="comment">/* 1) Setup bounds and constraints data structure. */</span>
<a name="l01549"></a>01549         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#ae2f0eb4f34eb9a16b7d036ce23fa7ad0">setupAllFree</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01550"></a>01550                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadb8ab9888977627abbebc017e9dcd083">RET_INIT_FAILED</a> );
<a name="l01551"></a>01551 
<a name="l01552"></a>01552         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#ac49c5bae8433f8c6623e55088f33d226">setupAllInactive</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01553"></a>01553                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadb8ab9888977627abbebc017e9dcd083">RET_INIT_FAILED</a> );
<a name="l01554"></a>01554 
<a name="l01555"></a>01555         <span class="comment">/* 2) Setup optimal primal/dual solution for auxiliary QP. */</span>
<a name="l01556"></a>01556         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a393d3526ea02bb6ec26896c857f70bb6">setupAuxiliaryQPsolution</a>( xOpt,yOpt ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01557"></a>01557                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadb8ab9888977627abbebc017e9dcd083">RET_INIT_FAILED</a> );
<a name="l01558"></a>01558 
<a name="l01559"></a>01559         <span class="comment">/* 3) Obtain linear independent working set for auxiliary QP. */</span>
<a name="l01560"></a>01560         <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a> auxiliaryBounds( nV );
<a name="l01561"></a>01561         <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a> auxiliaryConstraints( nC );
<a name="l01562"></a>01562         
<a name="l01563"></a>01563         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a196494261347150c9d8ec6e62c4f0470">obtainAuxiliaryWorkingSet</a>( xOpt,yOpt,guessedBounds,guessedConstraints,
<a name="l01564"></a>01564                                                                         &amp;auxiliaryBounds,&amp;auxiliaryConstraints ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01565"></a>01565                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadb8ab9888977627abbebc017e9dcd083">RET_INIT_FAILED</a> );
<a name="l01566"></a>01566 
<a name="l01567"></a>01567         <span class="comment">/* 4) Setup working set of auxiliary QP and setup matrix factorisations. */</span>
<a name="l01568"></a>01568         <span class="comment">/* a) Regularise Hessian if necessary. */</span>
<a name="l01569"></a>01569         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> ) || ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a4bd6c8ccecaaf211801db7381f2361ec">HST_SEMIDEF</a> ) )
<a name="l01570"></a>01570         {
<a name="l01571"></a>01571                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a8377ea426acc7a7b78a0c78944ded1b4">regulariseHessian</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01572"></a>01572                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eae5b4905ad0f9a6a0334de5b06d22ed78">RET_INIT_FAILED_REGULARISATION</a> );
<a name="l01573"></a>01573         }
<a name="l01574"></a>01574         
<a name="l01575"></a>01575         <span class="comment">/* b) TQ factorisation. */</span>
<a name="l01576"></a>01576         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a08d6dfbf81516910e5d7af60f4f67faa">setupTQfactorisation</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01577"></a>01577                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea3db2e79e0cc5bbf0c890d4858afa6e11">RET_INIT_FAILED_TQ</a> );
<a name="l01578"></a>01578 
<a name="l01579"></a>01579         <span class="comment">/* c) Working set of auxiliary QP. */</span>
<a name="l01580"></a>01580         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a1779e923a5f84cdddd33bbe38735f58c">setupAuxiliaryWorkingSet</a>( &amp;auxiliaryBounds,&amp;auxiliaryConstraints,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01581"></a>01581                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadb8ab9888977627abbebc017e9dcd083">RET_INIT_FAILED</a> );
<a name="l01582"></a>01582 
<a name="l01583"></a>01583         <a class="code" href="classQProblemB.html#a3647c70d0d4fba3f2afe2cca4d289102">haveCholesky</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l01584"></a>01584 
<a name="l01585"></a>01585         <span class="comment">/* 5) Store original QP formulation... */</span>
<a name="l01586"></a>01586         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* g_original = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01587"></a>01587         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* lb_original = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01588"></a>01588         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* ub_original = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01589"></a>01589         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* lbA_original = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l01590"></a>01590         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* ubA_original = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l01591"></a>01591         
<a name="l01592"></a>01592         <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l01593"></a>01593         {
<a name="l01594"></a>01594                 g_original[i] = <a class="code" href="classQProblemB.html#a3efcc81e7338d5d41c99e58a766315ba">g</a>[i];
<a name="l01595"></a>01595                 lb_original[i] = <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i];
<a name="l01596"></a>01596                 ub_original[i] = <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i];
<a name="l01597"></a>01597         }
<a name="l01598"></a>01598 
<a name="l01599"></a>01599         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l01600"></a>01600         {
<a name="l01601"></a>01601                 lbA_original[i] = <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i];
<a name="l01602"></a>01602                 ubA_original[i] = <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i];
<a name="l01603"></a>01603         }
<a name="l01604"></a>01604         
<a name="l01605"></a>01605         <span class="comment">/* ... and setup QP data of an auxiliary QP having an optimal solution</span>
<a name="l01606"></a>01606 <span class="comment">         * as specified by the user (or xOpt = yOpt = 0, by default). */</span>
<a name="l01607"></a>01607         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a20876832f9f362aa98ae9fde45713297">setupAuxiliaryQPgradient</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01608"></a>01608         {
<a name="l01609"></a>01609                 <span class="keyword">delete</span>[] ubA_original; <span class="keyword">delete</span>[] lbA_original; <span class="keyword">delete</span>[] ub_original; <span class="keyword">delete</span>[] lb_original; <span class="keyword">delete</span>[] g_original;
<a name="l01610"></a>01610                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadb8ab9888977627abbebc017e9dcd083">RET_INIT_FAILED</a> );
<a name="l01611"></a>01611         }
<a name="l01612"></a>01612 
<a name="l01613"></a>01613         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0db2ab7f578d4254353279643219a7f1">setupAuxiliaryQPbounds</a>( &amp;auxiliaryBounds,&amp;auxiliaryConstraints,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01614"></a>01614         {
<a name="l01615"></a>01615                 <span class="keyword">delete</span>[] ubA_original; <span class="keyword">delete</span>[] lbA_original; <span class="keyword">delete</span>[] ub_original; <span class="keyword">delete</span>[] lb_original; <span class="keyword">delete</span>[] g_original;
<a name="l01616"></a>01616                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadb8ab9888977627abbebc017e9dcd083">RET_INIT_FAILED</a> );
<a name="l01617"></a>01617         }
<a name="l01618"></a>01618 
<a name="l01619"></a>01619         <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda1ace398d1f8eddff294c06c72bc58fdb">QPS_AUXILIARYQPSOLVED</a>;
<a name="l01620"></a>01620 
<a name="l01621"></a>01621 
<a name="l01622"></a>01622         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a8346f6e9a849cc3da7cbbede72a10196">enableRamping</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01623"></a>01623                 <a class="code" href="classQProblem.html#a1905b766c096a2dded5927a9e9824b65">performRamping</a>( );
<a name="l01624"></a>01624 
<a name="l01625"></a>01625         <span class="comment">/* III) SOLVE ACTUAL INITIAL QP: */</span>
<a name="l01626"></a>01626         <span class="comment">/* Allow only remaining CPU time for usual hotstart. */</span>
<a name="l01627"></a>01627         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01628"></a>01628                 *cputime -= <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l01629"></a>01629         
<a name="l01630"></a>01630         <span class="comment">/* Use hotstart method to find the solution of the original initial QP,... */</span>
<a name="l01631"></a>01631         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="classQProblem.html#ac4779ef92b0dda8a9dd283df2a910afc">hotstart</a>( g_original,lb_original,ub_original,lbA_original,ubA_original, nWSR,cputime );
<a name="l01632"></a>01632         
<a name="l01633"></a>01633         <span class="comment">/* ... deallocate memory,... */</span>
<a name="l01634"></a>01634         <span class="keyword">delete</span>[] ubA_original; <span class="keyword">delete</span>[] lbA_original; <span class="keyword">delete</span>[] ub_original; <span class="keyword">delete</span>[] lb_original; <span class="keyword">delete</span>[] g_original;
<a name="l01635"></a>01635 
<a name="l01636"></a>01636         <span class="comment">/* ... check for infeasibility and unboundedness... */</span>
<a name="l01637"></a>01637         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a0a04b59313783541265e3c32f9782f88">isInfeasible</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01638"></a>01638                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea040d013f3f6fb6b8b7f4d934b6ab6e3b">RET_INIT_FAILED_INFEASIBILITY</a> );
<a name="l01639"></a>01639 
<a name="l01640"></a>01640         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a7cc69d93266a5b959e668dc0eaf399c6">isUnbounded</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01641"></a>01641                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaee1adc69a219c67785b374e183b469c8">RET_INIT_FAILED_UNBOUNDEDNESS</a> );
<a name="l01642"></a>01642 
<a name="l01643"></a>01643         <span class="comment">/* ... and internal errors. */</span>
<a name="l01644"></a>01644         <span class="keywordflow">if</span> ( ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> ) &amp;&amp; ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaae4f4541f015531f0d19acc9810665ba">RET_MAX_NWSR_REACHED</a> ) )
<a name="l01645"></a>01645                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea929a85f3bd16d5f7520c4c5ba529e374">RET_INIT_FAILED_HOTSTART</a> );
<a name="l01646"></a>01646 
<a name="l01647"></a>01647 
<a name="l01648"></a>01648         <span class="comment">/* stop runtime measurement */</span>
<a name="l01649"></a>01649         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01650"></a>01650                 *cputime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l01651"></a>01651 
<a name="l01652"></a>01652         <a class="code" href="MessageHandling_8hpp.html#a0ef7741d67176593da953e5baa206ce9">THROWINFO</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5d73a0655025d8630405f6dcabffe6b6">RET_INIT_SUCCESSFUL</a> );
<a name="l01653"></a>01653 
<a name="l01654"></a>01654         <span class="keywordflow">return</span> returnvalue;
<a name="l01655"></a>01655 }
<a name="l01656"></a>01656 
<a name="l01657"></a>01657 
<a name="l01658"></a>01658 <span class="comment">/*</span>
<a name="l01659"></a>01659 <span class="comment"> *      s o l v e Q P</span>
<a name="l01660"></a>01660 <span class="comment"> */</span>
<a name="l01661"></a><a class="code" href="classQProblem.html#ab794bdf2eb366226da400441f2e0d365">01661</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#ab794bdf2eb366226da400441f2e0d365">QProblem::solveQP</a>(  <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> g_new,
<a name="l01662"></a>01662                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lb_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ub_new,
<a name="l01663"></a>01663                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lbA_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ubA_new,
<a name="l01664"></a>01664                                                                 <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime, <span class="keywordtype">int</span> nWSRperformed
<a name="l01665"></a>01665                                                                 )
<a name="l01666"></a>01666 {
<a name="l01667"></a>01667         <span class="keywordtype">int</span> iter;
<a name="l01668"></a>01668         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l01669"></a>01669         <span class="keywordtype">int</span> nC  = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l01670"></a>01670 
<a name="l01671"></a>01671         <span class="comment">/* consistency check */</span>
<a name="l01672"></a>01672         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda5ce84ee8a93fc7e780e2c1e9440c95ed">QPS_NOTINITIALISED</a> )       ||
<a name="l01673"></a>01673                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdac5afc0889e446a94b965bff2b1e823d6">QPS_PREPARINGAUXILIARYQP</a> ) ||
<a name="l01674"></a>01674                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdac817378114b9a25537c55a7b70bb0a4f">QPS_PERFORMINGHOMOTOPY</a> )   )
<a name="l01675"></a>01675         {
<a name="l01676"></a>01676                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8ff62a8229d187900326a9ca1afac60b">RET_HOTSTART_FAILED_AS_QP_NOT_INITIALISED</a> );
<a name="l01677"></a>01677         }
<a name="l01678"></a>01678 
<a name="l01679"></a>01679         <span class="comment">/* start runtime measurement */</span>
<a name="l01680"></a>01680         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> starttime = 0.0;
<a name="l01681"></a>01681         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01682"></a>01682                 starttime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( );
<a name="l01683"></a>01683         
<a name="l01684"></a>01684         <span class="comment">/* I) PREPARATIONS */</span>
<a name="l01685"></a>01685         <span class="comment">/* 1) Allocate delta vectors of gradient and (constraints&#39;) bounds,</span>
<a name="l01686"></a>01686 <span class="comment">         *    index arrays and step direction arrays. */</span>
<a name="l01687"></a>01687         <span class="keywordtype">int</span> nFR, nFX, nAC, nIAC;
<a name="l01688"></a>01688 
<a name="l01689"></a>01689         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_xFR = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01690"></a>01690         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_xFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01691"></a>01691         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_yAC = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l01692"></a>01692         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_yFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01693"></a>01693 
<a name="l01694"></a>01694         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_g   = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01695"></a>01695         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_lb  = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01696"></a>01696         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_ub  = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01697"></a>01697         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_lbA = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l01698"></a>01698         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_ubA = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l01699"></a>01699 
<a name="l01700"></a>01700         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue;
<a name="l01701"></a>01701         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> Delta_bC_isZero, Delta_bB_isZero;
<a name="l01702"></a>01702 
<a name="l01703"></a>01703         <span class="keywordtype">int</span> BC_idx;
<a name="l01704"></a>01704         <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> BC_status;
<a name="l01705"></a>01705         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> BC_isBound;
<a name="l01706"></a>01706 
<a name="l01707"></a>01707         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> homotopyLength;
<a name="l01708"></a>01708 
<a name="l01709"></a>01709         <span class="keywordtype">char</span> messageString[80];
<a name="l01710"></a>01710 
<a name="l01711"></a>01711     
<a name="l01712"></a>01712         <span class="comment">/* 2) Update type of bounds and constraints, e.g.</span>
<a name="l01713"></a>01713 <span class="comment">         *    a former equality constraint might have become a normal one etc. */</span>
<a name="l01714"></a>01714     
<a name="l01715"></a>01715   <span class="comment">// (ckirches) disabled this, as inactive but tight bounds may become inactive equalities</span>
<a name="l01716"></a>01716     <span class="comment">//            which would then never become active again!</span>
<a name="l01717"></a>01717 <span class="comment">/*    </span>
<a name="l01718"></a>01718 <span class="comment">        if ( setupSubjectToType( lb_new,ub_new,lbA_new,ubA_new ) != SUCCESSFUL_RETURN )</span>
<a name="l01719"></a>01719 <span class="comment">                return THROWERROR( RET_HOTSTART_FAILED );</span>
<a name="l01720"></a>01720 <span class="comment">*/</span>
<a name="l01721"></a>01721         <span class="comment">/* 3) Reset status flags. */</span>
<a name="l01722"></a>01722         <a class="code" href="classQProblemB.html#acfeba7662b0bc3050ae37b857e3ea419">infeasible</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l01723"></a>01723         <a class="code" href="classQProblemB.html#a689fdbbb9231d84e6c653da59d069963">unbounded</a>  = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l01724"></a>01724 
<a name="l01725"></a>01725 
<a name="l01726"></a>01726         <span class="comment">/* II) MAIN HOMOTOPY LOOP */</span>
<a name="l01727"></a>01727         <span class="keywordflow">for</span>( iter=nWSRperformed; iter&lt;nWSR; ++iter )
<a name="l01728"></a>01728         {
<a name="l01729"></a>01729                 <a class="code" href="classQProblem.html#aee232819e1d7bd8720872a886aa63f1d">idxAddB</a> = <a class="code" href="classQProblem.html#abad5c15e6d0c621cea0d7355a5eb16c1">idxRemB</a> = <a class="code" href="classQProblem.html#a1b23ea57017d56736b4d90e3f067132d">idxAddC</a> = <a class="code" href="classQProblem.html#ac90fd3f4126680ffdceb86c5a64d1cb8">idxRemC</a> = -1;
<a name="l01730"></a>01730                 <a class="code" href="classQProblem.html#a36f054a93eb8dd2876a3e9d8bfb24922">excAddB</a> = <a class="code" href="classQProblem.html#a5d808162c2545f4bb054fe7276f2e65b">excRemB</a> = <a class="code" href="classQProblem.html#adc925de671d66633d16b96fec82566e5">excAddC</a> = <a class="code" href="classQProblem.html#a23864f19ab428e3397b1b42f589751f9">excRemC</a> = 0;
<a name="l01731"></a>01731 
<a name="l01732"></a>01732                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a8b8bda0a6424e244a5d28d4c760cd0a8">isCPUtimeLimitExceeded</a>( cputime,starttime,iter-nWSRperformed ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01733"></a>01733                 {
<a name="l01734"></a>01734                         <span class="comment">/* If CPU time limit is exceeded, stop homotopy loop immediately!</span>
<a name="l01735"></a>01735 <span class="comment">                        * Assign number of working set recalculations (runtime measurement is stopped later). */</span>
<a name="l01736"></a>01736                         nWSR = iter;
<a name="l01737"></a>01737                         <span class="keywordflow">break</span>;
<a name="l01738"></a>01738                 }
<a name="l01739"></a>01739 
<a name="l01740"></a>01740                 <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdac817378114b9a25537c55a7b70bb0a4f">QPS_PERFORMINGHOMOTOPY</a>;
<a name="l01741"></a>01741 
<a name="l01742"></a>01742 <span class="preprocessor">                #ifndef __XPCTARGET__</span>
<a name="l01743"></a>01743 <span class="preprocessor"></span>                snprintf( messageString,80,<span class="stringliteral">&quot;%d ...&quot;</span>,iter );
<a name="l01744"></a>01744                 <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea369fb8c9dc2a77a1e72f4eb103ed771b">RET_ITERATION_STARTED</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l01745"></a>01745 <span class="preprocessor">                #endif</span>
<a name="l01746"></a>01746 <span class="preprocessor"></span>
<a name="l01747"></a>01747                 <span class="comment">/* some more definitions */</span>
<a name="l01748"></a>01748                 nFR  = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l01749"></a>01749                 nFX  = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>( );
<a name="l01750"></a>01750                 nAC  = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l01751"></a>01751                 nIAC = <a class="code" href="classQProblem.html#a98e1d71a037c6b4a47cc6b38a4737296">getNIAC</a>( );
<a name="l01752"></a>01752 
<a name="l01753"></a>01753 
<a name="l01754"></a>01754                 <span class="comment">/* 2) Detemination of shift direction of the gradient and the (constraints&#39;) bounds. */</span>
<a name="l01755"></a>01755                 returnvalue = <a class="code" href="classQProblem.html#aa72f6a87e8dcda0a07353d3d25eb11a1">determineDataShift</a>(       g_new,lbA_new,ubA_new,lb_new,ub_new,
<a name="l01756"></a>01756                                                                                         delta_g,delta_lbA,delta_ubA,delta_lb,delta_ub,
<a name="l01757"></a>01757                                                                                         Delta_bC_isZero, Delta_bB_isZero
<a name="l01758"></a>01758                                                                                         );
<a name="l01759"></a>01759                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01760"></a>01760                 {
<a name="l01761"></a>01761                         <span class="keyword">delete</span>[] delta_yAC; <span class="keyword">delete</span>[] delta_yFX; <span class="keyword">delete</span>[] delta_xFX; <span class="keyword">delete</span>[] delta_xFR;
<a name="l01762"></a>01762                         <span class="keyword">delete</span>[] delta_ub; <span class="keyword">delete</span>[] delta_lb; <span class="keyword">delete</span>[] delta_ubA; <span class="keyword">delete</span>[] delta_lbA; <span class="keyword">delete</span>[] delta_g;
<a name="l01763"></a>01763 
<a name="l01764"></a>01764                         <span class="comment">/* Assign number of working set recalculations and stop runtime measurement. */</span>
<a name="l01765"></a>01765                         nWSR = iter;
<a name="l01766"></a>01766                         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01767"></a>01767                                 *cputime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l01768"></a>01768 
<a name="l01769"></a>01769                         <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea966bff668a8504f53f05a3d74acb7e4d">RET_SHIFT_DETERMINATION_FAILED</a> );
<a name="l01770"></a>01770                         <span class="keywordflow">return</span> returnvalue;
<a name="l01771"></a>01771                 }
<a name="l01772"></a>01772 
<a name="l01773"></a>01773                 <span class="comment">/* 3) Determination of step direction of X and Y. */</span>
<a name="l01774"></a>01774                 returnvalue = <a class="code" href="classQProblem.html#a1b2636572bd7eeed4f23222a6a1653e1">determineStepDirection</a>(   delta_g,delta_lbA,delta_ubA,delta_lb,delta_ub,
<a name="l01775"></a>01775                                                                                                 Delta_bC_isZero, Delta_bB_isZero,
<a name="l01776"></a>01776                                                                                                 delta_xFX,delta_xFR,delta_yAC,delta_yFX
<a name="l01777"></a>01777                                                                                                 );
<a name="l01778"></a>01778                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01779"></a>01779                 {
<a name="l01780"></a>01780                         <span class="keyword">delete</span>[] delta_yAC; <span class="keyword">delete</span>[] delta_yFX; <span class="keyword">delete</span>[] delta_xFX; <span class="keyword">delete</span>[] delta_xFR;
<a name="l01781"></a>01781                         <span class="keyword">delete</span>[] delta_ub; <span class="keyword">delete</span>[] delta_lb; <span class="keyword">delete</span>[] delta_ubA; <span class="keyword">delete</span>[] delta_lbA; <span class="keyword">delete</span>[] delta_g;
<a name="l01782"></a>01782 
<a name="l01783"></a>01783                         <span class="comment">/* Assign number of working set recalculations and stop runtime measurement. */</span>
<a name="l01784"></a>01784                         nWSR = iter;
<a name="l01785"></a>01785                         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01786"></a>01786                                 *cputime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l01787"></a>01787 
<a name="l01788"></a>01788                         <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea63adec4d91330be7334d9a6b1fa2441a">RET_STEPDIRECTION_DETERMINATION_FAILED</a> );
<a name="l01789"></a>01789                         <span class="keywordflow">return</span> returnvalue;
<a name="l01790"></a>01790                 }
<a name="l01791"></a>01791 
<a name="l01792"></a>01792                 <span class="comment">/* 4) Determination of step length TAU.</span>
<a name="l01793"></a>01793 <span class="comment">                 *    This step along the homotopy path is also taken (without changing working set). */</span>
<a name="l01794"></a>01794                 returnvalue = <a class="code" href="classQProblem.html#ab5540a5ac739561b704c815116f1dc7d">performStep</a>(      delta_g, delta_lbA,delta_ubA,delta_lb,delta_ub,
<a name="l01795"></a>01795                                                                         delta_xFX,delta_xFR,delta_yAC,delta_yFX,
<a name="l01796"></a>01796                                                                         BC_idx,BC_status,BC_isBound
<a name="l01797"></a>01797                                                                         );
<a name="l01798"></a>01798                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01799"></a>01799                 {
<a name="l01800"></a>01800                         <span class="keyword">delete</span>[] delta_yAC; <span class="keyword">delete</span>[] delta_yFX; <span class="keyword">delete</span>[] delta_xFX; <span class="keyword">delete</span>[] delta_xFR;
<a name="l01801"></a>01801                         <span class="keyword">delete</span>[] delta_ub; <span class="keyword">delete</span>[] delta_lb; <span class="keyword">delete</span>[] delta_ubA; <span class="keyword">delete</span>[] delta_lbA; <span class="keyword">delete</span>[] delta_g;
<a name="l01802"></a>01802 
<a name="l01803"></a>01803                         <span class="comment">/* Assign number of working set recalculations and stop runtime measurement. */</span>
<a name="l01804"></a>01804                         nWSR = iter;
<a name="l01805"></a>01805                         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01806"></a>01806                                 *cputime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l01807"></a>01807 
<a name="l01808"></a>01808                         <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaa9223fc5e1a3d4223ab825c39bdd45d7">RET_STEPLENGTH_DETERMINATION_FAILED</a> );
<a name="l01809"></a>01809                         <span class="keywordflow">return</span> returnvalue;
<a name="l01810"></a>01810                 }
<a name="l01811"></a>01811 
<a name="l01812"></a>01812                 <span class="comment">/* 5) Termination criterion. */</span>
<a name="l01813"></a>01813                 homotopyLength = <a class="code" href="classQProblem.html#ac9bd93c9a1eaaacdac0b61d36262f650">relativeHomotopyLength</a>(g_new, lb_new, ub_new, lbA_new, ubA_new);
<a name="l01814"></a>01814                 <span class="keywordflow">if</span> ( homotopyLength &lt;= <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#ad18a17e6fd0c84625ad44261a7f73474">terminationTolerance</a> )
<a name="l01815"></a>01815                 {
<a name="l01816"></a>01816                         <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdaeaeec92065e112d99b1f82851e069bd3">QPS_SOLVED</a>;
<a name="l01817"></a>01817 
<a name="l01818"></a>01818                         <a class="code" href="MessageHandling_8hpp.html#a0ef7741d67176593da953e5baa206ce9">THROWINFO</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0da5fbbcc17e08d9f65123a69051a817">RET_OPTIMAL_SOLUTION_FOUND</a> );
<a name="l01819"></a>01819 
<a name="l01820"></a>01820                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3c7327943ce25f36479356d33a0b0723">printLevel</a> &gt; <a class="code" href="Types_8hpp.html#a83ff212f474e3669d8fac2d727f65de5a8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a> )
<a name="l01821"></a>01821                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#aa42a85afe05309ac3860e44f5bb02864">printIteration</a>( iter,BC_idx,BC_status,BC_isBound ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01822"></a>01822                                         <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadbb2b76be2af017a285a3f42e0b0ee3f">RET_PRINT_ITERATION_FAILED</a> ); <span class="comment">/* do not pass this as return value! */</span>
<a name="l01823"></a>01823 
<a name="l01824"></a>01824                         nWSR = iter;
<a name="l01825"></a>01825                         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01826"></a>01826                                 *cputime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l01827"></a>01827 
<a name="l01828"></a>01828                         <span class="keyword">delete</span>[] delta_yAC; <span class="keyword">delete</span>[] delta_yFX; <span class="keyword">delete</span>[] delta_xFX; <span class="keyword">delete</span>[] delta_xFR;
<a name="l01829"></a>01829                         <span class="keyword">delete</span>[] delta_ub; <span class="keyword">delete</span>[] delta_lb; <span class="keyword">delete</span>[] delta_ubA; <span class="keyword">delete</span>[] delta_lbA; <span class="keyword">delete</span>[] delta_g;
<a name="l01830"></a>01830 
<a name="l01831"></a>01831                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l01832"></a>01832                 }
<a name="l01833"></a>01833 
<a name="l01834"></a>01834 
<a name="l01835"></a>01835                 <span class="comment">/* 6) Change active set. */</span>
<a name="l01836"></a>01836                 returnvalue = <a class="code" href="classQProblem.html#a87b0484bebb552796bcfcfd14a87136a">changeActiveSet</a>( BC_idx,BC_status,BC_isBound );
<a name="l01837"></a>01837                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01838"></a>01838                 {
<a name="l01839"></a>01839                         <span class="keyword">delete</span>[] delta_yAC; <span class="keyword">delete</span>[] delta_yFX; <span class="keyword">delete</span>[] delta_xFX; <span class="keyword">delete</span>[] delta_xFR;
<a name="l01840"></a>01840                         <span class="keyword">delete</span>[] delta_ub; <span class="keyword">delete</span>[] delta_lb; <span class="keyword">delete</span>[] delta_ubA; <span class="keyword">delete</span>[] delta_lbA; <span class="keyword">delete</span>[] delta_g;
<a name="l01841"></a>01841 
<a name="l01842"></a>01842                         <span class="comment">/* Assign number of working set recalculations and stop runtime measurement. */</span>
<a name="l01843"></a>01843                         nWSR = iter;
<a name="l01844"></a>01844                         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01845"></a>01845                                 *cputime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l01846"></a>01846 
<a name="l01847"></a>01847                         <span class="comment">/* Checks for infeasibility... */</span>
<a name="l01848"></a>01848                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a0a04b59313783541265e3c32f9782f88">isInfeasible</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l01849"></a>01849                         {                               
<a name="l01850"></a>01850                                 <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda6f8af598b9b98f5a3582f8063f3b3ecb">QPS_HOMOTOPYQPSOLVED</a>;
<a name="l01851"></a>01851                                 <span class="keywordflow">return</span> <a class="code" href="classQProblemB.html#a0ee80a22826580862cc33ca63fe35d23">setInfeasibilityFlag</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaa14167098be18a37cb7dd01f271d9c9c">RET_HOTSTART_STOPPED_INFEASIBILITY</a> );
<a name="l01852"></a>01852                         }
<a name="l01853"></a>01853 
<a name="l01854"></a>01854                         <span class="comment">/* ...unboundedness... */</span>
<a name="l01855"></a>01855                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a689fdbbb9231d84e6c653da59d069963">unbounded</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) <span class="comment">/* not necessary since objective function convex! */</span>
<a name="l01856"></a>01856                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadfc914d50d132f250df763ba5908246e">RET_HOTSTART_STOPPED_UNBOUNDEDNESS</a> );
<a name="l01857"></a>01857 
<a name="l01858"></a>01858                         <span class="comment">/* ... and throw unspecific error otherwise */</span>
<a name="l01859"></a>01859                         <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea536775f52bbc0a9fa4e2d0ddfee3be6f">RET_HOMOTOPY_STEP_FAILED</a> );
<a name="l01860"></a>01860                         <span class="keywordflow">return</span> returnvalue;
<a name="l01861"></a>01861                 }
<a name="l01862"></a>01862 
<a name="l01863"></a>01863                 <span class="comment">/* 6.5) Possibly refactorise projected Hessian from scratch. */</span>
<a name="l01864"></a>01864                 <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#ab4f0461ee7ed5b58edbed5eff9094ff2">enableCholeskyRefactorisation</a> &gt; 0 &amp;&amp; iter % <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#ab4f0461ee7ed5b58edbed5eff9094ff2">enableCholeskyRefactorisation</a> == 0)
<a name="l01865"></a>01865                 {
<a name="l01866"></a>01866                         returnvalue = <a class="code" href="classQProblem.html#a8587edd6e4cb55879d84a5297c4896fd">setupCholeskyDecompositionProjected</a>();
<a name="l01867"></a>01867                         <span class="keywordflow">if</span> (returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>)
<a name="l01868"></a>01868                         {
<a name="l01869"></a>01869                                 <span class="keyword">delete</span>[] delta_yAC; <span class="keyword">delete</span>[] delta_yFX; <span class="keyword">delete</span>[] delta_xFX; <span class="keyword">delete</span>[] delta_xFR;
<a name="l01870"></a>01870                                 <span class="keyword">delete</span>[] delta_ub; <span class="keyword">delete</span>[] delta_lb; <span class="keyword">delete</span>[] delta_ubA; <span class="keyword">delete</span>[] delta_lbA; <span class="keyword">delete</span>[] delta_g;
<a name="l01871"></a>01871                                 <span class="keywordflow">return</span> returnvalue;
<a name="l01872"></a>01872                         }
<a name="l01873"></a>01873                 }
<a name="l01874"></a>01874 
<a name="l01875"></a>01875 
<a name="l01876"></a>01876 <span class="preprocessor">#ifdef __DEBUG_ITER__</span>
<a name="l01877"></a>01877 <span class="preprocessor"></span>                nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>();
<a name="l01878"></a>01878                 nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>();
<a name="l01879"></a>01879                 <span class="keywordtype">int</span> i;
<a name="l01880"></a>01880                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> stat, bfeas, cfeas, bcmpl, ccmpl, errUnitary, errTQ, Tmaxomin;
<a name="l01881"></a>01881                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *grad = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l01882"></a>01882                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *AX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l01883"></a>01883                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> Tmin, Tmax;
<a name="l01884"></a>01884 
<a name="l01885"></a>01885                 stat = bfeas = cfeas = bcmpl = ccmpl = errUnitary = errTQ = Tmaxomin = 0.0;
<a name="l01886"></a>01886 
<a name="l01887"></a>01887                 <span class="comment">/* stationarity */</span>
<a name="l01888"></a>01888                 <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++) grad[i] = <a class="code" href="classQProblemB.html#a3efcc81e7338d5d41c99e58a766315ba">g</a>[i] - <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i];
<a name="l01889"></a>01889                 <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(1, 1.0, <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>, nV, 1.0, grad, nV);
<a name="l01890"></a>01890                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aae760f106376a34dfaf0c168fa836d84">transTimes</a>(1, -1.0, <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>+nV, nC, 1.0, grad, nV);
<a name="l01891"></a>01891                 <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++) if (fabs(grad[i]) &gt; stat) stat = fabs(grad[i]);
<a name="l01892"></a>01892 
<a name="l01893"></a>01893                 <span class="comment">/* feasibility */</span>
<a name="l01894"></a>01894                 <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++) <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] - <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] &gt; bfeas) bfeas = <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] - <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l01895"></a>01895                 <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++) <span class="keywordflow">if</span> (x[i] - <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] &gt; bfeas) bfeas = x[i] - <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i];
<a name="l01896"></a>01896                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(1, 1.0, x, nV, 0.0, AX, nC);
<a name="l01897"></a>01897                 <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++) <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] - AX[i] &gt; cfeas) cfeas = <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] - AX[i];
<a name="l01898"></a>01898                 <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++) <span class="keywordflow">if</span> (AX[i] - <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] &gt; cfeas) cfeas = AX[i] - <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i];
<a name="l01899"></a>01899 
<a name="l01900"></a>01900                 <span class="comment">/* complementarity */</span>
<a name="l01901"></a>01901                 <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++) if (y[i] &gt; +<a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> &amp;&amp; fabs((<a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] - x[i])*<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i]) &gt; bcmpl) bcmpl = fabs((<a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] - x[i])*<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i]);
<a name="l01902"></a>01902                 <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++) <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] &lt; -<a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> &amp;&amp; fabs((ub[i] - x[i])*<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i]) &gt; bcmpl) bcmpl = fabs((ub[i] - x[i])*<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i]);
<a name="l01903"></a>01903                 <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++) if (y[nV+i] &gt; +<a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> &amp;&amp; fabs((<a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i]-AX[i])*<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+i]) &gt; ccmpl) ccmpl = fabs((<a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i]-AX[i])*<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+i]);
<a name="l01904"></a>01904                 <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++) <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+i] &lt; -<a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> &amp;&amp; fabs((ubA[i]-AX[i])*<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+i]) &gt; ccmpl) ccmpl = fabs((ubA[i]-AX[i])*<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+i]);
<a name="l01905"></a>01905 
<a name="l01906"></a>01906                 Tmin = 1.0e16; Tmax = 0.0;
<a name="l01907"></a>01907                 <span class="keywordflow">for</span> (i = 0; i &lt; nAC; i++)
<a name="l01908"></a>01908                         <span class="keywordflow">if</span> (fabs(<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>-i-1)) &lt; Tmin)
<a name="l01909"></a>01909                                 Tmin = fabs(<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>-i-1));
<a name="l01910"></a>01910                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fabs(<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>-i-1)) &gt; Tmax)
<a name="l01911"></a>01911                                 Tmax = fabs(<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>-i-1));
<a name="l01912"></a>01912                 Tmaxomin = Tmax/Tmin;
<a name="l01913"></a>01913 
<a name="l01914"></a>01914                 <span class="keywordflow">if</span> (iter % 10 == 0)
<a name="l01915"></a>01915                         fprintf(stderr, <span class="stringliteral">&quot;\n%5s %4s %4s %4s %4s %9s %9s %9s %9s %9s %9s %9s %9s\n&quot;</span>,
<a name="l01916"></a>01916                                         <span class="stringliteral">&quot;iter&quot;</span>, <span class="stringliteral">&quot;addB&quot;</span>, <span class="stringliteral">&quot;remB&quot;</span>, <span class="stringliteral">&quot;addC&quot;</span>, <span class="stringliteral">&quot;remC&quot;</span>, <span class="stringliteral">&quot;hom len&quot;</span>, <span class="stringliteral">&quot;tau&quot;</span>, <span class="stringliteral">&quot;stat&quot;</span>,
<a name="l01917"></a>01917                                         <span class="stringliteral">&quot;bfeas&quot;</span>, <span class="stringliteral">&quot;cfeas&quot;</span>, <span class="stringliteral">&quot;bcmpl&quot;</span>, <span class="stringliteral">&quot;ccmpl&quot;</span>, <span class="stringliteral">&quot;Tmin&quot;</span>);
<a name="l01918"></a>01918                 fprintf(stderr, <span class="stringliteral">&quot;%5d &quot;</span>, iter);
<a name="l01919"></a>01919                 <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#aee232819e1d7bd8720872a886aa63f1d">idxAddB</a> &gt;= 0) fprintf(stderr, <span class="stringliteral">&quot;%4d &quot;</span>, <a class="code" href="classQProblem.html#aee232819e1d7bd8720872a886aa63f1d">idxAddB</a>);
<a name="l01920"></a>01920                 <span class="keywordflow">else</span> fprintf(stderr, <span class="stringliteral">&quot;%4s &quot;</span>, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01921"></a>01921                 <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#abad5c15e6d0c621cea0d7355a5eb16c1">idxRemB</a> &gt;= 0) fprintf(stderr, <span class="stringliteral">&quot;%4d &quot;</span>, <a class="code" href="classQProblem.html#abad5c15e6d0c621cea0d7355a5eb16c1">idxRemB</a>);
<a name="l01922"></a>01922                 <span class="keywordflow">else</span> fprintf(stderr, <span class="stringliteral">&quot;%4s &quot;</span>, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01923"></a>01923                 <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#a1b23ea57017d56736b4d90e3f067132d">idxAddC</a> &gt;= 0) fprintf(stderr, <span class="stringliteral">&quot;%4d &quot;</span>, <a class="code" href="classQProblem.html#a1b23ea57017d56736b4d90e3f067132d">idxAddC</a>);
<a name="l01924"></a>01924                 <span class="keywordflow">else</span> fprintf(stderr, <span class="stringliteral">&quot;%4s &quot;</span>, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01925"></a>01925                 <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#ac90fd3f4126680ffdceb86c5a64d1cb8">idxRemC</a> &gt;= 0) fprintf(stderr, <span class="stringliteral">&quot;%4d &quot;</span>, <a class="code" href="classQProblem.html#ac90fd3f4126680ffdceb86c5a64d1cb8">idxRemC</a>);
<a name="l01926"></a>01926                 <span class="keywordflow">else</span> fprintf(stderr, <span class="stringliteral">&quot;%4s &quot;</span>, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01927"></a>01927                 fprintf(stderr, <span class="stringliteral">&quot;%9.2e %9.2e %9.2e %9.2e %9.2e %9.2e %9.2e %9.2e\n&quot;</span>,
<a name="l01928"></a>01928                                 homotopyLength, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>, stat, bfeas, cfeas, bcmpl, ccmpl, Tmin);
<a name="l01929"></a>01929 
<a name="l01930"></a>01930                 <span class="keyword">delete</span>[] AX;
<a name="l01931"></a>01931                 <span class="keyword">delete</span>[] grad;
<a name="l01932"></a>01932 <span class="preprocessor">#else</span>
<a name="l01933"></a>01933 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3c7327943ce25f36479356d33a0b0723">printLevel</a> == -1)
<a name="l01934"></a>01934                 {
<a name="l01935"></a>01935                         <span class="keyword">const</span> <span class="keywordtype">char</span> excStr[] = <span class="stringliteral">&quot; ef&quot;</span>;
<a name="l01936"></a>01936                         <span class="keywordflow">if</span> (iter % 10 == 0)
<a name="l01937"></a>01937                                 fprintf(stdout, <span class="stringliteral">&quot;\n%5s %6s %6s %6s %6s %9s %9s\n&quot;</span>,
<a name="l01938"></a>01938                                                 <span class="stringliteral">&quot;iter&quot;</span>, <span class="stringliteral">&quot;addB&quot;</span>, <span class="stringliteral">&quot;remB&quot;</span>, <span class="stringliteral">&quot;addC&quot;</span>, <span class="stringliteral">&quot;remC&quot;</span>, <span class="stringliteral">&quot;hom len&quot;</span>, <span class="stringliteral">&quot;tau&quot;</span>);
<a name="l01939"></a>01939                         fprintf(stdout, <span class="stringliteral">&quot;%5d &quot;</span>, iter);
<a name="l01940"></a>01940                         <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#aee232819e1d7bd8720872a886aa63f1d">idxAddB</a> &gt;= 0) fprintf(stdout, <span class="stringliteral">&quot;%5d%c &quot;</span>, <a class="code" href="classQProblem.html#aee232819e1d7bd8720872a886aa63f1d">idxAddB</a>, excStr[<a class="code" href="classQProblem.html#a36f054a93eb8dd2876a3e9d8bfb24922">excAddB</a>]);
<a name="l01941"></a>01941                         <span class="keywordflow">else</span> fprintf(stdout, <span class="stringliteral">&quot;%6s &quot;</span>, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01942"></a>01942                         <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#abad5c15e6d0c621cea0d7355a5eb16c1">idxRemB</a> &gt;= 0) fprintf(stdout, <span class="stringliteral">&quot;%5d%c &quot;</span>, <a class="code" href="classQProblem.html#abad5c15e6d0c621cea0d7355a5eb16c1">idxRemB</a>, excStr[<a class="code" href="classQProblem.html#a5d808162c2545f4bb054fe7276f2e65b">excRemB</a>]);
<a name="l01943"></a>01943                         <span class="keywordflow">else</span> fprintf(stdout, <span class="stringliteral">&quot;%6s &quot;</span>, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01944"></a>01944                         <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#a1b23ea57017d56736b4d90e3f067132d">idxAddC</a> &gt;= 0) fprintf(stdout, <span class="stringliteral">&quot;%5d%c &quot;</span>, <a class="code" href="classQProblem.html#a1b23ea57017d56736b4d90e3f067132d">idxAddC</a>, excStr[<a class="code" href="classQProblem.html#adc925de671d66633d16b96fec82566e5">excAddC</a>]);
<a name="l01945"></a>01945                         <span class="keywordflow">else</span> fprintf(stdout, <span class="stringliteral">&quot;%6s &quot;</span>, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01946"></a>01946                         <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#ac90fd3f4126680ffdceb86c5a64d1cb8">idxRemC</a> &gt;= 0) fprintf(stdout, <span class="stringliteral">&quot;%5d%c &quot;</span>, <a class="code" href="classQProblem.html#ac90fd3f4126680ffdceb86c5a64d1cb8">idxRemC</a>, excStr[<a class="code" href="classQProblem.html#a23864f19ab428e3397b1b42f589751f9">excRemC</a>]);
<a name="l01947"></a>01947                         <span class="keywordflow">else</span> fprintf(stdout, <span class="stringliteral">&quot;%6s &quot;</span>, <span class="stringliteral">&quot; &quot;</span>);
<a name="l01948"></a>01948                         fprintf(stdout, <span class="stringliteral">&quot;%9.2e %9.2e\n&quot;</span>, homotopyLength, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>);
<a name="l01949"></a>01949                 }
<a name="l01950"></a>01950 <span class="preprocessor">#endif </span><span class="comment">/* __DEBUG_ITER__ */</span>
<a name="l01951"></a>01951 
<a name="l01952"></a>01952 
<a name="l01953"></a>01953                 <span class="comment">/* 7) Output information of successful QP iteration. */</span>
<a name="l01954"></a>01954                 <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda6f8af598b9b98f5a3582f8063f3b3ecb">QPS_HOMOTOPYQPSOLVED</a>;
<a name="l01955"></a>01955 
<a name="l01956"></a>01956                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3c7327943ce25f36479356d33a0b0723">printLevel</a> &gt; <a class="code" href="Types_8hpp.html#a83ff212f474e3669d8fac2d727f65de5a8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a> )
<a name="l01957"></a>01957                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#aa42a85afe05309ac3860e44f5bb02864">printIteration</a>( iter,BC_idx,BC_status,BC_isBound ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l01958"></a>01958                                 <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadbb2b76be2af017a285a3f42e0b0ee3f">RET_PRINT_ITERATION_FAILED</a> ); <span class="comment">/* do not pass this as return value! */</span>
<a name="l01959"></a>01959 
<a name="l01960"></a>01960                 <span class="comment">/* 8) Perform Ramping Strategy on zero homotopy step or drift correction (if desired). */</span>
<a name="l01961"></a>01961                 <span class="keywordflow">if</span> (BC_status != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a>)
<a name="l01962"></a>01962                 {
<a name="l01963"></a>01963                         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a> &lt; <a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> ) &amp;&amp; ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a8346f6e9a849cc3da7cbbede72a10196">enableRamping</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) )
<a name="l01964"></a>01964                                 <a class="code" href="classQProblem.html#a1905b766c096a2dded5927a9e9824b65">performRamping</a>( );
<a name="l01965"></a>01965                         <span class="keywordflow">else</span>
<a name="l01966"></a>01966                         <span class="keywordflow">if</span> ( (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a7154bdf586544880d867c48eabe741b7">enableDriftCorrection</a> &gt; 0)
<a name="l01967"></a>01967                           &amp;&amp; ((iter+1) % <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a7154bdf586544880d867c48eabe741b7">enableDriftCorrection</a> == 0) )
<a name="l01968"></a>01968                                 <a class="code" href="classQProblem.html#a3535afaf58904aa56fd17e4e49eb50aa">performDriftCorrection</a>( );  <span class="comment">/* always returns SUCCESSFUL_RETURN */</span>
<a name="l01969"></a>01969                 }
<a name="l01970"></a>01970         }
<a name="l01971"></a>01971 
<a name="l01972"></a>01972         <span class="keyword">delete</span>[] delta_yAC; <span class="keyword">delete</span>[] delta_yFX; <span class="keyword">delete</span>[] delta_xFX; <span class="keyword">delete</span>[] delta_xFR;
<a name="l01973"></a>01973         <span class="keyword">delete</span>[] delta_ub; <span class="keyword">delete</span>[] delta_lb; <span class="keyword">delete</span>[] delta_ubA; <span class="keyword">delete</span>[] delta_lbA; <span class="keyword">delete</span>[] delta_g;
<a name="l01974"></a>01974 
<a name="l01975"></a>01975         <span class="comment">/* stop runtime measurement */</span>
<a name="l01976"></a>01976         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l01977"></a>01977                 *cputime = <a class="code" href="Utils_8hpp.html#a07037e36d04406103bdd5de8c87d712d">getCPUtime</a>( ) - starttime;
<a name="l01978"></a>01978 
<a name="l01979"></a>01979 
<a name="l01980"></a>01980         <span class="comment">/* if programm gets to here, output information that QP could not be solved</span>
<a name="l01981"></a>01981 <span class="comment">         * within the given maximum numbers of working set changes */</span>
<a name="l01982"></a>01982         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3c7327943ce25f36479356d33a0b0723">printLevel</a> == <a class="code" href="Types_8hpp.html#a83ff212f474e3669d8fac2d727f65de5a7c08272588ef93a63665031fe77a4cb2">PL_HIGH</a> )
<a name="l01983"></a>01983         {
<a name="l01984"></a>01984 <span class="preprocessor">                #ifndef __XPCTARGET__</span>
<a name="l01985"></a>01985 <span class="preprocessor"></span>                snprintf( messageString,80,<span class="stringliteral">&quot;(nWSR = %d)&quot;</span>,iter );
<a name="l01986"></a>01986                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a20916177fb0e5a55e1cc74df22e53795">throwWarning</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaae4f4541f015531f0d19acc9810665ba">RET_MAX_NWSR_REACHED</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l01987"></a>01987 <span class="preprocessor">                #else</span>
<a name="l01988"></a>01988 <span class="preprocessor"></span>                <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaae4f4541f015531f0d19acc9810665ba">RET_MAX_NWSR_REACHED</a>;
<a name="l01989"></a>01989 <span class="preprocessor">                #endif</span>
<a name="l01990"></a>01990 <span class="preprocessor"></span>        }
<a name="l01991"></a>01991         <span class="keywordflow">else</span>
<a name="l01992"></a>01992         {
<a name="l01993"></a>01993                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaae4f4541f015531f0d19acc9810665ba">RET_MAX_NWSR_REACHED</a>;
<a name="l01994"></a>01994         }
<a name="l01995"></a>01995 }
<a name="l01996"></a>01996 
<a name="l01997"></a>01997 
<a name="l01998"></a>01998 <span class="comment">/*</span>
<a name="l01999"></a>01999 <span class="comment"> *      s o l v e R e g u l a r i s e d Q P</span>
<a name="l02000"></a>02000 <span class="comment"> */</span>
<a name="l02001"></a><a class="code" href="classQProblem.html#a310214d78f1bf41c508fb08ee6b94664">02001</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a310214d78f1bf41c508fb08ee6b94664">QProblem::solveRegularisedQP</a>(       <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> g_new,
<a name="l02002"></a>02002                                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lb_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ub_new,
<a name="l02003"></a>02003                                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lbA_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ubA_new,
<a name="l02004"></a>02004                                                                                         <span class="keywordtype">int</span>&amp; nWSR, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> cputime, <span class="keywordtype">int</span> nWSRperformed
<a name="l02005"></a>02005                                                                                         )
<a name="l02006"></a>02006 {
<a name="l02007"></a>02007         <span class="keywordtype">int</span> i, step;
<a name="l02008"></a>02008         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l02009"></a>02009 
<a name="l02010"></a>02010 
<a name="l02011"></a>02011         <span class="comment">/* Stop here if QP has not been regularised (i.e. normal QP solution). */</span>
<a name="l02012"></a>02012         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ad3b0413d59cf68b7ee855561082b60ef">usingRegularisation</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l02013"></a>02013                 <span class="keywordflow">return</span> <a class="code" href="classQProblem.html#ab794bdf2eb366226da400441f2e0d365">solveQP</a>( g_new,lb_new,ub_new,lbA_new,ubA_new, nWSR,cputime,nWSRperformed );
<a name="l02014"></a>02014 
<a name="l02015"></a>02015 
<a name="l02016"></a>02016         <span class="comment">/* I) SOLVE USUAL REGULARISED QP */</span>
<a name="l02017"></a>02017         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue;
<a name="l02018"></a>02018 
<a name="l02019"></a>02019         <span class="keywordtype">int</span> nWSR_max   = nWSR;
<a name="l02020"></a>02020         <span class="keywordtype">int</span> nWSR_total = nWSRperformed;
<a name="l02021"></a>02021 
<a name="l02022"></a>02022         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> cputime_total = 0.0;
<a name="l02023"></a>02023         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> cputime_cur   = 0.0;
<a name="l02024"></a>02024 
<a name="l02025"></a>02025         <span class="keywordflow">if</span> ( cputime == 0 )
<a name="l02026"></a>02026         {
<a name="l02027"></a>02027                 returnvalue = <a class="code" href="classQProblem.html#ab794bdf2eb366226da400441f2e0d365">solveQP</a>( g_new,lb_new,ub_new,lbA_new,ubA_new, nWSR,0,nWSRperformed );
<a name="l02028"></a>02028         }
<a name="l02029"></a>02029         <span class="keywordflow">else</span>
<a name="l02030"></a>02030         {
<a name="l02031"></a>02031                 cputime_cur = *cputime;
<a name="l02032"></a>02032                 returnvalue = <a class="code" href="classQProblem.html#ab794bdf2eb366226da400441f2e0d365">solveQP</a>( g_new,lb_new,ub_new,lbA_new,ubA_new, nWSR,&amp;cputime_cur,nWSRperformed );
<a name="l02033"></a>02033         }
<a name="l02034"></a>02034         nWSR_total     = nWSR;
<a name="l02035"></a>02035         cputime_total += cputime_cur;
<a name="l02036"></a>02036 
<a name="l02037"></a>02037         <span class="comment">/* Only continue if QP solution has been successful. */</span>
<a name="l02038"></a>02038         <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02039"></a>02039         {
<a name="l02040"></a>02040                 <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l02041"></a>02041                         *cputime = cputime_total;
<a name="l02042"></a>02042 
<a name="l02043"></a>02043                 <span class="keywordflow">if</span> ( returnvalue == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaae4f4541f015531f0d19acc9810665ba">RET_MAX_NWSR_REACHED</a> )
<a name="l02044"></a>02044                         <a class="code" href="MessageHandling_8hpp.html#a733e8e8f13934b6799f96a6dc8185439">THROWWARNING</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea9938f74eaab66668ea4fb5fb1ccf8588">RET_NO_REGSTEP_NWSR</a> );
<a name="l02045"></a>02045 
<a name="l02046"></a>02046                 <span class="keywordflow">return</span> returnvalue;
<a name="l02047"></a>02047         }
<a name="l02048"></a>02048 
<a name="l02049"></a>02049 
<a name="l02050"></a>02050         <span class="comment">/* II) PERFORM SUCCESSIVE REGULARISATION STEPS */</span>
<a name="l02051"></a>02051         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* gMod = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l02052"></a>02052 
<a name="l02053"></a>02053         <span class="keywordflow">for</span>( step=0; step&lt;<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a0993f3821e2570755fffed48a5f00cff">numRegularisationSteps</a>; ++step )
<a name="l02054"></a>02054         {
<a name="l02055"></a>02055                 <span class="comment">/* 1) Modify gradient: gMod = g - eps*xOpt</span>
<a name="l02056"></a>02056 <span class="comment">                 *    (assuming regularisation matrix to be eps*Id). */</span>
<a name="l02057"></a>02057                 <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l02058"></a>02058                         gMod[i] = g_new[i] - <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3521b2ae6a97e3f10f08ef8130ca7a49">epsRegularisation</a>*<a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02059"></a>02059 
<a name="l02060"></a>02060                 <span class="comment">/* 2) Solve regularised QP with modified gradient allowing</span>
<a name="l02061"></a>02061 <span class="comment">                 *    only as many working set recalculations and CPU time</span>
<a name="l02062"></a>02062 <span class="comment">                 *    as have been left from previous QP solutions. */</span>
<a name="l02063"></a>02063                 if ( cputime == 0 )
<a name="l02064"></a>02064                 {
<a name="l02065"></a>02065                         nWSR = nWSR_max;
<a name="l02066"></a>02066                         returnvalue = <a class="code" href="classQProblem.html#ab794bdf2eb366226da400441f2e0d365">solveQP</a>( gMod,lb_new,ub_new,lbA_new,ubA_new, nWSR,0,nWSR_total );
<a name="l02067"></a>02067                 }
<a name="l02068"></a>02068                 <span class="keywordflow">else</span>
<a name="l02069"></a>02069                 {
<a name="l02070"></a>02070                         nWSR = nWSR_max;
<a name="l02071"></a>02071                         cputime_cur = *cputime - cputime_total;
<a name="l02072"></a>02072                         returnvalue = <a class="code" href="classQProblem.html#ab794bdf2eb366226da400441f2e0d365">solveQP</a>( gMod,lb_new,ub_new,lbA_new,ubA_new, nWSR,&amp;cputime_cur,nWSR_total );
<a name="l02073"></a>02073                 }
<a name="l02074"></a>02074 
<a name="l02075"></a>02075                 nWSR_total     = nWSR;
<a name="l02076"></a>02076                 cputime_total += cputime_cur;
<a name="l02077"></a>02077 
<a name="l02078"></a>02078                 <span class="comment">/* Only continue if QP solution has been successful. */</span>
<a name="l02079"></a>02079                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02080"></a>02080                 {
<a name="l02081"></a>02081                         <span class="keyword">delete</span>[] gMod;
<a name="l02082"></a>02082 
<a name="l02083"></a>02083                         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l02084"></a>02084                                 *cputime = cputime_total;
<a name="l02085"></a>02085 
<a name="l02086"></a>02086                         <span class="keywordflow">if</span> ( returnvalue == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaae4f4541f015531f0d19acc9810665ba">RET_MAX_NWSR_REACHED</a> )
<a name="l02087"></a>02087                                 <a class="code" href="MessageHandling_8hpp.html#a733e8e8f13934b6799f96a6dc8185439">THROWWARNING</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eae37f70d6c492aea2915ea9b3d4aaa46e">RET_FEWER_REGSTEPS_NWSR</a> );
<a name="l02088"></a>02088 
<a name="l02089"></a>02089                         <span class="keywordflow">return</span> returnvalue;
<a name="l02090"></a>02090                 }
<a name="l02091"></a>02091         }
<a name="l02092"></a>02092 
<a name="l02093"></a>02093         <span class="keyword">delete</span>[] gMod;
<a name="l02094"></a>02094 
<a name="l02095"></a>02095         <span class="keywordflow">if</span> ( cputime != 0 )
<a name="l02096"></a>02096                 *cputime = cputime_total;
<a name="l02097"></a>02097 
<a name="l02098"></a>02098         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02099"></a>02099 }
<a name="l02100"></a>02100 
<a name="l02101"></a>02101 
<a name="l02102"></a>02102 <span class="comment">/*</span>
<a name="l02103"></a>02103 <span class="comment"> *      s e t u p S u b j e c t T o T y p e</span>
<a name="l02104"></a>02104 <span class="comment"> */</span>
<a name="l02105"></a><a class="code" href="classQProblem.html#af024ebec53f988671f24ee98e71394a1">02105</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#af024ebec53f988671f24ee98e71394a1">QProblem::setupSubjectToType</a>( )
<a name="l02106"></a>02106 {
<a name="l02107"></a>02107         <span class="keywordflow">return</span> <a class="code" href="classQProblem.html#af024ebec53f988671f24ee98e71394a1">setupSubjectToType</a>( <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>,<a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>,<a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>,<a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a> );
<a name="l02108"></a>02108 }
<a name="l02109"></a>02109 
<a name="l02110"></a>02110 
<a name="l02111"></a>02111 <span class="comment">/*</span>
<a name="l02112"></a>02112 <span class="comment"> *      s e t u p S u b j e c t T o T y p e</span>
<a name="l02113"></a>02113 <span class="comment"> */</span>
<a name="l02114"></a><a class="code" href="classQProblem.html#a2b526270858f09361f3a523124a0f0ba">02114</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#af024ebec53f988671f24ee98e71394a1">QProblem::setupSubjectToType</a>(       <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lb_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ub_new,
<a name="l02115"></a>02115                                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lbA_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ubA_new
<a name="l02116"></a>02116                                                                                         )
<a name="l02117"></a>02117 {
<a name="l02118"></a>02118         <span class="keywordtype">int</span> i;
<a name="l02119"></a>02119         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l02120"></a>02120 
<a name="l02121"></a>02121 
<a name="l02122"></a>02122         <span class="comment">/* I) SETUP SUBJECTTOTYPE FOR BOUNDS */</span>
<a name="l02123"></a>02123         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a4aa7da7c8454c0e53e65f923cd5c6e21">QProblemB::setupSubjectToType</a>( lb_new,ub_new ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02124"></a>02124                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ead8cfe81eac7ddb75ab04d1c1e933e8e4">RET_SETUPSUBJECTTOTYPE_FAILED</a> );
<a name="l02125"></a>02125 
<a name="l02126"></a>02126 
<a name="l02127"></a>02127         <span class="comment">/* II) SETUP SUBJECTTOTYPE FOR CONSTRAINTS */</span>
<a name="l02128"></a>02128         <span class="comment">/* 1) Check if lower constraints&#39; bounds are present. */</span>
<a name="l02129"></a>02129         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a5c83994df77ef2ef2b8f2bace9ff8a83">setNoLower</a>( <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> );
<a name="l02130"></a>02130         <span class="keywordflow">if</span> ( lbA_new != 0 )
<a name="l02131"></a>02131         {
<a name="l02132"></a>02132                 <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02133"></a>02133                 {
<a name="l02134"></a>02134                         <span class="keywordflow">if</span> ( lbA_new[i] &gt; -<a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> )
<a name="l02135"></a>02135                         {
<a name="l02136"></a>02136                                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a5c83994df77ef2ef2b8f2bace9ff8a83">setNoLower</a>( <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> );
<a name="l02137"></a>02137                                 <span class="keywordflow">break</span>;
<a name="l02138"></a>02138                         }
<a name="l02139"></a>02139                 }
<a name="l02140"></a>02140         }
<a name="l02141"></a>02141 
<a name="l02142"></a>02142         <span class="comment">/* 2) Check if upper constraints&#39; bounds are present. */</span>
<a name="l02143"></a>02143         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a3cb48f0d24fc5cdd11697465c5b46f13">setNoUpper</a>( <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> );
<a name="l02144"></a>02144         <span class="keywordflow">if</span> ( ubA_new != 0 )
<a name="l02145"></a>02145         {
<a name="l02146"></a>02146                 <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02147"></a>02147                 {
<a name="l02148"></a>02148                         <span class="keywordflow">if</span> ( ubA_new[i] &lt; <a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> )
<a name="l02149"></a>02149                         {
<a name="l02150"></a>02150                                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a3cb48f0d24fc5cdd11697465c5b46f13">setNoUpper</a>( <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> );
<a name="l02151"></a>02151                                 <span class="keywordflow">break</span>;
<a name="l02152"></a>02152                         }
<a name="l02153"></a>02153                 }
<a name="l02154"></a>02154         }
<a name="l02155"></a>02155 
<a name="l02156"></a>02156         <span class="comment">/* 3) Determine implicit equality constraints and unbounded constraints. */</span>
<a name="l02157"></a>02157         <span class="keywordflow">if</span> ( ( lbA_new != 0 ) &amp;&amp; ( ubA_new != 0 ) )
<a name="l02158"></a>02158         {
<a name="l02159"></a>02159                 <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02160"></a>02160                 {
<a name="l02161"></a>02161                         <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a> (i) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a0dee93bdee24d1a0823663359cb5f448">ST_DISABLED</a>)
<a name="l02162"></a>02162                                 <span class="keywordflow">continue</span>;
<a name="l02163"></a>02163                         
<a name="l02164"></a>02164                         <span class="keywordflow">if</span> ( ( lbA_new[i] &lt; -<a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> + <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a9cc43ec93c854bd0302de1a940fda5dd">boundTolerance</a> ) &amp;&amp; ( ubA_new[i] &gt; <a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> - <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a9cc43ec93c854bd0302de1a940fda5dd">boundTolerance</a> )
<a name="l02165"></a>02165                                         &amp;&amp; (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa691471f2994643343ddcf2b697a19aa">enableFarBounds</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>))
<a name="l02166"></a>02166                         {
<a name="l02167"></a>02167                                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a9ff5234a3584b76063c07339bfd53c31">setType</a>( i,<a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a> );
<a name="l02168"></a>02168                         }
<a name="l02169"></a>02169                         <span class="keywordflow">else</span>
<a name="l02170"></a>02170                         {
<a name="l02171"></a>02171                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a21c673d77ae5210038a05ca2a41bd1da">enableEqualities</a> &amp;&amp; <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] &gt; <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] - <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a9cc43ec93c854bd0302de1a940fda5dd">boundTolerance</a> 
<a name="l02172"></a>02172                                                               &amp;&amp; lbA_new[i] &gt; ubA_new[i] - <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a9cc43ec93c854bd0302de1a940fda5dd">boundTolerance</a>)
<a name="l02173"></a>02173                                         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a9ff5234a3584b76063c07339bfd53c31">setType</a>( i,<a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> );
<a name="l02174"></a>02174                                 <span class="keywordflow">else</span>
<a name="l02175"></a>02175                                         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a9ff5234a3584b76063c07339bfd53c31">setType</a>( i,<a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3ad2ba0f85d1cc4d5ee72baabed496af36">ST_BOUNDED</a> );
<a name="l02176"></a>02176                         }
<a name="l02177"></a>02177                 }
<a name="l02178"></a>02178         }
<a name="l02179"></a>02179         <span class="keywordflow">else</span>
<a name="l02180"></a>02180         {
<a name="l02181"></a>02181                 <span class="keywordflow">if</span> ( ( lbA_new == 0 ) &amp;&amp; ( ubA_new == 0 ) )
<a name="l02182"></a>02182                 {
<a name="l02183"></a>02183                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02184"></a>02184                                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a9ff5234a3584b76063c07339bfd53c31">setType</a>( i,<a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a> );
<a name="l02185"></a>02185                 }
<a name="l02186"></a>02186                 <span class="keywordflow">else</span>
<a name="l02187"></a>02187                 {
<a name="l02188"></a>02188                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02189"></a>02189                                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a9ff5234a3584b76063c07339bfd53c31">setType</a>( i,<a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3ad2ba0f85d1cc4d5ee72baabed496af36">ST_BOUNDED</a> );
<a name="l02190"></a>02190                 }
<a name="l02191"></a>02191         }
<a name="l02192"></a>02192 
<a name="l02193"></a>02193         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02194"></a>02194 }
<a name="l02195"></a>02195 
<a name="l02196"></a>02196 
<a name="l02197"></a>02197 <span class="comment">/*</span>
<a name="l02198"></a>02198 <span class="comment"> *      c h o l e s k y D e c o m p o s i t i o n P r o j e c t e d</span>
<a name="l02199"></a>02199 <span class="comment"> */</span>
<a name="l02200"></a><a class="code" href="classQProblem.html#a8587edd6e4cb55879d84a5297c4896fd">02200</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a8587edd6e4cb55879d84a5297c4896fd">QProblem::setupCholeskyDecompositionProjected</a>( )
<a name="l02201"></a>02201 {
<a name="l02202"></a>02202         <span class="keywordtype">int</span> i, j;
<a name="l02203"></a>02203         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l02204"></a>02204         <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l02205"></a>02205 
<a name="l02206"></a>02206         <span class="comment">/* Revert to unprotected Cholesky decomposition */</span>
<a name="l02207"></a>02207         <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>() + <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>() == 0)
<a name="l02208"></a>02208                 <span class="keywordflow">return</span> <a class="code" href="classQProblemB.html#a8f47f2c6e9a5d0eaf78c15fa7eeb91e8">QProblemB::setupCholeskyDecomposition</a> ();
<a name="l02209"></a>02209         
<a name="l02210"></a>02210         <span class="comment">/* 1) Initialises R with all zeros. */</span>
<a name="l02211"></a>02211         <span class="keywordflow">for</span>( i=0; i&lt;nV*nV; ++i )
<a name="l02212"></a>02212                 <a class="code" href="classQProblemB.html#a8402fb9f4dbfaa9ad433457ba03751f0">R</a>[i] = 0.0;
<a name="l02213"></a>02213 
<a name="l02214"></a>02214         <span class="comment">/* Do not do anything for empty null spaces (important for LP case, HST_ZERO !)*/</span>
<a name="l02215"></a>02215         <span class="keywordflow">if</span> (nV - <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>() - <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>() == 0)
<a name="l02216"></a>02216                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02217"></a>02217         
<a name="l02218"></a>02218         <span class="comment">/* 2) Calculate Cholesky decomposition of projected Hessian Z&#39;*H*Z. */</span>
<a name="l02219"></a>02219         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> ) || ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> ) )
<a name="l02220"></a>02220         {
<a name="l02221"></a>02221                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )
<a name="l02222"></a>02222                 {
<a name="l02223"></a>02223                         <span class="comment">/* if Hessian is zero matrix, it is assumed that it has been</span>
<a name="l02224"></a>02224 <span class="comment">                         * regularised and thus its Cholesky factor is the identity</span>
<a name="l02225"></a>02225 <span class="comment">                         * matrix scaled by sqrt(eps). */</span>
<a name="l02226"></a>02226                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ad3b0413d59cf68b7ee855561082b60ef">usingRegularisation</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l02227"></a>02227                         {
<a name="l02228"></a>02228                                 <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l02229"></a>02229                                         <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,i) = sqrt( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3521b2ae6a97e3f10f08ef8130ca7a49">epsRegularisation</a> );
<a name="l02230"></a>02230                         }
<a name="l02231"></a>02231                         <span class="keywordflow">else</span>
<a name="l02232"></a>02232                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eac010883bce1404389f9ab873fd54b132">RET_CHOLESKY_OF_ZERO_HESSIAN</a> );
<a name="l02233"></a>02233                 }
<a name="l02234"></a>02234                 <span class="keywordflow">else</span>
<a name="l02235"></a>02235                 {
<a name="l02236"></a>02236                         <span class="comment">/* if Hessian is identity, so is its Cholesky factor. */</span>
<a name="l02237"></a>02237                         <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l02238"></a>02238                                 <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,i) = 1.0;
<a name="l02239"></a>02239                 }
<a name="l02240"></a>02240         }
<a name="l02241"></a>02241         <span class="keywordflow">else</span>
<a name="l02242"></a>02242         {
<a name="l02243"></a>02243                 <span class="keywordflow">if</span> ( nZ &gt; 0 )
<a name="l02244"></a>02244                 {
<a name="l02245"></a>02245                         <span class="keywordtype">int</span>* FR_idx;
<a name="l02246"></a>02246                         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l02247"></a>02247 
<a name="l02248"></a>02248                         <span class="keywordtype">int</span>* AC_idx;
<a name="l02249"></a>02249                         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l02250"></a>02250 
<a name="l02251"></a>02251                         <span class="comment">/* calculate Z&#39;*H*Z */</span>
<a name="l02252"></a>02252                         <span class="keywordflow">if</span> (<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a> ()-&gt;<a class="code" href="classIndexlist.html#a60283130d120b0ff22c0e3964d8d2b27">getLength</a> () == 0) {
<a name="l02253"></a>02253                                 <span class="comment">/* make Z trivial */</span>
<a name="l02254"></a>02254                                 <span class="keywordflow">for</span> ( j=0; j &lt; nZ; ++j ) {
<a name="l02255"></a>02255                                         <span class="keywordflow">for</span> ( i=0; i &lt; nV; ++i )
<a name="l02256"></a>02256                                                 <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(i,j) = 0.0;
<a name="l02257"></a>02257                                         <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(FR_idx[j],j) = 1.0;
<a name="l02258"></a>02258                                 }
<a name="l02259"></a>02259                                 <span class="comment">/* now Z is trivial, and so is Z&#39;HZ */</span>
<a name="l02260"></a>02260                                 <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a> ();
<a name="l02261"></a>02261                                 <span class="keywordflow">for</span> ( j=0; j &lt; nFR; ++j )
<a name="l02262"></a>02262                                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#a7b9f4ce0fe8c2efc34503bb260383d2c">getCol</a> (FR_idx[j], <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a> (), 1.0, &amp;<a class="code" href="classQProblemB.html#a8402fb9f4dbfaa9ad433457ba03751f0">R</a>[j*nV]);
<a name="l02263"></a>02263                         } <span class="keywordflow">else</span> {
<a name="l02264"></a>02264                                 <span class="comment">/* this is expensive if Z is large! */</span>
<a name="l02265"></a>02265                                 <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classSymmetricMatrix.html#a1ff4cc04a2d05ed5765a981c37ae57eb">bilinear</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), nZ, <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>, nV, <a class="code" href="classQProblemB.html#a8402fb9f4dbfaa9ad433457ba03751f0">R</a>, nV);
<a name="l02266"></a>02266                         }
<a name="l02267"></a>02267 
<a name="l02268"></a>02268                         <span class="comment">/* R&#39;*R = Z&#39;*H*Z */</span>
<a name="l02269"></a>02269                         <span class="keywordtype">long</span> info = 0;
<a name="l02270"></a>02270                         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> _nZ = nZ, _nV = nV;
<a name="l02271"></a>02271 
<a name="l02272"></a>02272                         <a class="code" href="Matrices_8hpp.html#a39fd888b29dc1aba3c780981acdd7f62">POTRF</a> (<span class="stringliteral">&quot;U&quot;</span>, &amp;_nZ, <a class="code" href="classQProblemB.html#a8402fb9f4dbfaa9ad433457ba03751f0">R</a>, &amp;_nV, &amp;info);
<a name="l02273"></a>02273 
<a name="l02274"></a>02274                         <span class="comment">/* &lt;0 = invalid call, =0 ok, &gt;0 not spd */</span>
<a name="l02275"></a>02275                         <span class="keywordflow">if</span> (info &gt; 0) {
<a name="l02276"></a>02276                                 <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> = <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a4bd6c8ccecaaf211801db7381f2361ec">HST_SEMIDEF</a>;
<a name="l02277"></a>02277                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea02db76e7e6badd1b34350674562e9284">RET_HESSIAN_NOT_SPD</a>;
<a name="l02278"></a>02278                         }
<a name="l02279"></a>02279 
<a name="l02280"></a>02280                         <span class="comment">/* zero first subdiagonal to make givens updates work */</span>
<a name="l02281"></a>02281                         <span class="keywordflow">for</span> (i=0;i&lt;nZ-1;++i)
<a name="l02282"></a>02282                                 <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i+1,i) = 0.0;
<a name="l02283"></a>02283                 }
<a name="l02284"></a>02284         }
<a name="l02285"></a>02285 
<a name="l02286"></a>02286         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02287"></a>02287 }
<a name="l02288"></a>02288 
<a name="l02289"></a>02289 
<a name="l02290"></a>02290 <span class="comment">/*</span>
<a name="l02291"></a>02291 <span class="comment"> *      s e t u p T Q f a c t o r i s a t i o n</span>
<a name="l02292"></a>02292 <span class="comment"> */</span>
<a name="l02293"></a><a class="code" href="classQProblem.html#a08d6dfbf81516910e5d7af60f4f67faa">02293</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a08d6dfbf81516910e5d7af60f4f67faa">QProblem::setupTQfactorisation</a>( )
<a name="l02294"></a>02294 {
<a name="l02295"></a>02295         <span class="keywordtype">int</span> i, ii;
<a name="l02296"></a>02296         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l02297"></a>02297         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l02298"></a>02298 
<a name="l02299"></a>02299         <span class="keywordtype">int</span>* FR_idx;
<a name="l02300"></a>02300         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l02301"></a>02301 
<a name="l02302"></a>02302         <span class="comment">/* 1) Set Q to unity matrix. */</span>
<a name="l02303"></a>02303         <span class="keywordflow">for</span>( i=0; i&lt;nV*nV; ++i )
<a name="l02304"></a>02304                 <a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>[i] = 0.0;
<a name="l02305"></a>02305 
<a name="l02306"></a>02306         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l02307"></a>02307         {
<a name="l02308"></a>02308                 ii = FR_idx[i];
<a name="l02309"></a>02309                 <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,i) = 1.0;
<a name="l02310"></a>02310         }
<a name="l02311"></a>02311 
<a name="l02312"></a>02312         <span class="comment">/* 2) Set T to zero matrix. */</span>
<a name="l02313"></a>02313         <span class="keywordflow">for</span>( i=0; i&lt;<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>*<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>; ++i )
<a name="l02314"></a>02314                 <a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a>[i] = 0.0;
<a name="l02315"></a>02315 
<a name="l02316"></a>02316         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02317"></a>02317 }
<a name="l02318"></a>02318 
<a name="l02319"></a>02319 
<a name="l02320"></a>02320 <span class="comment">/*</span>
<a name="l02321"></a>02321 <span class="comment"> *      o b t a i n A u x i l i a r y W o r k i n g S e t</span>
<a name="l02322"></a>02322 <span class="comment"> */</span>
<a name="l02323"></a><a class="code" href="classQProblem.html#a196494261347150c9d8ec6e62c4f0470">02323</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a196494261347150c9d8ec6e62c4f0470">QProblem::obtainAuxiliaryWorkingSet</a>(        <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> xOpt, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> yOpt,
<a name="l02324"></a>02324                                                                                                         <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> guessedBounds, <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> guessedConstraints,
<a name="l02325"></a>02325                                                                                                         <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* auxiliaryBounds, <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* auxiliaryConstraints
<a name="l02326"></a>02326                                                                                                         )<span class="keyword"> const</span>
<a name="l02327"></a>02327 <span class="keyword"></span>{
<a name="l02328"></a>02328         <span class="keywordtype">int</span> i = 0;
<a name="l02329"></a>02329         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l02330"></a>02330         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l02331"></a>02331 
<a name="l02332"></a>02332 
<a name="l02333"></a>02333         <span class="comment">/* 1) Ensure that desiredBounds is allocated (and different from guessedBounds). */</span>
<a name="l02334"></a>02334         <span class="keywordflow">if</span> ( ( auxiliaryBounds == 0 ) || ( auxiliaryBounds == guessedBounds ) )
<a name="l02335"></a>02335                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l02336"></a>02336 
<a name="l02337"></a>02337         <span class="keywordflow">if</span> ( ( auxiliaryConstraints == 0 ) || ( auxiliaryConstraints == guessedConstraints ) )
<a name="l02338"></a>02338                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l02339"></a>02339 
<a name="l02340"></a>02340 
<a name="l02341"></a>02341         <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> guessedStatus;
<a name="l02342"></a>02342 
<a name="l02343"></a>02343         <span class="comment">/* 2) Setup working set of bounds for auxiliary initial QP. */</span>
<a name="l02344"></a>02344         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af91ae892262c4bac8b2388387610eb40">QProblemB::obtainAuxiliaryWorkingSet</a>( xOpt,yOpt,guessedBounds, auxiliaryBounds ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02345"></a>02345                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02346"></a>02346 
<a name="l02347"></a>02347         <span class="comment">/* 3) Setup working set of constraints for auxiliary initial QP. */</span>
<a name="l02348"></a>02348         <span class="keywordflow">if</span> ( guessedConstraints != 0 )
<a name="l02349"></a>02349         {
<a name="l02350"></a>02350                 <span class="comment">/* If an initial working set is specific, use it!</span>
<a name="l02351"></a>02351 <span class="comment">                 * Moreover, add all equality constraints if specified. */</span>
<a name="l02352"></a>02352                 <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02353"></a>02353                 {
<a name="l02354"></a>02354                         <span class="comment">/* Add constraint only if it is not (goint to be) disabled! */</span>
<a name="l02355"></a>02355                         guessedStatus = guessedConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i );
<a name="l02356"></a>02356 
<a name="l02357"></a>02357 <span class="preprocessor">                        #ifdef __ALWAYS_INITIALISE_WITH_ALL_EQUALITIES__</span>
<a name="l02358"></a>02358 <span class="preprocessor"></span>                        <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02359"></a>02359                         {
<a name="l02360"></a>02360                                 <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02361"></a>02361                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02362"></a>02362                         }
<a name="l02363"></a>02363                         <span class="keywordflow">else</span>
<a name="l02364"></a>02364 <span class="preprocessor">                        #endif</span>
<a name="l02365"></a>02365 <span class="preprocessor"></span>                        {
<a name="l02366"></a>02366                                 <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,guessedStatus ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02367"></a>02367                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02368"></a>02368                         }
<a name="l02369"></a>02369                 }
<a name="l02370"></a>02370         }
<a name="l02371"></a>02371         <span class="keywordflow">else</span>    <span class="comment">/* No initial working set specified. */</span>
<a name="l02372"></a>02372         {
<a name="l02373"></a>02373                 <span class="comment">/* Obtain initial working set by &quot;clipping&quot;. */</span>
<a name="l02374"></a>02374                 <span class="keywordflow">if</span> ( ( xOpt != 0 ) &amp;&amp; ( yOpt == 0 ) )
<a name="l02375"></a>02375                 {
<a name="l02376"></a>02376                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02377"></a>02377                         {
<a name="l02378"></a>02378                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i] - <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] &lt;= <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a9cc43ec93c854bd0302de1a940fda5dd">boundTolerance</a> )
<a name="l02379"></a>02379                                 {
<a name="l02380"></a>02380                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02381"></a>02381                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02382"></a>02382                                         <span class="keywordflow">continue</span>;
<a name="l02383"></a>02383                                 }
<a name="l02384"></a>02384 
<a name="l02385"></a>02385                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] - <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] &lt;= <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a9cc43ec93c854bd0302de1a940fda5dd">boundTolerance</a> )
<a name="l02386"></a>02386                                 {
<a name="l02387"></a>02387                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02388"></a>02388                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02389"></a>02389                                         <span class="keywordflow">continue</span>;
<a name="l02390"></a>02390                                 }
<a name="l02391"></a>02391 
<a name="l02392"></a>02392                                 <span class="comment">/* Moreover, add all equality constraints if specified. */</span>
<a name="l02393"></a>02393 <span class="preprocessor">                                #ifdef __ALWAYS_INITIALISE_WITH_ALL_EQUALITIES__</span>
<a name="l02394"></a>02394 <span class="preprocessor"></span>                                <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02395"></a>02395                                 {
<a name="l02396"></a>02396                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02397"></a>02397                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02398"></a>02398                                 }
<a name="l02399"></a>02399                                 <span class="keywordflow">else</span>
<a name="l02400"></a>02400 <span class="preprocessor">                                #endif</span>
<a name="l02401"></a>02401 <span class="preprocessor"></span>                                {
<a name="l02402"></a>02402                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02403"></a>02403                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02404"></a>02404                                 }
<a name="l02405"></a>02405                         }
<a name="l02406"></a>02406                 }
<a name="l02407"></a>02407 
<a name="l02408"></a>02408                 <span class="comment">/* Obtain initial working set in accordance to sign of dual solution vector. */</span>
<a name="l02409"></a>02409                 <span class="keywordflow">if</span> ( ( xOpt == 0 ) &amp;&amp; ( yOpt != 0 ) )
<a name="l02410"></a>02410                 {
<a name="l02411"></a>02411                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02412"></a>02412                         {
<a name="l02413"></a>02413                                 <span class="keywordflow">if</span> ( yOpt[nV+i] &gt; <a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> )
<a name="l02414"></a>02414                                 {
<a name="l02415"></a>02415                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02416"></a>02416                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02417"></a>02417                                         <span class="keywordflow">continue</span>;
<a name="l02418"></a>02418                                 }
<a name="l02419"></a>02419 
<a name="l02420"></a>02420                                 <span class="keywordflow">if</span> ( yOpt[nV+i] &lt; -<a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> )
<a name="l02421"></a>02421                                 {
<a name="l02422"></a>02422                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02423"></a>02423                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02424"></a>02424                                         <span class="keywordflow">continue</span>;
<a name="l02425"></a>02425                                 }
<a name="l02426"></a>02426 
<a name="l02427"></a>02427                                 <span class="comment">/* Moreover, add all equality constraints if specified. */</span>
<a name="l02428"></a>02428 <span class="preprocessor">                                #ifdef __ALWAYS_INITIALISE_WITH_ALL_EQUALITIES__</span>
<a name="l02429"></a>02429 <span class="preprocessor"></span>                                <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02430"></a>02430                                 {
<a name="l02431"></a>02431                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02432"></a>02432                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02433"></a>02433                                 }
<a name="l02434"></a>02434                                 <span class="keywordflow">else</span>
<a name="l02435"></a>02435 <span class="preprocessor">                                #endif</span>
<a name="l02436"></a>02436 <span class="preprocessor"></span>                                {
<a name="l02437"></a>02437                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02438"></a>02438                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02439"></a>02439                                 }
<a name="l02440"></a>02440                         }
<a name="l02441"></a>02441                 }
<a name="l02442"></a>02442 
<a name="l02443"></a>02443                 <span class="comment">/* If xOpt and yOpt are null pointer and no initial working is specified,</span>
<a name="l02444"></a>02444 <span class="comment">                 * start with empty working set (or implicitly fixed bounds and equality constraints only)</span>
<a name="l02445"></a>02445 <span class="comment">                 * for auxiliary QP. */</span>
<a name="l02446"></a>02446                 <span class="keywordflow">if</span> ( ( xOpt == 0 ) &amp;&amp; ( yOpt == 0 ) )
<a name="l02447"></a>02447                 {
<a name="l02448"></a>02448                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02449"></a>02449                         {
<a name="l02450"></a>02450                                 <span class="comment">/* Only add all equality constraints if specified. */</span>
<a name="l02451"></a>02451 <span class="preprocessor">                                #ifdef __ALWAYS_INITIALISE_WITH_ALL_EQUALITIES__</span>
<a name="l02452"></a>02452 <span class="preprocessor"></span>                                <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02453"></a>02453                                 {
<a name="l02454"></a>02454                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02455"></a>02455                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02456"></a>02456                                 }
<a name="l02457"></a>02457                                 <span class="keywordflow">else</span>
<a name="l02458"></a>02458 <span class="preprocessor">                                #endif</span>
<a name="l02459"></a>02459 <span class="preprocessor"></span>                                {
<a name="l02460"></a>02460                                         <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classConstraints.html#adf491114415cbbad8f1a0af0f832ccf6">setupConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02461"></a>02461                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea8561f367ac14ea033be8c63da8a54615">RET_OBTAINING_WORKINGSET_FAILED</a> );
<a name="l02462"></a>02462                                 }
<a name="l02463"></a>02463                         }
<a name="l02464"></a>02464                 }
<a name="l02465"></a>02465         }
<a name="l02466"></a>02466 
<a name="l02467"></a>02467         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02468"></a>02468 }
<a name="l02469"></a>02469 
<a name="l02470"></a>02470 
<a name="l02471"></a>02471 
<a name="l02472"></a>02472 <span class="comment">/*</span>
<a name="l02473"></a>02473 <span class="comment"> *      s e t u p A u x i l i a r y W o r k i n g S e t</span>
<a name="l02474"></a>02474 <span class="comment"> */</span>
<a name="l02475"></a><a class="code" href="classQProblem.html#a1779e923a5f84cdddd33bbe38735f58c">02475</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a1779e923a5f84cdddd33bbe38735f58c">QProblem::setupAuxiliaryWorkingSet</a>( <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> auxiliaryBounds,
<a name="l02476"></a>02476                                                                                                 <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> auxiliaryConstraints,
<a name="l02477"></a>02477                                                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> setupAfresh
<a name="l02478"></a>02478                                                                                                 )
<a name="l02479"></a>02479 {
<a name="l02480"></a>02480         <span class="keywordtype">int</span> i;
<a name="l02481"></a>02481         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l02482"></a>02482         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l02483"></a>02483         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> WSisTrivial = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l02484"></a>02484 
<a name="l02485"></a>02485         <span class="comment">/* consistency checks */</span>
<a name="l02486"></a>02486         <span class="keywordflow">if</span> ( auxiliaryBounds != 0 )
<a name="l02487"></a>02487         {
<a name="l02488"></a>02488                 <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l02489"></a>02489                         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> ) || ( auxiliaryBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> ) )
<a name="l02490"></a>02490                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaee57058f3b42d5e58c701115a79c38a0">RET_UNKNOWN_BUG</a> );
<a name="l02491"></a>02491         }
<a name="l02492"></a>02492         <span class="keywordflow">else</span>
<a name="l02493"></a>02493         {
<a name="l02494"></a>02494                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l02495"></a>02495         }
<a name="l02496"></a>02496 
<a name="l02497"></a>02497         <span class="keywordflow">if</span> ( auxiliaryConstraints != 0 )
<a name="l02498"></a>02498         {
<a name="l02499"></a>02499                 <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02500"></a>02500                         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> ) || ( auxiliaryConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> ) )
<a name="l02501"></a>02501                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaee57058f3b42d5e58c701115a79c38a0">RET_UNKNOWN_BUG</a> );
<a name="l02502"></a>02502         }
<a name="l02503"></a>02503         <span class="keywordflow">else</span>
<a name="l02504"></a>02504         {
<a name="l02505"></a>02505                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l02506"></a>02506         }
<a name="l02507"></a>02507 
<a name="l02508"></a>02508         <span class="comment">/* Check for trivial working set (all and only bounds active) */</span>
<a name="l02509"></a>02509         <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++)
<a name="l02510"></a>02510                 <span class="keywordflow">if</span> (auxiliaryBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(i) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>)
<a name="l02511"></a>02511                 {
<a name="l02512"></a>02512                         WSisTrivial = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l02513"></a>02513                         <span class="keywordflow">break</span>;
<a name="l02514"></a>02514                 }
<a name="l02515"></a>02515         <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++)
<a name="l02516"></a>02516                 <span class="comment">// (ckirches) here we chose to ignore an invalid ST_INACTIVE on </span>
<a name="l02517"></a>02517                 <span class="comment">//            constraints that are ST_EQUALITies or may just have become equalities</span>
<a name="l02518"></a>02518                 <span class="keywordflow">if</span> ( (<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>(i) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a>) <span class="comment">// NOT auxiliaryConstraints here</span>
<a name="l02519"></a>02519                         || (auxiliaryConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(i) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>) )
<a name="l02520"></a>02520                 {
<a name="l02521"></a>02521                         WSisTrivial = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l02522"></a>02522                         <span class="keywordflow">break</span>;
<a name="l02523"></a>02523                 }
<a name="l02524"></a>02524 
<a name="l02525"></a>02525         <span class="keywordflow">if</span> (WSisTrivial == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>)
<a name="l02526"></a>02526         {
<a name="l02527"></a>02527                 <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++)
<a name="l02528"></a>02528                         <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(i) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>)
<a name="l02529"></a>02529                                 <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a6d6f6a6405fb0b7ff607e5a587eedafb">moveFreeToFixed</a>(i, auxiliaryBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(i));
<a name="l02530"></a>02530 
<a name="l02531"></a>02531                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02532"></a>02532         }
<a name="l02533"></a>02533 
<a name="l02534"></a>02534 
<a name="l02535"></a>02535         <span class="comment">/* I) SETUP CHOLESKY FLAG:</span>
<a name="l02536"></a>02536 <span class="comment">         *    Cholesky decomposition shall only be updated if working set</span>
<a name="l02537"></a>02537 <span class="comment">         *    shall be updated (i.e. NOT setup afresh!) */</span>
<a name="l02538"></a>02538         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> updateCholesky;
<a name="l02539"></a>02539         <span class="keywordflow">if</span> ( setupAfresh == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l02540"></a>02540                 updateCholesky = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l02541"></a>02541         <span class="keywordflow">else</span>
<a name="l02542"></a>02542                 updateCholesky = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l02543"></a>02543 
<a name="l02544"></a>02544 
<a name="l02545"></a>02545         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> was_fulli = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a043d6f962a785e05d304950d01461432">enableFullLITests</a>;
<a name="l02546"></a>02546         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> backupEpsLITests = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af972adad4f56f124531725e1248a51e3">epsLITests</a>;
<a name="l02547"></a>02547 
<a name="l02548"></a>02548         <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a043d6f962a785e05d304950d01461432">enableFullLITests</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l02549"></a>02549         <span class="comment">/* options.epsLITests = 1e-1; */</span>
<a name="l02550"></a>02550 
<a name="l02551"></a>02551         <span class="comment">/* II) REMOVE FORMERLY ACTIVE (CONSTRAINTS&#39;) BOUNDS (IF NECESSARY): */</span>
<a name="l02552"></a>02552         <span class="keywordflow">if</span> ( setupAfresh == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l02553"></a>02553         {
<a name="l02554"></a>02554                 <span class="comment">/* 1) Remove all active constraints that shall be inactive or disabled AND</span>
<a name="l02555"></a>02555 <span class="comment">                *    all active constraints that are active at the wrong bound. */</span>
<a name="l02556"></a>02556                 <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02557"></a>02557                 {
<a name="l02558"></a>02558                         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) &amp;&amp; ( auxiliaryConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) )
<a name="l02559"></a>02559                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a140f91786436fd1069e932733eba5abd">removeConstraint</a>( i,updateCholesky,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aeec0473a768989b1a2f587f51709636a">enableNZCTests</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02560"></a>02560                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec83b172cd94f03da12758baad7c25af">RET_SETUP_WORKINGSET_FAILED</a> );
<a name="l02561"></a>02561 
<a name="l02562"></a>02562                         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a> ) &amp;&amp; ( auxiliaryConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a> ) )
<a name="l02563"></a>02563                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a140f91786436fd1069e932733eba5abd">removeConstraint</a>( i,updateCholesky,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aeec0473a768989b1a2f587f51709636a">enableNZCTests</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02564"></a>02564                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec83b172cd94f03da12758baad7c25af">RET_SETUP_WORKINGSET_FAILED</a> );
<a name="l02565"></a>02565                 }
<a name="l02566"></a>02566 
<a name="l02567"></a>02567                 <span class="comment">/* 2) Remove all active bounds that shall be inactive AND</span>
<a name="l02568"></a>02568 <span class="comment">                *    all active bounds that are active at the wrong bound. */</span>
<a name="l02569"></a>02569                 <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l02570"></a>02570                 {
<a name="l02571"></a>02571                         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) &amp;&amp; ( auxiliaryBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ) )
<a name="l02572"></a>02572                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a12931eb86b975a1e3b0537c94c30a290">removeBound</a>( i,updateCholesky,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aeec0473a768989b1a2f587f51709636a">enableNZCTests</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02573"></a>02573                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec83b172cd94f03da12758baad7c25af">RET_SETUP_WORKINGSET_FAILED</a> );
<a name="l02574"></a>02574 
<a name="l02575"></a>02575                         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a> ) &amp;&amp; ( auxiliaryBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a> ) )
<a name="l02576"></a>02576                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a12931eb86b975a1e3b0537c94c30a290">removeBound</a>( i,updateCholesky,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aeec0473a768989b1a2f587f51709636a">enableNZCTests</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02577"></a>02577                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec83b172cd94f03da12758baad7c25af">RET_SETUP_WORKINGSET_FAILED</a> );
<a name="l02578"></a>02578                 }
<a name="l02579"></a>02579         }
<a name="l02580"></a>02580 
<a name="l02581"></a>02581 
<a name="l02582"></a>02582         <span class="comment">/* III) ADD NEWLY ACTIVE (CONSTRAINTS&#39;) BOUNDS: */</span>
<a name="l02583"></a>02583 
<a name="l02584"></a>02584         <span class="comment">/* 1) Add all equality bounds. */</span>
<a name="l02585"></a>02585         <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l02586"></a>02586         {
<a name="l02587"></a>02587                 <span class="comment">//if ( ( bounds.getType( i ) == ST_EQUALITY ) &amp;&amp; ( ( bounds.getStatus( i ) == ST_INACTIVE ) &amp;&amp; ( auxiliaryBounds-&gt;getStatus( i ) != ST_INACTIVE ) ) )</span>
<a name="l02588"></a>02588                 
<a name="l02589"></a>02589                 <span class="comment">// (ckirches) force equalities active</span>
<a name="l02590"></a>02590                 
<a name="l02591"></a>02591                 <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> ) &amp;&amp; ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> ) )
<a name="l02592"></a>02592                 {
<a name="l02593"></a>02593             <span class="comment">// assert ( auxiliaryBounds-&gt;getStatus( i ) != ST_INACTIVE );</span>
<a name="l02594"></a>02594                         <span class="comment">/* No check for linear independence necessary. */</span>
<a name="l02595"></a>02595                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#abaeb7f9dc975f9c19342d1f846ee4e24">addBound</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>,updateCholesky ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> ) <span class="comment">// was auxiliaryBounds-&gt;getStatus( i )</span>
<a name="l02596"></a>02596                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec83b172cd94f03da12758baad7c25af">RET_SETUP_WORKINGSET_FAILED</a> );
<a name="l02597"></a>02597                 }
<a name="l02598"></a>02598         }
<a name="l02599"></a>02599 
<a name="l02600"></a>02600         <span class="comment">/* 2) Add all equality constraints. */</span>
<a name="l02601"></a>02601         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02602"></a>02602         {
<a name="l02603"></a>02603         <span class="comment">//if ( ( constraints.getType( i ) == ST_EQUALITY ) &amp;&amp; ( ( constraints.getStatus( i ) == ST_INACTIVE ) &amp;&amp; ( auxiliaryConstraints-&gt;getStatus( i ) != ST_INACTIVE ) ) )</span>
<a name="l02604"></a>02604 
<a name="l02605"></a>02605                 <span class="comment">// (ckirches) force equalities active</span>
<a name="l02606"></a>02606                 
<a name="l02607"></a>02607                 <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> ) &amp;&amp; ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> ) )
<a name="l02608"></a>02608                 {
<a name="l02609"></a>02609             <span class="comment">// assert ( auxiliaryConstraints-&gt;getStatus( i ) != ST_INACTIVE );</span>
<a name="l02610"></a>02610                         <span class="comment">/* Add constraint only if it is linearly independent from the current working set. */</span>
<a name="l02611"></a>02611                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a1db09f8580bb01e1629b2f2763e24c7f">addConstraint_checkLI</a>( i ) == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea2b543ec23d472ec6632a4b70281bf616">RET_LINEARLY_INDEPENDENT</a> )
<a name="l02612"></a>02612                         {
<a name="l02613"></a>02613                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a9afd51a8349533f7ff5467518c761529">addConstraint</a>( i,<a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>,updateCholesky ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )  <span class="comment">// was auxiliaryConstraints-&gt;getStatus( i )</span>
<a name="l02614"></a>02614                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec83b172cd94f03da12758baad7c25af">RET_SETUP_WORKINGSET_FAILED</a> );
<a name="l02615"></a>02615                         }
<a name="l02616"></a>02616                         <span class="keywordflow">else</span>
<a name="l02617"></a>02617                         {
<a name="l02618"></a>02618                                 <span class="comment">/* Equalities are not linearly independent! */</span>
<a name="l02619"></a>02619                                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a9ff5234a3584b76063c07339bfd53c31">setType</a>(i, <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3ad2ba0f85d1cc4d5ee72baabed496af36">ST_BOUNDED</a>);
<a name="l02620"></a>02620                         }
<a name="l02621"></a>02621                 }
<a name="l02622"></a>02622         }
<a name="l02623"></a>02623 
<a name="l02624"></a>02624 
<a name="l02625"></a>02625         <span class="comment">/* 3) Add all inactive bounds that shall be active AND</span>
<a name="l02626"></a>02626 <span class="comment">         *    all formerly active bounds that have been active at the wrong bound. */</span>
<a name="l02627"></a>02627         <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l02628"></a>02628         {
<a name="l02629"></a>02629                 <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) != <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> ) &amp;&amp; ( ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> ) &amp;&amp; ( auxiliaryBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> ) ) )
<a name="l02630"></a>02630                 {
<a name="l02631"></a>02631                         <span class="comment">/* Add bound only if it is linearly independent from the current working set. */</span>
<a name="l02632"></a>02632                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a946fbc2babac30ff666501f9e0397196">addBound_checkLI</a>( i ) == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea2b543ec23d472ec6632a4b70281bf616">RET_LINEARLY_INDEPENDENT</a> )
<a name="l02633"></a>02633                         {
<a name="l02634"></a>02634                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#abaeb7f9dc975f9c19342d1f846ee4e24">addBound</a>( i,auxiliaryBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ),updateCholesky ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02635"></a>02635                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec83b172cd94f03da12758baad7c25af">RET_SETUP_WORKINGSET_FAILED</a> );
<a name="l02636"></a>02636                         }
<a name="l02637"></a>02637                 }
<a name="l02638"></a>02638         }
<a name="l02639"></a>02639 
<a name="l02640"></a>02640         <span class="comment">/* 4) Add all inactive constraints that shall be active AND</span>
<a name="l02641"></a>02641 <span class="comment">         *    all formerly active constraints that have been active at the wrong bound. */</span>
<a name="l02642"></a>02642         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l02643"></a>02643         {
<a name="l02644"></a>02644                 <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) != <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> ) &amp;&amp; ( auxiliaryConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> ) )
<a name="l02645"></a>02645                 {
<a name="l02646"></a>02646                         <span class="comment">/* formerly inactive */</span>
<a name="l02647"></a>02647                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> )
<a name="l02648"></a>02648                         {
<a name="l02649"></a>02649                                 <span class="comment">/* Add constraint only if it is linearly independent from the current working set. */</span>
<a name="l02650"></a>02650                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a1db09f8580bb01e1629b2f2763e24c7f">addConstraint_checkLI</a>( i ) == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea2b543ec23d472ec6632a4b70281bf616">RET_LINEARLY_INDEPENDENT</a> )
<a name="l02651"></a>02651                                 {
<a name="l02652"></a>02652                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a9afd51a8349533f7ff5467518c761529">addConstraint</a>( i,auxiliaryConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ),updateCholesky ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l02653"></a>02653                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec83b172cd94f03da12758baad7c25af">RET_SETUP_WORKINGSET_FAILED</a> );
<a name="l02654"></a>02654                                 }
<a name="l02655"></a>02655                         }
<a name="l02656"></a>02656                 }
<a name="l02657"></a>02657         }
<a name="l02658"></a>02658 
<a name="l02659"></a>02659         <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a043d6f962a785e05d304950d01461432">enableFullLITests</a> = was_fulli;
<a name="l02660"></a>02660         <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af972adad4f56f124531725e1248a51e3">epsLITests</a> = backupEpsLITests;
<a name="l02661"></a>02661 
<a name="l02662"></a>02662         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02663"></a>02663 }
<a name="l02664"></a>02664 
<a name="l02665"></a>02665 
<a name="l02666"></a>02666 <span class="comment">/*</span>
<a name="l02667"></a>02667 <span class="comment"> *      s e t u p A u x i l i a r y Q P s o l u t i o n</span>
<a name="l02668"></a>02668 <span class="comment"> */</span>
<a name="l02669"></a><a class="code" href="classQProblem.html#a393d3526ea02bb6ec26896c857f70bb6">02669</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a393d3526ea02bb6ec26896c857f70bb6">QProblem::setupAuxiliaryQPsolution</a>( <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> xOpt, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> yOpt
<a name="l02670"></a>02670                                                                                                 )
<a name="l02671"></a>02671 {
<a name="l02672"></a>02672         <span class="keywordtype">int</span> i, j;
<a name="l02673"></a>02673         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l02674"></a>02674         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l02675"></a>02675 
<a name="l02676"></a>02676 
<a name="l02677"></a>02677         <span class="comment">/* Setup primal/dual solution vector for auxiliary initial QP:</span>
<a name="l02678"></a>02678 <span class="comment">         * if a null pointer is passed, a zero vector is assigned;</span>
<a name="l02679"></a>02679 <span class="comment">         *  old solution vector is kept if pointer to internal solution vevtor is passed. */</span>
<a name="l02680"></a>02680         <span class="keywordflow">if</span> ( xOpt != 0 )
<a name="l02681"></a>02681         {
<a name="l02682"></a>02682                 <span class="keywordflow">if</span> ( xOpt != <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a> )
<a name="l02683"></a>02683                         <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l02684"></a>02684                                 <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] = xOpt[i];
<a name="l02685"></a>02685 
<a name="l02686"></a>02686                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(1, 1.0, <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>, nV, 0.0, <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>, nC);
<a name="l02687"></a>02687 
<a name="l02688"></a>02688                 <span class="keywordflow">for</span> ( j=0; j&lt;nC; ++j )
<a name="l02689"></a>02689                 {
<a name="l02690"></a>02690                         <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[j] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[j];
<a name="l02691"></a>02691                         <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[j] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[j];
<a name="l02692"></a>02692                 }
<a name="l02693"></a>02693         }
<a name="l02694"></a>02694         <span class="keywordflow">else</span>
<a name="l02695"></a>02695         {
<a name="l02696"></a>02696                 <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l02697"></a>02697                         <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] = 0.0;
<a name="l02698"></a>02698 
<a name="l02699"></a>02699                 <span class="keywordflow">for</span> ( j=0; j&lt;nC; ++j )
<a name="l02700"></a>02700                 {
<a name="l02701"></a>02701                         <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[j] = 0.0;
<a name="l02702"></a>02702                         <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[j] = 0.0;
<a name="l02703"></a>02703                         <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[j] = 0.0;
<a name="l02704"></a>02704                 }
<a name="l02705"></a>02705         }
<a name="l02706"></a>02706 
<a name="l02707"></a>02707         <span class="keywordflow">if</span> ( yOpt != 0 )
<a name="l02708"></a>02708         {
<a name="l02709"></a>02709                 <span class="keywordflow">if</span> ( yOpt != <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a> )
<a name="l02710"></a>02710                         <span class="keywordflow">for</span>( i=0; i&lt;nV+nC; ++i )
<a name="l02711"></a>02711                                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] = yOpt[i];
<a name="l02712"></a>02712         }
<a name="l02713"></a>02713         <span class="keywordflow">else</span>
<a name="l02714"></a>02714         {
<a name="l02715"></a>02715                 <span class="keywordflow">for</span>( i=0; i&lt;nV+nC; ++i )
<a name="l02716"></a>02716                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] = 0.0;
<a name="l02717"></a>02717         }
<a name="l02718"></a>02718 
<a name="l02719"></a>02719         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02720"></a>02720 }
<a name="l02721"></a>02721 
<a name="l02722"></a>02722 
<a name="l02723"></a>02723 <span class="comment">/*</span>
<a name="l02724"></a>02724 <span class="comment"> *      s e t u p A u x i l i a r y Q P g r a d i e n t</span>
<a name="l02725"></a>02725 <span class="comment"> */</span>
<a name="l02726"></a><a class="code" href="classQProblem.html#a20876832f9f362aa98ae9fde45713297">02726</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a20876832f9f362aa98ae9fde45713297">QProblem::setupAuxiliaryQPgradient</a>( )
<a name="l02727"></a>02727 {
<a name="l02728"></a>02728         <span class="keywordtype">int</span> i;
<a name="l02729"></a>02729         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l02730"></a>02730         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l02731"></a>02731 
<a name="l02732"></a>02732 
<a name="l02733"></a>02733         <span class="comment">/* Setup gradient vector: g = -H*x + [Id A]&#39;*[yB yC]</span>
<a name="l02734"></a>02734 <span class="comment">         *                          = yB - H*x + A&#39;*yC. */</span>
<a name="l02735"></a>02735         <span class="keywordflow">switch</span> ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> )
<a name="l02736"></a>02736         {
<a name="l02737"></a>02737                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a>:
<a name="l02738"></a>02738                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ad3b0413d59cf68b7ee855561082b60ef">usingRegularisation</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l02739"></a>02739                                 <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l02740"></a>02740                                         <a class="code" href="classQProblemB.html#a3efcc81e7338d5d41c99e58a766315ba">g</a>[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i];
<a name="l02741"></a>02741                         <span class="keywordflow">else</span>
<a name="l02742"></a>02742                                 <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l02743"></a>02743                                         <a class="code" href="classQProblemB.html#a3efcc81e7338d5d41c99e58a766315ba">g</a>[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] - <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3521b2ae6a97e3f10f08ef8130ca7a49">epsRegularisation</a>*<a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02744"></a>02744                         <span class="keywordflow">break</span>;
<a name="l02745"></a>02745 
<a name="l02746"></a>02746                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a>:
<a name="l02747"></a>02747                         for ( i=0; i&lt;nV; ++i )
<a name="l02748"></a>02748                                 <a class="code" href="classQProblemB.html#a3efcc81e7338d5d41c99e58a766315ba">g</a>[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] - <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02749"></a>02749                         <span class="keywordflow">break</span>;
<a name="l02750"></a>02750 
<a name="l02751"></a>02751                 <span class="keywordflow">default</span>:
<a name="l02752"></a>02752                         <span class="comment">/* y&#39;*Id */</span>
<a name="l02753"></a>02753                         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l02754"></a>02754                                 <a class="code" href="classQProblemB.html#a3efcc81e7338d5d41c99e58a766315ba">g</a>[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i];
<a name="l02755"></a>02755 
<a name="l02756"></a>02756                         <span class="comment">/* - H*x */</span>
<a name="l02757"></a>02757                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(1, -1.0, <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>, nV, 1.0, <a class="code" href="classQProblemB.html#a3efcc81e7338d5d41c99e58a766315ba">g</a>, nV);
<a name="l02758"></a>02758                         <span class="keywordflow">break</span>;
<a name="l02759"></a>02759         }
<a name="l02760"></a>02760 
<a name="l02761"></a>02761         <span class="comment">/* + A&#39;*yC */</span>
<a name="l02762"></a>02762         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aae760f106376a34dfaf0c168fa836d84">transTimes</a>(1, 1.0, <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a> + nV, nC, 1.0, <a class="code" href="classQProblemB.html#a3efcc81e7338d5d41c99e58a766315ba">g</a>, nV);
<a name="l02763"></a>02763 
<a name="l02764"></a>02764         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02765"></a>02765 }
<a name="l02766"></a>02766 
<a name="l02767"></a>02767 
<a name="l02768"></a>02768 <span class="comment">/*</span>
<a name="l02769"></a>02769 <span class="comment"> *      s e t u p A u x i l i a r y Q P b o u n d s</span>
<a name="l02770"></a>02770 <span class="comment"> */</span>
<a name="l02771"></a><a class="code" href="classQProblem.html#a0db2ab7f578d4254353279643219a7f1">02771</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a0db2ab7f578d4254353279643219a7f1">QProblem::setupAuxiliaryQPbounds</a>(   <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> auxiliaryBounds,
<a name="l02772"></a>02772                                                                                                 <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> auxiliaryConstraints,
<a name="l02773"></a>02773                                                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> useRelaxation
<a name="l02774"></a>02774                                                                                                 )
<a name="l02775"></a>02775 {
<a name="l02776"></a>02776         <span class="keywordtype">int</span> i;
<a name="l02777"></a>02777         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l02778"></a>02778         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l02779"></a>02779 
<a name="l02780"></a>02780 
<a name="l02781"></a>02781         <span class="comment">/* 1) Setup bound vectors. */</span>
<a name="l02782"></a>02782         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l02783"></a>02783         {
<a name="l02784"></a>02784                 <span class="keywordflow">switch</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) )
<a name="l02785"></a>02785                 {
<a name="l02786"></a>02786                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>:
<a name="l02787"></a>02787                                 <span class="keywordflow">if</span> ( useRelaxation == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l02788"></a>02788                                 {
<a name="l02789"></a>02789                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02790"></a>02790                                         {
<a name="l02791"></a>02791                                                 <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02792"></a>02792                                                 <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02793"></a>02793                                         }
<a name="l02794"></a>02794                                         <span class="keywordflow">else</span>
<a name="l02795"></a>02795                                         {
<a name="l02796"></a>02796                                                 <span class="comment">/* If a bound is inactive although it was supposed to be</span>
<a name="l02797"></a>02797 <span class="comment">                                                * active by the auxiliaryBounds, it could not be added</span>
<a name="l02798"></a>02798 <span class="comment">                                                * due to linear dependence. Thus set it &quot;strongly inactive&quot;. */</span>
<a name="l02799"></a>02799                                                 <span class="keywordflow">if</span> ( auxiliaryBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l02800"></a>02800                                                         <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02801"></a>02801                                                 <span class="keywordflow">else</span>
<a name="l02802"></a>02802                                                         <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] - <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa23e1c8d7c64953adcc8cc2c3f03d25e">boundRelaxation</a>;
<a name="l02803"></a>02803 
<a name="l02804"></a>02804                                                 <span class="keywordflow">if</span> ( auxiliaryBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a> )
<a name="l02805"></a>02805                                                         <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02806"></a>02806                                                 <span class="keywordflow">else</span>
<a name="l02807"></a>02807                                                         <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] + <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa23e1c8d7c64953adcc8cc2c3f03d25e">boundRelaxation</a>;
<a name="l02808"></a>02808                                         }
<a name="l02809"></a>02809                                 }
<a name="l02810"></a>02810                                 <span class="keywordflow">break</span>;
<a name="l02811"></a>02811 
<a name="l02812"></a>02812                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>:
<a name="l02813"></a>02813                                 <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02814"></a>02814                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02815"></a>02815                                 {
<a name="l02816"></a>02816                                         <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02817"></a>02817                                 }
<a name="l02818"></a>02818                                 <span class="keywordflow">else</span>
<a name="l02819"></a>02819                                 {
<a name="l02820"></a>02820                                         <span class="keywordflow">if</span> ( useRelaxation == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l02821"></a>02821                                                 <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] + <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa23e1c8d7c64953adcc8cc2c3f03d25e">boundRelaxation</a>;
<a name="l02822"></a>02822                                 }
<a name="l02823"></a>02823                                 <span class="keywordflow">break</span>;
<a name="l02824"></a>02824 
<a name="l02825"></a>02825                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>:
<a name="l02826"></a>02826                                 <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02827"></a>02827                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02828"></a>02828                                 {
<a name="l02829"></a>02829                                         <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l02830"></a>02830                                 }
<a name="l02831"></a>02831                                 <span class="keywordflow">else</span>
<a name="l02832"></a>02832                                 {
<a name="l02833"></a>02833                                         <span class="keywordflow">if</span> ( useRelaxation == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l02834"></a>02834                                                 <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] - <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa23e1c8d7c64953adcc8cc2c3f03d25e">boundRelaxation</a>;
<a name="l02835"></a>02835                                 }
<a name="l02836"></a>02836                                 <span class="keywordflow">break</span>;
<a name="l02837"></a>02837 
<a name="l02838"></a>02838             <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a0dee93bdee24d1a0823663359cb5f448">ST_DISABLED</a>:
<a name="l02839"></a>02839                 <span class="keywordflow">break</span>;
<a name="l02840"></a>02840                 
<a name="l02841"></a>02841                         <span class="keywordflow">default</span>:
<a name="l02842"></a>02842                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaee57058f3b42d5e58c701115a79c38a0">RET_UNKNOWN_BUG</a> );
<a name="l02843"></a>02843                 }
<a name="l02844"></a>02844         }
<a name="l02845"></a>02845 
<a name="l02846"></a>02846         <span class="comment">/* 2) Setup constraints vectors. */</span>
<a name="l02847"></a>02847         <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l02848"></a>02848         {
<a name="l02849"></a>02849                 <span class="keywordflow">switch</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) )
<a name="l02850"></a>02850                 {
<a name="l02851"></a>02851                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>:
<a name="l02852"></a>02852                                 <span class="keywordflow">if</span> ( useRelaxation == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l02853"></a>02853                                 {
<a name="l02854"></a>02854                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02855"></a>02855                                         {
<a name="l02856"></a>02856                                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i];
<a name="l02857"></a>02857                                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i];
<a name="l02858"></a>02858                                         }
<a name="l02859"></a>02859                                         <span class="keywordflow">else</span>
<a name="l02860"></a>02860                                         {
<a name="l02861"></a>02861                                                 <span class="comment">/* If a constraint is inactive although it was supposed to be</span>
<a name="l02862"></a>02862 <span class="comment">                                                * active by the auxiliaryConstraints, it could not be added</span>
<a name="l02863"></a>02863 <span class="comment">                                                * due to linear dependence. Thus set it &quot;strongly inactive&quot;. */</span>
<a name="l02864"></a>02864                                                 <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l02865"></a>02865                                                         <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i];
<a name="l02866"></a>02866                                                 <span class="keywordflow">else</span>
<a name="l02867"></a>02867                                                         <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] - <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa23e1c8d7c64953adcc8cc2c3f03d25e">boundRelaxation</a>;
<a name="l02868"></a>02868 
<a name="l02869"></a>02869                                                 <span class="keywordflow">if</span> ( auxiliaryConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a> )
<a name="l02870"></a>02870                                                         <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i];
<a name="l02871"></a>02871                                                 <span class="keywordflow">else</span>
<a name="l02872"></a>02872                                                         <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] + <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa23e1c8d7c64953adcc8cc2c3f03d25e">boundRelaxation</a>;
<a name="l02873"></a>02873                                         }
<a name="l02874"></a>02874                                 }
<a name="l02875"></a>02875                                 <span class="keywordflow">break</span>;
<a name="l02876"></a>02876 
<a name="l02877"></a>02877                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>:
<a name="l02878"></a>02878                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i];
<a name="l02879"></a>02879                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02880"></a>02880                                 {
<a name="l02881"></a>02881                                         <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i];
<a name="l02882"></a>02882                                 }
<a name="l02883"></a>02883                                 <span class="keywordflow">else</span>
<a name="l02884"></a>02884                                 {
<a name="l02885"></a>02885                                         <span class="keywordflow">if</span> ( useRelaxation == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l02886"></a>02886                                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] + <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa23e1c8d7c64953adcc8cc2c3f03d25e">boundRelaxation</a>;
<a name="l02887"></a>02887                                 }
<a name="l02888"></a>02888                                 <span class="keywordflow">break</span>;
<a name="l02889"></a>02889 
<a name="l02890"></a>02890                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>:
<a name="l02891"></a>02891                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i];
<a name="l02892"></a>02892                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( i ) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a> )
<a name="l02893"></a>02893                                 {
<a name="l02894"></a>02894                                         <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i];
<a name="l02895"></a>02895                                 }
<a name="l02896"></a>02896                                 <span class="keywordflow">else</span>
<a name="l02897"></a>02897                                 {
<a name="l02898"></a>02898                                         <span class="keywordflow">if</span> ( useRelaxation == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l02899"></a>02899                                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] - <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aa23e1c8d7c64953adcc8cc2c3f03d25e">boundRelaxation</a>;
<a name="l02900"></a>02900                                 }
<a name="l02901"></a>02901                                 <span class="keywordflow">break</span>;
<a name="l02902"></a>02902 
<a name="l02903"></a>02903             <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a0dee93bdee24d1a0823663359cb5f448">ST_DISABLED</a>:
<a name="l02904"></a>02904                 <span class="keywordflow">break</span>;
<a name="l02905"></a>02905                 
<a name="l02906"></a>02906                         <span class="keywordflow">default</span>:
<a name="l02907"></a>02907                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaee57058f3b42d5e58c701115a79c38a0">RET_UNKNOWN_BUG</a> );
<a name="l02908"></a>02908                 }
<a name="l02909"></a>02909                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] = <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] - <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i];
<a name="l02910"></a>02910                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] = <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] - <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i];
<a name="l02911"></a>02911         }
<a name="l02912"></a>02912 
<a name="l02913"></a>02913         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02914"></a>02914 }
<a name="l02915"></a>02915 
<a name="l02916"></a>02916 
<a name="l02917"></a>02917 <span class="comment">/*</span>
<a name="l02918"></a>02918 <span class="comment"> *      a d d C o n s t r a i n t</span>
<a name="l02919"></a>02919 <span class="comment"> */</span>
<a name="l02920"></a><a class="code" href="classQProblem.html#a9afd51a8349533f7ff5467518c761529">02920</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a9afd51a8349533f7ff5467518c761529">QProblem::addConstraint</a>(    <span class="keywordtype">int</span> number, <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> C_status,
<a name="l02921"></a>02921                                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> updateCholesky,
<a name="l02922"></a>02922                                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> ensureLI
<a name="l02923"></a>02923                                                                                 )
<a name="l02924"></a>02924 {
<a name="l02925"></a>02925         <span class="keywordtype">int</span> i, j, ii;
<a name="l02926"></a>02926 
<a name="l02927"></a>02927         <span class="comment">/* consistency checks */</span>
<a name="l02928"></a>02928         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( number ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> )
<a name="l02929"></a>02929                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea970b860d0fec1c9f992101b59232c856">RET_CONSTRAINT_ALREADY_ACTIVE</a> );
<a name="l02930"></a>02930 
<a name="l02931"></a>02931         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a6a9ec51f7d4f1fcb4ba8bb976cce033b">getNC</a>( ) - <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( ) ) == <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a5e0c6d64167bdf3602093ed26b4cfeaf">getNUC</a>( ) )
<a name="l02932"></a>02932                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaa3d2059b1bc79e01f6043249475b8860">RET_ALL_CONSTRAINTS_ACTIVE</a> );
<a name="l02933"></a>02933 
<a name="l02934"></a>02934         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda5ce84ee8a93fc7e780e2c1e9440c95ed">QPS_NOTINITIALISED</a> )    ||
<a name="l02935"></a>02935                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda1ace398d1f8eddff294c06c72bc58fdb">QPS_AUXILIARYQPSOLVED</a> ) ||
<a name="l02936"></a>02936                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda6f8af598b9b98f5a3582f8063f3b3ecb">QPS_HOMOTOPYQPSOLVED</a> )  ||
<a name="l02937"></a>02937                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdaeaeec92065e112d99b1f82851e069bd3">QPS_SOLVED</a> )            )
<a name="l02938"></a>02938         {
<a name="l02939"></a>02939                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaee57058f3b42d5e58c701115a79c38a0">RET_UNKNOWN_BUG</a> );
<a name="l02940"></a>02940         }
<a name="l02941"></a>02941 
<a name="l02942"></a>02942 
<a name="l02943"></a>02943         <span class="comment">/* I) ENSURE LINEAR INDEPENDENCE OF THE WORKING SET,</span>
<a name="l02944"></a>02944 <span class="comment">         *    i.e. remove a constraint or bound if linear dependence occurs. */</span>
<a name="l02945"></a>02945         <span class="comment">/* check for LI only if Cholesky decomposition shall be updated! */</span>
<a name="l02946"></a>02946         <span class="keywordflow">if</span> ( updateCholesky == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> &amp;&amp; ensureLI == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l02947"></a>02947         {
<a name="l02948"></a>02948                 <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> ensureLIreturnvalue = <a class="code" href="classQProblem.html#ab4f383f420fe3f1e466e0517b2d71f8a">addConstraint_ensureLI</a>( number,C_status );
<a name="l02949"></a>02949 
<a name="l02950"></a>02950                 <span class="keywordflow">switch</span> ( ensureLIreturnvalue )
<a name="l02951"></a>02951                 {
<a name="l02952"></a>02952                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>:
<a name="l02953"></a>02953                                 <span class="keywordflow">break</span>;
<a name="l02954"></a>02954 
<a name="l02955"></a>02955                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea18e98f249c6e5b6f5345620a7ae041c7">RET_LI_RESOLVED</a>:
<a name="l02956"></a>02956                                 <span class="keywordflow">break</span>;
<a name="l02957"></a>02957 
<a name="l02958"></a>02958                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eafc49ac2285671f1bd6a1962baa9dcbf4">RET_ENSURELI_FAILED_NOINDEX</a>:
<a name="l02959"></a>02959                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea953528526fd257edbe17b3965b43d236">RET_ADDCONSTRAINT_FAILED_INFEASIBILITY</a>;
<a name="l02960"></a>02960 
<a name="l02961"></a>02961                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea709d155801b880ababc7f4ea77f5950a">RET_ENSURELI_FAILED_CYCLING</a>:
<a name="l02962"></a>02962                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea953528526fd257edbe17b3965b43d236">RET_ADDCONSTRAINT_FAILED_INFEASIBILITY</a>;
<a name="l02963"></a>02963                                 
<a name="l02964"></a>02964                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0671c4114677051c98f8b9ac29df192a">RET_ENSURELI_DROPPED</a>:
<a name="l02965"></a>02965                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l02966"></a>02966 
<a name="l02967"></a>02967                         <span class="keywordflow">default</span>:
<a name="l02968"></a>02968                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaf56d4e19751ab0b0b237ac494a974eb3">RET_ENSURELI_FAILED</a> );
<a name="l02969"></a>02969                 }
<a name="l02970"></a>02970         }
<a name="l02971"></a>02971 
<a name="l02972"></a>02972         <span class="comment">/* some definitions */</span>
<a name="l02973"></a>02973         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l02974"></a>02974         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l02975"></a>02975         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l02976"></a>02976         <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l02977"></a>02977 
<a name="l02978"></a>02978         <span class="keywordtype">int</span> tcol = <a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a> - nAC;
<a name="l02979"></a>02979 
<a name="l02980"></a>02980 
<a name="l02981"></a>02981         <span class="keywordtype">int</span>* FR_idx;
<a name="l02982"></a>02982         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l02983"></a>02983 
<a name="l02984"></a>02984         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* aFR = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l02985"></a>02985         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* wZ = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nZ];
<a name="l02986"></a>02986         <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l02987"></a>02987                 wZ[i] = 0.0;
<a name="l02988"></a>02988 
<a name="l02989"></a>02989 
<a name="l02990"></a>02990         <span class="comment">/* II) ADD NEW ACTIVE CONSTRAINT TO MATRIX T: */</span>
<a name="l02991"></a>02991         <span class="comment">/* 1) Add row [wZ wY] = aFR&#39;*[Z Y] to the end of T: assign aFR. */</span>
<a name="l02992"></a>02992         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#ab67514f6450264a6c8d55b319802099d">getRow</a>(number, <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1.0, aFR);
<a name="l02993"></a>02993 
<a name="l02994"></a>02994         <span class="comment">/* calculate wZ */</span>
<a name="l02995"></a>02995         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l02996"></a>02996         {
<a name="l02997"></a>02997                 ii = FR_idx[i];
<a name="l02998"></a>02998                 <span class="keywordflow">for</span>( j=0; j&lt;nZ; ++j )
<a name="l02999"></a>02999                         wZ[j] += aFR[i] * <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j);
<a name="l03000"></a>03000         }
<a name="l03001"></a>03001 
<a name="l03002"></a>03002         <span class="comment">/* 2) Calculate wY and store it directly into T. */</span>
<a name="l03003"></a>03003         <span class="keywordflow">if</span> ( nAC &gt; 0 )
<a name="l03004"></a>03004         {
<a name="l03005"></a>03005                 <span class="keywordflow">for</span>( j=0; j&lt;nAC; ++j )
<a name="l03006"></a>03006                         <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC,tcol+j) = 0.0;
<a name="l03007"></a>03007                 <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l03008"></a>03008                 {
<a name="l03009"></a>03009                         ii = FR_idx[i];
<a name="l03010"></a>03010                         <span class="keywordflow">for</span>( j=0; j&lt;nAC; ++j )
<a name="l03011"></a>03011                                 <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC,tcol+j) += aFR[i] * <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+j);
<a name="l03012"></a>03012                 }
<a name="l03013"></a>03013         }
<a name="l03014"></a>03014 
<a name="l03015"></a>03015         <span class="keyword">delete</span>[] aFR;
<a name="l03016"></a>03016 
<a name="l03017"></a>03017 
<a name="l03018"></a>03018         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> c, s, nu;
<a name="l03019"></a>03019 
<a name="l03020"></a>03020         <span class="keywordflow">if</span> ( nZ &gt; 0 )
<a name="l03021"></a>03021         {
<a name="l03022"></a>03022                 <span class="comment">/* II) RESTORE TRIANGULAR FORM OF T: */</span>
<a name="l03023"></a>03023                 <span class="comment">/*     Use column-wise Givens rotations to restore reverse triangular form</span>
<a name="l03024"></a>03024 <span class="comment">                *      of T, simultanenous change of Q (i.e. Z) and R. */</span>
<a name="l03025"></a>03025                 <span class="keywordflow">for</span>( j=0; j&lt;nZ-1; ++j )
<a name="l03026"></a>03026                 {
<a name="l03027"></a>03027                         <a class="code" href="classQProblemB.html#a736d704a3575d1a4ec4565ddfdf3e6d8">computeGivens</a>( wZ[j+1],wZ[j], wZ[j+1],wZ[j],c,s );
<a name="l03028"></a>03028                         nu = s/(1.0+c);
<a name="l03029"></a>03029 
<a name="l03030"></a>03030                         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l03031"></a>03031                         {
<a name="l03032"></a>03032                                 ii = FR_idx[i];
<a name="l03033"></a>03033                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j), <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j) );
<a name="l03034"></a>03034                         }
<a name="l03035"></a>03035 
<a name="l03036"></a>03036                         <span class="keywordflow">if</span> ( ( updateCholesky == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp;
<a name="l03037"></a>03037                                  ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )   &amp;&amp; ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> ) )
<a name="l03038"></a>03038                         {
<a name="l03039"></a>03039                                 <span class="keywordflow">for</span>( i=0; i&lt;=j+1; ++i )
<a name="l03040"></a>03040                                         <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,1+j),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,j), <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,1+j),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,j) );
<a name="l03041"></a>03041                         }
<a name="l03042"></a>03042                 }
<a name="l03043"></a>03043 
<a name="l03044"></a>03044                 <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC,tcol-1) = wZ[nZ-1];
<a name="l03045"></a>03045 
<a name="l03046"></a>03046 
<a name="l03047"></a>03047                 <span class="keywordflow">if</span> ( ( updateCholesky == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp;
<a name="l03048"></a>03048                          ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )   &amp;&amp; ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> ) )
<a name="l03049"></a>03049                 {
<a name="l03050"></a>03050                         <span class="comment">/* III) RESTORE TRIANGULAR FORM OF R:</span>
<a name="l03051"></a>03051 <span class="comment">                         *      Use row-wise Givens rotations to restore upper triangular form of R. */</span>
<a name="l03052"></a>03052                         <span class="keywordflow">for</span>( i=0; i&lt;nZ-1; ++i )
<a name="l03053"></a>03053                         {
<a name="l03054"></a>03054                                 <a class="code" href="classQProblemB.html#a736d704a3575d1a4ec4565ddfdf3e6d8">computeGivens</a>( <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,i),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(1+i,i), <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,i),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(1+i,i),c,s );
<a name="l03055"></a>03055                                 nu = s/(1.0+c);
<a name="l03056"></a>03056 
<a name="l03057"></a>03057                                 <span class="keywordflow">for</span>( j=(1+i); j&lt;(nZ-1); ++j ) <span class="comment">/* last column of R is thrown away */</span>
<a name="l03058"></a>03058                                         <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,j),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(1+i,j), <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,j),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(1+i,j) );
<a name="l03059"></a>03059                         }
<a name="l03060"></a>03060                         <span class="comment">/* last column of R is thrown away */</span>
<a name="l03061"></a>03061                         <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l03062"></a>03062                                 <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,nZ-1) = 0.0;
<a name="l03063"></a>03063                 }
<a name="l03064"></a>03064         }
<a name="l03065"></a>03065 
<a name="l03066"></a>03066         <span class="keyword">delete</span>[] wZ;
<a name="l03067"></a>03067 
<a name="l03068"></a>03068 
<a name="l03069"></a>03069         <span class="comment">/* IV) UPDATE INDICES */</span>
<a name="l03070"></a>03070         <a class="code" href="classQProblem.html#a1b23ea57017d56736b4d90e3f067132d">idxAddC</a> = number;
<a name="l03071"></a>03071         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a6a21e8c620229f44ebb2cfc7a892a31f">moveInactiveToActive</a>( number,C_status ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l03072"></a>03072                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea72eaec3d8a89591844970202800ec637">RET_ADDCONSTRAINT_FAILED</a> );
<a name="l03073"></a>03073 
<a name="l03074"></a>03074 
<a name="l03075"></a>03075         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l03076"></a>03076 }
<a name="l03077"></a>03077 
<a name="l03078"></a>03078 
<a name="l03079"></a>03079 
<a name="l03080"></a>03080 <span class="comment">/*</span>
<a name="l03081"></a>03081 <span class="comment"> *      a d d C o n s t r a i n t _ c h e c k L I</span>
<a name="l03082"></a>03082 <span class="comment"> */</span>
<a name="l03083"></a><a class="code" href="classQProblem.html#a1db09f8580bb01e1629b2f2763e24c7f">03083</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a1db09f8580bb01e1629b2f2763e24c7f">QProblem::addConstraint_checkLI</a>( <span class="keywordtype">int</span> number )
<a name="l03084"></a>03084 {
<a name="l03085"></a>03085         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea50bd78d9856144c5df0c5e2b5615e92d">RET_LINEARLY_DEPENDENT</a>;
<a name="l03086"></a>03086 
<a name="l03087"></a>03087         <span class="keywordtype">int</span> i, j, ii;
<a name="l03088"></a>03088         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l03089"></a>03089         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l03090"></a>03090         <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l03091"></a>03091         <span class="keywordtype">int</span> nC  = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l03092"></a>03092         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>();
<a name="l03093"></a>03093         <span class="keywordtype">int</span> nFX = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>();
<a name="l03094"></a>03094         <span class="keywordtype">int</span> *FR_idx;
<a name="l03095"></a>03095 
<a name="l03096"></a>03096         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l03097"></a>03097 
<a name="l03098"></a>03098 
<a name="l03099"></a>03099         <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a043d6f962a785e05d304950d01461432">enableFullLITests</a>)
<a name="l03100"></a>03100         {
<a name="l03101"></a>03101                 <span class="comment">/*</span>
<a name="l03102"></a>03102 <span class="comment">                 * expensive LI test. Backsolve with refinement using special right</span>
<a name="l03103"></a>03103 <span class="comment">                 * hand side. This gives an estimate for what should be considered</span>
<a name="l03104"></a>03104 <span class="comment">                 * &quot;zero&quot;. We then check linear independence relative to this estimate.</span>
<a name="l03105"></a>03105 <span class="comment">                 */</span>
<a name="l03106"></a>03106 
<a name="l03107"></a>03107                 <span class="keywordtype">int</span> *FX_idx, *AC_idx, *IAC_idx;
<a name="l03108"></a>03108 
<a name="l03109"></a>03109                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_g   = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l03110"></a>03110                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_xFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l03111"></a>03111                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_xFR = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l03112"></a>03112                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_yAC = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l03113"></a>03113                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_yFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l03114"></a>03114 
<a name="l03115"></a>03115                 <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FX_idx );
<a name="l03116"></a>03116                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l03117"></a>03117                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#ab4d19324b973e26a90f1a406b2dcfc1d">getInactive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;IAC_idx );
<a name="l03118"></a>03118 
<a name="l03119"></a>03119                 <span class="keywordtype">int</span> dim = (nC&gt;nV)?nC:nV;
<a name="l03120"></a>03120                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *nul = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[dim];
<a name="l03121"></a>03121                 <span class="keywordflow">for</span> (ii = 0; ii &lt; dim; ++ii)
<a name="l03122"></a>03122                         nul[ii]=0.0;
<a name="l03123"></a>03123 
<a name="l03124"></a>03124                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#ab67514f6450264a6c8d55b319802099d">getRow</a> (number, 0, 1.0, delta_g);
<a name="l03125"></a>03125 
<a name="l03126"></a>03126                 returnvalue = <a class="code" href="classQProblem.html#a1b2636572bd7eeed4f23222a6a1653e1">determineStepDirection</a> ( delta_g,
<a name="l03127"></a>03127                                                                                           nul, nul, nul, nul,
<a name="l03128"></a>03128                                                                                           <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,
<a name="l03129"></a>03129                                                                                           delta_xFX, delta_xFR, delta_yAC, delta_yFX);
<a name="l03130"></a>03130                 <span class="keyword">delete</span>[] nul;
<a name="l03131"></a>03131 
<a name="l03132"></a>03132                 <span class="comment">/* compute the weight in inf-norm */</span>
<a name="l03133"></a>03133                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> weight = 0.0;
<a name="l03134"></a>03134                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nAC; ++ii)
<a name="l03135"></a>03135                 {
<a name="l03136"></a>03136                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_yAC[ii]);
<a name="l03137"></a>03137                         <span class="keywordflow">if</span> (weight &lt; a) weight = a;
<a name="l03138"></a>03138                 }
<a name="l03139"></a>03139                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nFX; ++ii)
<a name="l03140"></a>03140                 {
<a name="l03141"></a>03141                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_yFX[ii]);
<a name="l03142"></a>03142                         <span class="keywordflow">if</span> (weight &lt; a) weight = a;
<a name="l03143"></a>03143                 }
<a name="l03144"></a>03144 
<a name="l03145"></a>03145                 <span class="comment">/* look at the &quot;zero&quot; in a relative inf-norm */</span>
<a name="l03146"></a>03146                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> zero = 0.0;
<a name="l03147"></a>03147                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nFX; ++ii)
<a name="l03148"></a>03148                 {
<a name="l03149"></a>03149                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_xFX[ii]);
<a name="l03150"></a>03150                         <span class="keywordflow">if</span> (zero &lt; a) zero = a;
<a name="l03151"></a>03151                 }
<a name="l03152"></a>03152                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nFR; ++ii)
<a name="l03153"></a>03153                 {
<a name="l03154"></a>03154                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_xFR[ii]);
<a name="l03155"></a>03155                         <span class="keywordflow">if</span> (zero &lt; a) zero = a;
<a name="l03156"></a>03156                 }
<a name="l03157"></a>03157 
<a name="l03158"></a>03158                 <span class="comment">/* relative test against zero in inf-norm */</span>
<a name="l03159"></a>03159                 <span class="keywordflow">if</span> (zero &gt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af972adad4f56f124531725e1248a51e3">epsLITests</a> * weight)
<a name="l03160"></a>03160                         returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea2b543ec23d472ec6632a4b70281bf616">RET_LINEARLY_INDEPENDENT</a>;
<a name="l03161"></a>03161 
<a name="l03162"></a>03162                 <span class="keyword">delete</span>[] delta_yFX;
<a name="l03163"></a>03163                 <span class="keyword">delete</span>[] delta_yAC;
<a name="l03164"></a>03164                 <span class="keyword">delete</span>[] delta_xFR;
<a name="l03165"></a>03165                 <span class="keyword">delete</span>[] delta_xFX;
<a name="l03166"></a>03166                 <span class="keyword">delete</span>[] delta_g;
<a name="l03167"></a>03167 
<a name="l03168"></a>03168         }
<a name="l03169"></a>03169         <span class="keywordflow">else</span>
<a name="l03170"></a>03170         {
<a name="l03171"></a>03171                 <span class="comment">/*</span>
<a name="l03172"></a>03172 <span class="comment">                 * cheap LI test for constraint. Check if constraint &lt;number&gt; is</span>
<a name="l03173"></a>03173 <span class="comment">                 * linearly independent from the the active ones (&lt;=&gt; is element of null</span>
<a name="l03174"></a>03174 <span class="comment">                 * space of Afr).</span>
<a name="l03175"></a>03175 <span class="comment">                 */</span>
<a name="l03176"></a>03176 
<a name="l03177"></a>03177                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *Arow = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l03178"></a>03178                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#ab67514f6450264a6c8d55b319802099d">getRow</a>(number, <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1.0, Arow);
<a name="l03179"></a>03179 
<a name="l03180"></a>03180                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> sum, l2;
<a name="l03181"></a>03181 
<a name="l03182"></a>03182                 l2  = 0.0;
<a name="l03183"></a>03183                 <span class="keywordflow">for</span> (i = 0; i &lt; nFR; i++)
<a name="l03184"></a>03184                         l2  += Arow[i]*Arow[i];
<a name="l03185"></a>03185 
<a name="l03186"></a>03186                 <span class="keywordflow">for</span>( j=0; j&lt;nZ; ++j )
<a name="l03187"></a>03187                 {
<a name="l03188"></a>03188                         sum = 0.0;
<a name="l03189"></a>03189                         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l03190"></a>03190                         {
<a name="l03191"></a>03191                                 ii = FR_idx[i];
<a name="l03192"></a>03192                                 sum += Arow[i] * <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j);
<a name="l03193"></a>03193                         }
<a name="l03194"></a>03194 
<a name="l03195"></a>03195                         <span class="keywordflow">if</span> ( fabs( sum ) &gt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af972adad4f56f124531725e1248a51e3">epsLITests</a>*l2 )
<a name="l03196"></a>03196                         {
<a name="l03197"></a>03197                                 <span class="comment">/*fprintf(stderr, &quot;LI test: |sum| = %9.2e, l2 = %9.2e, var = %d\n&quot;, fabs(sum), l2, jj+1); */</span>
<a name="l03198"></a>03198                                 returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea2b543ec23d472ec6632a4b70281bf616">RET_LINEARLY_INDEPENDENT</a>;
<a name="l03199"></a>03199                                 <span class="keywordflow">break</span>;
<a name="l03200"></a>03200                         }
<a name="l03201"></a>03201                 }
<a name="l03202"></a>03202 
<a name="l03203"></a>03203                 <span class="keyword">delete</span>[] Arow;
<a name="l03204"></a>03204         }
<a name="l03205"></a>03205 
<a name="l03206"></a>03206         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a0ef7741d67176593da953e5baa206ce9">THROWINFO</a>( returnvalue );
<a name="l03207"></a>03207 }
<a name="l03208"></a>03208 
<a name="l03209"></a>03209 
<a name="l03210"></a>03210 <span class="comment">/*</span>
<a name="l03211"></a>03211 <span class="comment"> *      a d d C o n s t r a i n t _ e n s u r e L I</span>
<a name="l03212"></a>03212 <span class="comment"> */</span>
<a name="l03213"></a><a class="code" href="classQProblem.html#ab4f383f420fe3f1e466e0517b2d71f8a">03213</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#ab4f383f420fe3f1e466e0517b2d71f8a">QProblem::addConstraint_ensureLI</a>( <span class="keywordtype">int</span> number, <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> C_status )
<a name="l03214"></a>03214 {
<a name="l03215"></a>03215         <span class="keywordtype">int</span> i, j, ii, jj;
<a name="l03216"></a>03216         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l03217"></a>03217         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l03218"></a>03218         <span class="keywordtype">int</span> nFX = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>( );
<a name="l03219"></a>03219         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l03220"></a>03220         <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l03221"></a>03221 
<a name="l03222"></a>03222 
<a name="l03223"></a>03223         <span class="comment">/* I) Check if new constraint is linearly independent from the active ones. */</span>
<a name="l03224"></a>03224         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalueCheckLI = <a class="code" href="classQProblem.html#a1db09f8580bb01e1629b2f2763e24c7f">addConstraint_checkLI</a>( number );
<a name="l03225"></a>03225 
<a name="l03226"></a>03226         <span class="keywordflow">if</span> ( returnvalueCheckLI == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea02a025b066cd6f22ff6751c167749a88">RET_INDEXLIST_CORRUPTED</a> )
<a name="l03227"></a>03227                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaf56d4e19751ab0b0b237ac494a974eb3">RET_ENSURELI_FAILED</a> );
<a name="l03228"></a>03228 
<a name="l03229"></a>03229         <span class="keywordflow">if</span> ( returnvalueCheckLI == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea2b543ec23d472ec6632a4b70281bf616">RET_LINEARLY_INDEPENDENT</a> )
<a name="l03230"></a>03230                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l03231"></a>03231 
<a name="l03232"></a>03232 
<a name="l03233"></a>03233         <span class="comment">/* II) NEW CONSTRAINT IS LINEARLY DEPENDENT: */</span>
<a name="l03234"></a>03234         <span class="comment">/* 1) Determine coefficients of linear combination,</span>
<a name="l03235"></a>03235 <span class="comment">         *    cf. M.J. Best. Applied Mathematics and Parallel Computing, chapter:</span>
<a name="l03236"></a>03236 <span class="comment">         *    An Algorithm for the Solution of the Parametric Quadratic Programming</span>
<a name="l03237"></a>03237 <span class="comment">         *    Problem, pages 57-76. Physica-Verlag, Heidelberg, 1996. */</span>
<a name="l03238"></a>03238         <span class="keywordtype">int</span>* FR_idx;
<a name="l03239"></a>03239         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l03240"></a>03240 
<a name="l03241"></a>03241         <span class="keywordtype">int</span>* FX_idx;
<a name="l03242"></a>03242         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FX_idx );
<a name="l03243"></a>03243 
<a name="l03244"></a>03244         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* xiC = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l03245"></a>03245         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* xiC_TMP = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l03246"></a>03246         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* xiB = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l03247"></a>03247         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* Arow = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l03248"></a>03248         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* num = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l03249"></a>03249         
<a name="l03250"></a>03250         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l03251"></a>03251 
<a name="l03252"></a>03252         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> y_min = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a0b8e5478791cd5c003882b72a706014f">maxDualJump</a>;
<a name="l03253"></a>03253         <span class="keywordtype">int</span> y_min_number = -1;
<a name="l03254"></a>03254         <span class="keywordtype">int</span> y_min_number_bound = -1;
<a name="l03255"></a>03255         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> y_min_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l03256"></a>03256 
<a name="l03257"></a>03257         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#ab67514f6450264a6c8d55b319802099d">getRow</a>(number, <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), C_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ? 1.0 : -1.0, Arow);
<a name="l03258"></a>03258 
<a name="l03259"></a>03259         <span class="comment">/* 2) Calculate xiC */</span>
<a name="l03260"></a>03260         <span class="keywordflow">if</span> ( nAC &gt; 0 )
<a name="l03261"></a>03261         {
<a name="l03262"></a>03262                 <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l03263"></a>03263                 {
<a name="l03264"></a>03264                         xiC_TMP[i] = 0.0;
<a name="l03265"></a>03265                         <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l03266"></a>03266                         {
<a name="l03267"></a>03267                                 jj = FR_idx[j];
<a name="l03268"></a>03268                                 xiC_TMP[i] += <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(jj,nZ+i) * Arow[j];
<a name="l03269"></a>03269                         }
<a name="l03270"></a>03270                 }
<a name="l03271"></a>03271 
<a name="l03272"></a>03272                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0563822d48c2b9316ceb1a3abd8ac536">backsolveT</a>( xiC_TMP, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, xiC ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l03273"></a>03273                 {
<a name="l03274"></a>03274                         returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea25f01dc1c5b356ea0b163826d763211e">RET_ENSURELI_FAILED_TQ</a>;
<a name="l03275"></a>03275                         <span class="keywordflow">goto</span> farewell;
<a name="l03276"></a>03276                 }
<a name="l03277"></a>03277         }
<a name="l03278"></a>03278 
<a name="l03279"></a>03279         <span class="comment">/* 3) Calculate xiB. */</span>
<a name="l03280"></a>03280         <span class="keywordtype">int</span>* AC_idx;
<a name="l03281"></a>03281         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l03282"></a>03282 
<a name="l03283"></a>03283         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#ab67514f6450264a6c8d55b319802099d">getRow</a>(number, <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), C_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ? 1.0 : -1.0, xiB);
<a name="l03284"></a>03284         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aae760f106376a34dfaf0c168fa836d84">transTimes</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), 1, -1.0, xiC, nAC, 1.0, xiB, nFX);
<a name="l03285"></a>03285 
<a name="l03286"></a>03286         <span class="comment">/* III) DETERMINE CONSTRAINT/BOUND TO BE REMOVED. */</span>
<a name="l03287"></a>03287         
<a name="l03288"></a>03288         <span class="comment">/* 1) Constraints. */</span>
<a name="l03289"></a>03289         <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l03290"></a>03290         {
<a name="l03291"></a>03291                 ii = AC_idx[i];
<a name="l03292"></a>03292                 num[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+ii];
<a name="l03293"></a>03293         }
<a name="l03294"></a>03294 
<a name="l03295"></a>03295         <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a> (nAC, AC_idx, &amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>, num, xiC, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, y_min, y_min_number);    
<a name="l03296"></a>03296 
<a name="l03297"></a>03297         <span class="comment">/* 2) Bounds. */</span>
<a name="l03298"></a>03298         <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l03299"></a>03299         {
<a name="l03300"></a>03300                 ii = FX_idx[i];
<a name="l03301"></a>03301                 num[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[ii];
<a name="l03302"></a>03302         }
<a name="l03303"></a>03303 
<a name="l03304"></a>03304         <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a> (nFX, FX_idx, &amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>, num, xiB, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, y_min, y_min_number_bound);
<a name="l03305"></a>03305 
<a name="l03306"></a>03306         <span class="keywordflow">if</span> ( y_min_number_bound &gt;= 0 )
<a name="l03307"></a>03307         {
<a name="l03308"></a>03308                 y_min_number = y_min_number_bound;
<a name="l03309"></a>03309                 y_min_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l03310"></a>03310         }
<a name="l03311"></a>03311 
<a name="l03312"></a>03312 <span class="preprocessor">        #ifndef __XPCTARGET__</span>
<a name="l03313"></a>03313 <span class="preprocessor"></span>        <span class="comment">/* setup output preferences */</span>
<a name="l03314"></a>03314         <span class="keywordtype">char</span> messageString[80];
<a name="l03315"></a>03315 <span class="preprocessor">        #endif</span>
<a name="l03316"></a>03316 <span class="preprocessor"></span>        
<a name="l03317"></a>03317         <span class="comment">/* IV) REMOVE CONSTRAINT/BOUND FOR RESOLVING LINEAR DEPENDENCE: */</span>
<a name="l03318"></a>03318         <span class="keywordflow">if</span> ( y_min_number &gt;= 0 )
<a name="l03319"></a>03319         {
<a name="l03320"></a>03320                 <span class="comment">/* Update Lagrange multiplier... */</span>
<a name="l03321"></a>03321                 <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l03322"></a>03322                 {
<a name="l03323"></a>03323                         ii = AC_idx[i];
<a name="l03324"></a>03324                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+ii] -= y_min * xiC[i];
<a name="l03325"></a>03325                 }
<a name="l03326"></a>03326                 <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l03327"></a>03327                 {
<a name="l03328"></a>03328                         ii = FX_idx[i];
<a name="l03329"></a>03329                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[ii] -= y_min * xiB[i];
<a name="l03330"></a>03330                 }
<a name="l03331"></a>03331 
<a name="l03332"></a>03332                 <span class="comment">/* ... also for newly active constraint... */</span>
<a name="l03333"></a>03333                 <span class="keywordflow">if</span> ( C_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l03334"></a>03334                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+number] = y_min;
<a name="l03335"></a>03335                 <span class="keywordflow">else</span>
<a name="l03336"></a>03336                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+number] = -y_min;
<a name="l03337"></a>03337 
<a name="l03338"></a>03338                 <span class="comment">/* ... and for constraint to be removed. */</span>
<a name="l03339"></a>03339                 <span class="keywordflow">if</span> ( y_min_isBound == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l03340"></a>03340                 {
<a name="l03341"></a>03341 <span class="preprocessor">                        #ifndef __XPCTARGET__</span>
<a name="l03342"></a>03342 <span class="preprocessor"></span>                        snprintf( messageString,80,<span class="stringliteral">&quot;bound no. %d.&quot;</span>,y_min_number );
<a name="l03343"></a>03343                         <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0f461fcae9d87e4b1334401a3be6eb46">RET_REMOVE_FROM_ACTIVESET</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l03344"></a>03344 <span class="preprocessor">                        #endif</span>
<a name="l03345"></a>03345 <span class="preprocessor"></span>
<a name="l03346"></a>03346                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a12931eb86b975a1e3b0537c94c30a290">removeBound</a>( y_min_number,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l03347"></a>03347                         {
<a name="l03348"></a>03348                                 returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaddb537678cb9d40290ba4e0ef5514a37">RET_REMOVE_FROM_ACTIVESET_FAILED</a>;
<a name="l03349"></a>03349                                 <span class="keywordflow">goto</span> farewell;
<a name="l03350"></a>03350                         }
<a name="l03351"></a>03351                         <a class="code" href="classQProblem.html#a5d808162c2545f4bb054fe7276f2e65b">excRemB</a> = 1;
<a name="l03352"></a>03352                         
<a name="l03353"></a>03353                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[y_min_number] = 0.0;
<a name="l03354"></a>03354                 }
<a name="l03355"></a>03355                 <span class="keywordflow">else</span>
<a name="l03356"></a>03356                 {
<a name="l03357"></a>03357 <span class="preprocessor">                        #ifndef __XPCTARGET__</span>
<a name="l03358"></a>03358 <span class="preprocessor"></span>                        snprintf( messageString,80,<span class="stringliteral">&quot;constraint no. %d.&quot;</span>,y_min_number );
<a name="l03359"></a>03359                         <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0f461fcae9d87e4b1334401a3be6eb46">RET_REMOVE_FROM_ACTIVESET</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l03360"></a>03360 <span class="preprocessor">                        #endif</span>
<a name="l03361"></a>03361 <span class="preprocessor"></span>
<a name="l03362"></a>03362                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a140f91786436fd1069e932733eba5abd">removeConstraint</a>( y_min_number,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l03363"></a>03363                         {
<a name="l03364"></a>03364                                 returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaddb537678cb9d40290ba4e0ef5514a37">RET_REMOVE_FROM_ACTIVESET_FAILED</a>;
<a name="l03365"></a>03365                                 <span class="keywordflow">goto</span> farewell;
<a name="l03366"></a>03366                         }
<a name="l03367"></a>03367                         <a class="code" href="classQProblem.html#a23864f19ab428e3397b1b42f589751f9">excRemC</a> = 1;
<a name="l03368"></a>03368 
<a name="l03369"></a>03369                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+y_min_number] = 0.0;
<a name="l03370"></a>03370                 }
<a name="l03371"></a>03371         }
<a name="l03372"></a>03372         <span class="keywordflow">else</span>
<a name="l03373"></a>03373         {
<a name="l03374"></a>03374                 <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a471b77ce66c8b16a06e61d94af785f91">enableDropInfeasibles</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>) {
<a name="l03375"></a>03375                         <span class="comment">/* dropping of infeasible constraints according to drop priorities */</span>
<a name="l03376"></a>03376                         returnvalue = <a class="code" href="classQProblem.html#adbc81cf7d22c43f5e8459129443abc5a">dropInfeasibles</a> (number, C_status, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, xiB, xiC);
<a name="l03377"></a>03377                 }
<a name="l03378"></a>03378                 <span class="keywordflow">else</span>
<a name="l03379"></a>03379                 {
<a name="l03380"></a>03380                         <span class="comment">/* no constraint/bound can be removed =&gt; QP is infeasible! */</span>           
<a name="l03381"></a>03381                         returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eafc49ac2285671f1bd6a1962baa9dcbf4">RET_ENSURELI_FAILED_NOINDEX</a>;
<a name="l03382"></a>03382                         <a class="code" href="classQProblemB.html#a0ee80a22826580862cc33ca63fe35d23">setInfeasibilityFlag</a>( returnvalue );
<a name="l03383"></a>03383                 }
<a name="l03384"></a>03384         }
<a name="l03385"></a>03385 
<a name="l03386"></a>03386 farewell:
<a name="l03387"></a>03387         <span class="keyword">delete</span>[] num;
<a name="l03388"></a>03388         <span class="keyword">delete</span>[] Arow;
<a name="l03389"></a>03389         <span class="keyword">delete</span>[] xiB; 
<a name="l03390"></a>03390         <span class="keyword">delete</span>[] xiC_TMP; 
<a name="l03391"></a>03391         <span class="keyword">delete</span>[] xiC;
<a name="l03392"></a>03392 
<a name="l03393"></a>03393         <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea18e98f249c6e5b6f5345620a7ae041c7">RET_LI_RESOLVED</a>,0,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l03394"></a>03394         
<a name="l03395"></a>03395         <span class="keywordflow">return</span> (returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>) ? <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a> (returnvalue) : returnvalue;
<a name="l03396"></a>03396 }
<a name="l03397"></a>03397 
<a name="l03398"></a>03398 
<a name="l03399"></a>03399 
<a name="l03400"></a>03400 <span class="comment">/*</span>
<a name="l03401"></a>03401 <span class="comment"> *      a d d B o u n d</span>
<a name="l03402"></a>03402 <span class="comment"> */</span>
<a name="l03403"></a><a class="code" href="classQProblem.html#abaeb7f9dc975f9c19342d1f846ee4e24">03403</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#abaeb7f9dc975f9c19342d1f846ee4e24">QProblem::addBound</a>( <span class="keywordtype">int</span> number, <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> B_status,
<a name="l03404"></a>03404                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> updateCholesky,
<a name="l03405"></a>03405                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> ensureLI
<a name="l03406"></a>03406                                                                 )
<a name="l03407"></a>03407 {
<a name="l03408"></a>03408         <span class="keywordtype">int</span> i, j, ii;
<a name="l03409"></a>03409 
<a name="l03410"></a>03410         <span class="comment">/* consistency checks */</span>
<a name="l03411"></a>03411         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( number ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> )
<a name="l03412"></a>03412                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea010df9423c62996aead62ece942ab2c6">RET_BOUND_ALREADY_ACTIVE</a> );
<a name="l03413"></a>03413 
<a name="l03414"></a>03414         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( ) == <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#adec338d39cd3a9b6307db86b4db42605">getNUV</a>( ) )
<a name="l03415"></a>03415                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea21e794b0d8f6cc195e16fb95371dfdec">RET_ALL_BOUNDS_ACTIVE</a> );
<a name="l03416"></a>03416 
<a name="l03417"></a>03417         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda5ce84ee8a93fc7e780e2c1e9440c95ed">QPS_NOTINITIALISED</a> )    ||
<a name="l03418"></a>03418                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda1ace398d1f8eddff294c06c72bc58fdb">QPS_AUXILIARYQPSOLVED</a> ) ||
<a name="l03419"></a>03419                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda6f8af598b9b98f5a3582f8063f3b3ecb">QPS_HOMOTOPYQPSOLVED</a> )  ||
<a name="l03420"></a>03420                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdaeaeec92065e112d99b1f82851e069bd3">QPS_SOLVED</a> )            )
<a name="l03421"></a>03421         {
<a name="l03422"></a>03422                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaee57058f3b42d5e58c701115a79c38a0">RET_UNKNOWN_BUG</a> );
<a name="l03423"></a>03423         }
<a name="l03424"></a>03424 
<a name="l03425"></a>03425 
<a name="l03426"></a>03426         <span class="comment">/* I) ENSURE LINEAR INDEPENDENCE OF THE WORKING SET,</span>
<a name="l03427"></a>03427 <span class="comment">         *    i.e. remove a constraint or bound if linear dependence occurs. */</span>
<a name="l03428"></a>03428         <span class="comment">/* check for LI only if Cholesky decomposition shall be updated! */</span>
<a name="l03429"></a>03429         <span class="keywordflow">if</span> ( updateCholesky == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> &amp;&amp; ensureLI == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l03430"></a>03430         {
<a name="l03431"></a>03431                 <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> ensureLIreturnvalue = <a class="code" href="classQProblem.html#a8c7d6a3375c79aab00594f8f88361683">addBound_ensureLI</a>( number,B_status );
<a name="l03432"></a>03432 
<a name="l03433"></a>03433                 <span class="keywordflow">switch</span> ( ensureLIreturnvalue )
<a name="l03434"></a>03434                 {
<a name="l03435"></a>03435                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>:
<a name="l03436"></a>03436                                 <span class="keywordflow">break</span>;
<a name="l03437"></a>03437 
<a name="l03438"></a>03438                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea18e98f249c6e5b6f5345620a7ae041c7">RET_LI_RESOLVED</a>:
<a name="l03439"></a>03439                                 <span class="keywordflow">break</span>;
<a name="l03440"></a>03440 
<a name="l03441"></a>03441                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eafc49ac2285671f1bd6a1962baa9dcbf4">RET_ENSURELI_FAILED_NOINDEX</a>:
<a name="l03442"></a>03442                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaa05e2c81a7cd42017cb24d782c14fcaf">RET_ADDBOUND_FAILED_INFEASIBILITY</a>;
<a name="l03443"></a>03443 
<a name="l03444"></a>03444                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea709d155801b880ababc7f4ea77f5950a">RET_ENSURELI_FAILED_CYCLING</a>:
<a name="l03445"></a>03445                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaa05e2c81a7cd42017cb24d782c14fcaf">RET_ADDBOUND_FAILED_INFEASIBILITY</a>;
<a name="l03446"></a>03446 
<a name="l03447"></a>03447                         <span class="keywordflow">case</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0671c4114677051c98f8b9ac29df192a">RET_ENSURELI_DROPPED</a>:
<a name="l03448"></a>03448                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l03449"></a>03449                                 
<a name="l03450"></a>03450                         <span class="keywordflow">default</span>:
<a name="l03451"></a>03451                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaf56d4e19751ab0b0b237ac494a974eb3">RET_ENSURELI_FAILED</a> );
<a name="l03452"></a>03452                 }
<a name="l03453"></a>03453         }
<a name="l03454"></a>03454 
<a name="l03455"></a>03455 
<a name="l03456"></a>03456         <span class="comment">/* some definitions */</span>
<a name="l03457"></a>03457         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l03458"></a>03458         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l03459"></a>03459         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l03460"></a>03460         <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l03461"></a>03461 
<a name="l03462"></a>03462         <span class="keywordtype">int</span> tcol = <a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a> - nAC;
<a name="l03463"></a>03463 
<a name="l03464"></a>03464 
<a name="l03465"></a>03465         <span class="comment">/* II) SWAP INDEXLIST OF FREE VARIABLES:</span>
<a name="l03466"></a>03466 <span class="comment">         *     move the variable to be fixed to the end of the list of free variables. */</span>
<a name="l03467"></a>03467         <span class="keywordtype">int</span> lastfreenumber = <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#addc4fcc5c2425e5cfd1d28c843540a7f">getLastNumber</a>( );
<a name="l03468"></a>03468         <span class="keywordflow">if</span> ( lastfreenumber != number )
<a name="l03469"></a>03469                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa43c846e6c5a9ee5275f155cf1331d63">swapFree</a>( number,lastfreenumber ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l03470"></a>03470                         <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea74695b25879d843bc327dbc24b6b7894">RET_ADDBOUND_FAILED</a> );
<a name="l03471"></a>03471 
<a name="l03472"></a>03472 
<a name="l03473"></a>03473         <span class="keywordtype">int</span>* FR_idx;
<a name="l03474"></a>03474         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l03475"></a>03475 
<a name="l03476"></a>03476         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* w = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l03477"></a>03477 
<a name="l03478"></a>03478 
<a name="l03479"></a>03479         <span class="comment">/* III) ADD NEW ACTIVE BOUND TO TOP OF MATRIX T: */</span>
<a name="l03480"></a>03480         <span class="comment">/* 1) add row [wZ wY] = [Z Y](number) at the top of T: assign w */</span>
<a name="l03481"></a>03481         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l03482"></a>03482                 w[i] = <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(FR_idx[nFR-1],i);
<a name="l03483"></a>03483 
<a name="l03484"></a>03484 
<a name="l03485"></a>03485         <span class="comment">/* 2) Use column-wise Givens rotations to restore reverse triangular form</span>
<a name="l03486"></a>03486 <span class="comment">         *    of the first row of T, simultanenous change of Q (i.e. Z) and R. */</span>
<a name="l03487"></a>03487         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> c, s, nu;
<a name="l03488"></a>03488 
<a name="l03489"></a>03489         <span class="keywordflow">for</span>( j=0; j&lt;nZ-1; ++j )
<a name="l03490"></a>03490         {
<a name="l03491"></a>03491                 <a class="code" href="classQProblemB.html#a736d704a3575d1a4ec4565ddfdf3e6d8">computeGivens</a>( w[j+1],w[j], w[j+1],w[j],c,s );
<a name="l03492"></a>03492                 nu = s/(1.0+c);
<a name="l03493"></a>03493 
<a name="l03494"></a>03494                 <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l03495"></a>03495                 {
<a name="l03496"></a>03496                         ii = FR_idx[i];
<a name="l03497"></a>03497                         <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j), <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j) );
<a name="l03498"></a>03498                 }
<a name="l03499"></a>03499 
<a name="l03500"></a>03500                 <span class="keywordflow">if</span> ( ( updateCholesky == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp;
<a name="l03501"></a>03501                          ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )   &amp;&amp; ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> ) )
<a name="l03502"></a>03502                 {
<a name="l03503"></a>03503                         <span class="keywordflow">for</span>( i=0; i&lt;=j+1; ++i )
<a name="l03504"></a>03504                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,1+j),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,j), <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,1+j),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,j) );
<a name="l03505"></a>03505                 }
<a name="l03506"></a>03506         }
<a name="l03507"></a>03507 
<a name="l03508"></a>03508 
<a name="l03509"></a>03509         <span class="keywordflow">if</span> ( nAC &gt; 0 )    <span class="comment">/* ( nAC == 0 ) &lt;=&gt; ( nZ == nFR ) &lt;=&gt; Y and T are empty =&gt; nothing to do */</span>
<a name="l03510"></a>03510         {
<a name="l03511"></a>03511                 <span class="comment">/* store new column a in a temporary vector instead of shifting T one column to the left */</span>
<a name="l03512"></a>03512                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* tmp = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l03513"></a>03513                 <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l03514"></a>03514                         tmp[i] = 0.0;
<a name="l03515"></a>03515 
<a name="l03516"></a>03516                 {
<a name="l03517"></a>03517                         j = nZ-1;
<a name="l03518"></a>03518 
<a name="l03519"></a>03519                         <a class="code" href="classQProblemB.html#a736d704a3575d1a4ec4565ddfdf3e6d8">computeGivens</a>( w[j+1],w[j], w[j+1],w[j],c,s );
<a name="l03520"></a>03520                         nu = s/(1.0+c);
<a name="l03521"></a>03521 
<a name="l03522"></a>03522                         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l03523"></a>03523                         {
<a name="l03524"></a>03524                                 ii = FR_idx[i];
<a name="l03525"></a>03525                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j), <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j) );
<a name="l03526"></a>03526                         }
<a name="l03527"></a>03527 
<a name="l03528"></a>03528                         <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-1,tcol),tmp[nAC-1], tmp[nAC-1],<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-1,tcol) );
<a name="l03529"></a>03529                 }
<a name="l03530"></a>03530 
<a name="l03531"></a>03531                 <span class="keywordflow">for</span>( j=nZ; j&lt;nFR-1; ++j )
<a name="l03532"></a>03532                 {
<a name="l03533"></a>03533                         <a class="code" href="classQProblemB.html#a736d704a3575d1a4ec4565ddfdf3e6d8">computeGivens</a>( w[j+1],w[j], w[j+1],w[j],c,s );
<a name="l03534"></a>03534                         nu = s/(1.0+c);
<a name="l03535"></a>03535 
<a name="l03536"></a>03536                         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l03537"></a>03537                         {
<a name="l03538"></a>03538                                 ii = FR_idx[i];
<a name="l03539"></a>03539                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j), <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j) );
<a name="l03540"></a>03540                         }
<a name="l03541"></a>03541 
<a name="l03542"></a>03542                         <span class="keywordflow">for</span>( i=(nFR-2-j); i&lt;nAC; ++i )
<a name="l03543"></a>03543                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,1+tcol-nZ+j),tmp[i], tmp[i],<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,1+tcol-nZ+j) );
<a name="l03544"></a>03544                 }
<a name="l03545"></a>03545 
<a name="l03546"></a>03546                 <span class="keyword">delete</span>[] tmp;
<a name="l03547"></a>03547         }
<a name="l03548"></a>03548 
<a name="l03549"></a>03549         <span class="keyword">delete</span>[] w;
<a name="l03550"></a>03550 
<a name="l03551"></a>03551 
<a name="l03552"></a>03552         <span class="keywordflow">if</span> ( ( updateCholesky == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp;
<a name="l03553"></a>03553                  ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )   &amp;&amp; ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> ) )
<a name="l03554"></a>03554         {
<a name="l03555"></a>03555                 <span class="comment">/* IV) RESTORE TRIANGULAR FORM OF R:</span>
<a name="l03556"></a>03556 <span class="comment">                 *     use row-wise Givens rotations to restore upper triangular form of R */</span>
<a name="l03557"></a>03557                 <span class="keywordflow">for</span>( i=0; i&lt;nZ-1; ++i )
<a name="l03558"></a>03558                 {
<a name="l03559"></a>03559                         <a class="code" href="classQProblemB.html#a736d704a3575d1a4ec4565ddfdf3e6d8">computeGivens</a>( <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,i),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(1+i,i), <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,i),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(1+i,i),c,s );
<a name="l03560"></a>03560                         nu = s/(1.0+c);
<a name="l03561"></a>03561 
<a name="l03562"></a>03562                         <span class="keywordflow">for</span>( j=(1+i); j&lt;nZ-1; ++j ) <span class="comment">/* last column of R is thrown away */</span>
<a name="l03563"></a>03563                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,j),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(1+i,j), <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,j),<a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(1+i,j) );
<a name="l03564"></a>03564                 }
<a name="l03565"></a>03565                 <span class="comment">/* last column of R is thrown away */</span>
<a name="l03566"></a>03566                 <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l03567"></a>03567                         <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,nZ-1) = 0.0;
<a name="l03568"></a>03568         }
<a name="l03569"></a>03569 
<a name="l03570"></a>03570 
<a name="l03571"></a>03571         <span class="comment">/* V) UPDATE INDICES */</span>
<a name="l03572"></a>03572         <a class="code" href="classQProblem.html#aee232819e1d7bd8720872a886aa63f1d">idxAddB</a> = number;
<a name="l03573"></a>03573         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a6d6f6a6405fb0b7ff607e5a587eedafb">moveFreeToFixed</a>( number,B_status ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l03574"></a>03574                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea74695b25879d843bc327dbc24b6b7894">RET_ADDBOUND_FAILED</a> );
<a name="l03575"></a>03575 
<a name="l03576"></a>03576         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l03577"></a>03577 }
<a name="l03578"></a>03578 
<a name="l03579"></a>03579 
<a name="l03580"></a>03580 <span class="comment">/*</span>
<a name="l03581"></a>03581 <span class="comment"> *      a d d B o u n d _ c h e c k L I</span>
<a name="l03582"></a>03582 <span class="comment"> */</span>
<a name="l03583"></a><a class="code" href="classQProblem.html#a946fbc2babac30ff666501f9e0397196">03583</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a946fbc2babac30ff666501f9e0397196">QProblem::addBound_checkLI</a>( <span class="keywordtype">int</span> number )
<a name="l03584"></a>03584 {
<a name="l03585"></a>03585         <span class="keywordtype">int</span> i, ii;
<a name="l03586"></a>03586         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );  <span class="comment">/* for QQ() macro */</span>
<a name="l03587"></a>03587         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l03588"></a>03588         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>();
<a name="l03589"></a>03589         <span class="keywordtype">int</span> nFX = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>();
<a name="l03590"></a>03590         <span class="keywordtype">int</span> nC  = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l03591"></a>03591         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea50bd78d9856144c5df0c5e2b5615e92d">RET_LINEARLY_DEPENDENT</a>;
<a name="l03592"></a>03592 
<a name="l03593"></a>03593         <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a043d6f962a785e05d304950d01461432">enableFullLITests</a>)
<a name="l03594"></a>03594         {
<a name="l03595"></a>03595                 <span class="comment">/*</span>
<a name="l03596"></a>03596 <span class="comment">                 * expensive LI test. Backsolve with refinement using special right</span>
<a name="l03597"></a>03597 <span class="comment">                 * hand side. This gives an estimate for what should be considered</span>
<a name="l03598"></a>03598 <span class="comment">                 * &quot;zero&quot;. We then check linear independence relative to this estimate.</span>
<a name="l03599"></a>03599 <span class="comment">                 */</span>
<a name="l03600"></a>03600 
<a name="l03601"></a>03601                 <span class="comment">/*</span>
<a name="l03602"></a>03602 <span class="comment">                 * expensive LI test. Backsolve with refinement using special right</span>
<a name="l03603"></a>03603 <span class="comment">                 * hand side. This gives an estimate for what should be considered</span>
<a name="l03604"></a>03604 <span class="comment">                 * &quot;zero&quot;. We then check linear independence relative to this estimate.</span>
<a name="l03605"></a>03605 <span class="comment">                 */</span>
<a name="l03606"></a>03606 
<a name="l03607"></a>03607                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_g   = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l03608"></a>03608                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_xFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l03609"></a>03609                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_xFR = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l03610"></a>03610                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_yAC = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l03611"></a>03611                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_yFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l03612"></a>03612 
<a name="l03613"></a>03613                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nV; ++ii)
<a name="l03614"></a>03614                         delta_g[ii] = 0.0;
<a name="l03615"></a>03615                 delta_g[number] = 1.0;  <span class="comment">/* sign doesn&#39;t matter here */</span>
<a name="l03616"></a>03616 
<a name="l03617"></a>03617                 <span class="keywordtype">int</span> dim = (nC&gt;nV)?nC:nV;
<a name="l03618"></a>03618                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *nul = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[dim];
<a name="l03619"></a>03619                 <span class="keywordflow">for</span> (ii = 0; ii &lt; dim; ++ii)
<a name="l03620"></a>03620                         nul[ii]=0.0;
<a name="l03621"></a>03621 
<a name="l03622"></a>03622                 <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> dsdReturnValue = <a class="code" href="classQProblem.html#a1b2636572bd7eeed4f23222a6a1653e1">determineStepDirection</a> (
<a name="l03623"></a>03623                                 delta_g, nul, nul, nul, nul, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,
<a name="l03624"></a>03624                                 delta_xFX, delta_xFR, delta_yAC, delta_yFX);
<a name="l03625"></a>03625                 <span class="keywordflow">if</span> (dsdReturnValue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>) 
<a name="l03626"></a>03626                         returnvalue = dsdReturnValue;
<a name="l03627"></a>03627 
<a name="l03628"></a>03628                 <span class="comment">/* compute the weight in inf-norm */</span>
<a name="l03629"></a>03629                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> weight = 0.0;
<a name="l03630"></a>03630                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nAC; ++ii)
<a name="l03631"></a>03631                 {
<a name="l03632"></a>03632                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_yAC[ii]);
<a name="l03633"></a>03633                         <span class="keywordflow">if</span> (weight &lt; a) weight = a;
<a name="l03634"></a>03634                 }
<a name="l03635"></a>03635                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nFX; ++ii)
<a name="l03636"></a>03636                 {
<a name="l03637"></a>03637                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_yFX[ii]);
<a name="l03638"></a>03638                         <span class="keywordflow">if</span> (weight &lt; a) weight = a;
<a name="l03639"></a>03639                 }
<a name="l03640"></a>03640 
<a name="l03641"></a>03641                 <span class="comment">/* look at the &quot;zero&quot; in a relative inf-norm */</span>
<a name="l03642"></a>03642                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> zero = 0.0;
<a name="l03643"></a>03643                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nFX; ++ii)
<a name="l03644"></a>03644                 {
<a name="l03645"></a>03645                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_xFX[ii]);
<a name="l03646"></a>03646                         <span class="keywordflow">if</span> (zero &lt; a) zero = a;
<a name="l03647"></a>03647                 }
<a name="l03648"></a>03648                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nFR; ++ii)
<a name="l03649"></a>03649                 {
<a name="l03650"></a>03650                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_xFR[ii]);
<a name="l03651"></a>03651                         <span class="keywordflow">if</span> (zero &lt; a) zero = a;
<a name="l03652"></a>03652                 }
<a name="l03653"></a>03653 
<a name="l03654"></a>03654                 <span class="comment">/* relative test against zero in inf-norm */</span>
<a name="l03655"></a>03655                 <span class="keywordflow">if</span> (zero &gt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af972adad4f56f124531725e1248a51e3">epsLITests</a> * weight)
<a name="l03656"></a>03656                         returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea2b543ec23d472ec6632a4b70281bf616">RET_LINEARLY_INDEPENDENT</a>;
<a name="l03657"></a>03657 
<a name="l03658"></a>03658                 <span class="keyword">delete</span>[] nul;
<a name="l03659"></a>03659                 <span class="keyword">delete</span>[] delta_yFX;
<a name="l03660"></a>03660                 <span class="keyword">delete</span>[] delta_yAC;
<a name="l03661"></a>03661                 <span class="keyword">delete</span>[] delta_xFR;
<a name="l03662"></a>03662                 <span class="keyword">delete</span>[] delta_xFX;
<a name="l03663"></a>03663                 <span class="keyword">delete</span>[] delta_g;
<a name="l03664"></a>03664 
<a name="l03665"></a>03665         }
<a name="l03666"></a>03666         <span class="keywordflow">else</span>
<a name="l03667"></a>03667         {
<a name="l03668"></a>03668                 <span class="comment">/*</span>
<a name="l03669"></a>03669 <span class="comment">                 * cheap LI test for simple bound. Check if constraint &lt;number&gt; is</span>
<a name="l03670"></a>03670 <span class="comment">                 * linearly independent from the the active ones (&lt;=&gt; is element of null</span>
<a name="l03671"></a>03671 <span class="comment">                 * space of Afr).</span>
<a name="l03672"></a>03672 <span class="comment">                 */</span>
<a name="l03673"></a>03673 
<a name="l03674"></a>03674                 <span class="comment">/* some definitions */</span>
<a name="l03675"></a>03675                 <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l03676"></a>03676 
<a name="l03677"></a>03677                 <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l03678"></a>03678                         <span class="keywordflow">if</span> ( fabs( <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(number,i) ) &gt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af972adad4f56f124531725e1248a51e3">epsLITests</a> )
<a name="l03679"></a>03679                         {
<a name="l03680"></a>03680                                 returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea2b543ec23d472ec6632a4b70281bf616">RET_LINEARLY_INDEPENDENT</a>;
<a name="l03681"></a>03681                                 <span class="keywordflow">break</span>;
<a name="l03682"></a>03682                         }
<a name="l03683"></a>03683         }
<a name="l03684"></a>03684 
<a name="l03685"></a>03685         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a0ef7741d67176593da953e5baa206ce9">THROWINFO</a>( returnvalue );
<a name="l03686"></a>03686 }
<a name="l03687"></a>03687 
<a name="l03688"></a>03688 
<a name="l03689"></a>03689 <span class="comment">/*</span>
<a name="l03690"></a>03690 <span class="comment"> *      a d d B o u n d _ e n s u r e L I</span>
<a name="l03691"></a>03691 <span class="comment"> */</span>
<a name="l03692"></a><a class="code" href="classQProblem.html#a8c7d6a3375c79aab00594f8f88361683">03692</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a8c7d6a3375c79aab00594f8f88361683">QProblem::addBound_ensureLI</a>( <span class="keywordtype">int</span> number, <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> B_status )
<a name="l03693"></a>03693 {
<a name="l03694"></a>03694         <span class="keywordtype">int</span> i, ii;
<a name="l03695"></a>03695         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l03696"></a>03696         <span class="keywordtype">int</span> nFX = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>( );
<a name="l03697"></a>03697         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l03698"></a>03698         <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l03699"></a>03699 
<a name="l03700"></a>03700 
<a name="l03701"></a>03701         <span class="comment">/* I) Check if new constraint is linearly independent from the active ones. */</span>
<a name="l03702"></a>03702         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalueCheckLI = <a class="code" href="classQProblem.html#a946fbc2babac30ff666501f9e0397196">addBound_checkLI</a>( number );
<a name="l03703"></a>03703 
<a name="l03704"></a>03704         <span class="keywordflow">if</span> ( returnvalueCheckLI == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea02a025b066cd6f22ff6751c167749a88">RET_INDEXLIST_CORRUPTED</a> )
<a name="l03705"></a>03705                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaf56d4e19751ab0b0b237ac494a974eb3">RET_ENSURELI_FAILED</a> );
<a name="l03706"></a>03706 
<a name="l03707"></a>03707         <span class="keywordflow">if</span> ( returnvalueCheckLI == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea2b543ec23d472ec6632a4b70281bf616">RET_LINEARLY_INDEPENDENT</a> )
<a name="l03708"></a>03708                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l03709"></a>03709 
<a name="l03710"></a>03710 
<a name="l03711"></a>03711         <span class="comment">/* II) NEW BOUND IS LINEARLY DEPENDENT: */</span>
<a name="l03712"></a>03712         <span class="comment">/* 1) Determine coefficients of linear combination,</span>
<a name="l03713"></a>03713 <span class="comment">         *    cf. M.J. Best. Applied Mathematics and Parallel Computing, chapter:</span>
<a name="l03714"></a>03714 <span class="comment">         *    An Algorithm for the Solution of the Parametric Quadratic Programming</span>
<a name="l03715"></a>03715 <span class="comment">         *    Problem, pages 57-76. Physica-Verlag, Heidelberg, 1996. */</span>
<a name="l03716"></a>03716         <span class="keywordtype">int</span>* FR_idx;
<a name="l03717"></a>03717         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l03718"></a>03718 
<a name="l03719"></a>03719         <span class="keywordtype">int</span>* FX_idx;
<a name="l03720"></a>03720         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FX_idx );
<a name="l03721"></a>03721 
<a name="l03722"></a>03722         <span class="keywordtype">int</span>* AC_idx;
<a name="l03723"></a>03723         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l03724"></a>03724 
<a name="l03725"></a>03725         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* xiC = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l03726"></a>03726         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* xiC_TMP = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l03727"></a>03727         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* xiB = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l03728"></a>03728         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* num = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l03729"></a>03729 
<a name="l03730"></a>03730         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> y_min = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a0b8e5478791cd5c003882b72a706014f">maxDualJump</a>;
<a name="l03731"></a>03731         <span class="keywordtype">int</span> y_min_number = -1;
<a name="l03732"></a>03732         <span class="keywordtype">int</span> y_min_number_bound = -1;
<a name="l03733"></a>03733         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> y_min_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l03734"></a>03734         
<a name="l03735"></a>03735         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l03736"></a>03736 
<a name="l03737"></a>03737 
<a name="l03738"></a>03738         <span class="comment">/* 2) Calculate xiC. */</span>
<a name="l03739"></a>03739         <span class="keywordflow">if</span> ( nAC &gt; 0 )
<a name="l03740"></a>03740         {
<a name="l03741"></a>03741                 <span class="keywordflow">if</span> ( B_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l03742"></a>03742                 {
<a name="l03743"></a>03743                         <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l03744"></a>03744                                 xiC_TMP[i] = <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(number,nZ+i);
<a name="l03745"></a>03745                 }
<a name="l03746"></a>03746                 <span class="keywordflow">else</span>
<a name="l03747"></a>03747                 {
<a name="l03748"></a>03748                         <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l03749"></a>03749                                 xiC_TMP[i] = -<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(number,nZ+i);
<a name="l03750"></a>03750                 }
<a name="l03751"></a>03751 
<a name="l03752"></a>03752                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0563822d48c2b9316ceb1a3abd8ac536">backsolveT</a>( xiC_TMP, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, xiC ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l03753"></a>03753                 {
<a name="l03754"></a>03754                         returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea25f01dc1c5b356ea0b163826d763211e">RET_ENSURELI_FAILED_TQ</a>;
<a name="l03755"></a>03755                         <span class="keywordflow">goto</span> farewell;
<a name="l03756"></a>03756                 }
<a name="l03757"></a>03757         }
<a name="l03758"></a>03758 
<a name="l03759"></a>03759         <span class="comment">/* 3) Calculate xiB. */</span>
<a name="l03760"></a>03760         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aae760f106376a34dfaf0c168fa836d84">transTimes</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), 1, -1.0, xiC, nAC, 0.0, xiB, nFX);
<a name="l03761"></a>03761 
<a name="l03762"></a>03762 
<a name="l03763"></a>03763         <span class="comment">/* III) DETERMINE CONSTRAINT/BOUND TO BE REMOVED. */</span>
<a name="l03764"></a>03764 
<a name="l03765"></a>03765         <span class="comment">/* 1) Constraints. */</span>
<a name="l03766"></a>03766         <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l03767"></a>03767         {
<a name="l03768"></a>03768                 ii = AC_idx[i];
<a name="l03769"></a>03769                 num[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+ii];
<a name="l03770"></a>03770         }
<a name="l03771"></a>03771         
<a name="l03772"></a>03772         <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a>( nAC,AC_idx,&amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>, num,xiC, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, y_min,y_min_number );       
<a name="l03773"></a>03773 
<a name="l03774"></a>03774         <span class="comment">/* 2) Bounds. */</span>
<a name="l03775"></a>03775         <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l03776"></a>03776         {
<a name="l03777"></a>03777                 ii = FX_idx[i];
<a name="l03778"></a>03778                 num[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[ii];
<a name="l03779"></a>03779         }
<a name="l03780"></a>03780 
<a name="l03781"></a>03781         <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a>( nFX,FX_idx,&amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>, num,xiB, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, y_min,y_min_number_bound );
<a name="l03782"></a>03782 
<a name="l03783"></a>03783         <span class="keywordflow">if</span> ( y_min_number_bound &gt;= 0 )
<a name="l03784"></a>03784         {
<a name="l03785"></a>03785                 y_min_number = y_min_number_bound;
<a name="l03786"></a>03786                 y_min_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l03787"></a>03787         }
<a name="l03788"></a>03788 
<a name="l03789"></a>03789         <span class="comment">/* IV) REMOVE CONSTRAINT/BOUND FOR RESOLVING LINEAR DEPENDENCE: */</span>
<a name="l03790"></a>03790         <span class="keywordtype">char</span> messageString[80];
<a name="l03791"></a>03791 
<a name="l03792"></a>03792         <span class="keywordflow">if</span> ( y_min_number &gt;= 0 )
<a name="l03793"></a>03793         {
<a name="l03794"></a>03794                 <span class="comment">/* Update Lagrange multiplier... */</span>
<a name="l03795"></a>03795                 <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l03796"></a>03796                 {
<a name="l03797"></a>03797                         ii = AC_idx[i];
<a name="l03798"></a>03798                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+ii] -= y_min * xiC[i];
<a name="l03799"></a>03799                 }
<a name="l03800"></a>03800                 <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l03801"></a>03801                 {
<a name="l03802"></a>03802                         ii = FX_idx[i];
<a name="l03803"></a>03803                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[ii] -= y_min * xiB[i];
<a name="l03804"></a>03804                 }
<a name="l03805"></a>03805 
<a name="l03806"></a>03806                 <span class="comment">/* ... also for newly active bound ... */</span>
<a name="l03807"></a>03807                 <span class="keywordflow">if</span> ( B_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l03808"></a>03808                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[number] = y_min;
<a name="l03809"></a>03809                 <span class="keywordflow">else</span>
<a name="l03810"></a>03810                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[number] = -y_min;
<a name="l03811"></a>03811 
<a name="l03812"></a>03812                 <span class="comment">/* ... and for bound to be removed. */</span>
<a name="l03813"></a>03813                 <span class="keywordflow">if</span> ( y_min_isBound == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l03814"></a>03814                 {
<a name="l03815"></a>03815 <span class="preprocessor">                        #ifndef __XPCTARGET__</span>
<a name="l03816"></a>03816 <span class="preprocessor"></span>                        snprintf( messageString,80,<span class="stringliteral">&quot;bound no. %d.&quot;</span>,y_min_number );
<a name="l03817"></a>03817                         <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0f461fcae9d87e4b1334401a3be6eb46">RET_REMOVE_FROM_ACTIVESET</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l03818"></a>03818 <span class="preprocessor">                        #endif</span>
<a name="l03819"></a>03819 <span class="preprocessor"></span>
<a name="l03820"></a>03820                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a12931eb86b975a1e3b0537c94c30a290">removeBound</a>( y_min_number,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l03821"></a>03821                         {
<a name="l03822"></a>03822                                 returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaddb537678cb9d40290ba4e0ef5514a37">RET_REMOVE_FROM_ACTIVESET_FAILED</a>;
<a name="l03823"></a>03823                                 <span class="keywordflow">goto</span> farewell;
<a name="l03824"></a>03824                         }
<a name="l03825"></a>03825                         <a class="code" href="classQProblem.html#a5d808162c2545f4bb054fe7276f2e65b">excRemB</a> = 1;
<a name="l03826"></a>03826 
<a name="l03827"></a>03827                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[y_min_number] = 0.0;
<a name="l03828"></a>03828                 }
<a name="l03829"></a>03829                 <span class="keywordflow">else</span>
<a name="l03830"></a>03830                 {
<a name="l03831"></a>03831 <span class="preprocessor">                        #ifndef __XPCTARGET__</span>
<a name="l03832"></a>03832 <span class="preprocessor"></span>                        snprintf( messageString,80,<span class="stringliteral">&quot;constraint no. %d.&quot;</span>,y_min_number );
<a name="l03833"></a>03833                         <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0f461fcae9d87e4b1334401a3be6eb46">RET_REMOVE_FROM_ACTIVESET</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l03834"></a>03834 <span class="preprocessor">                        #endif</span>
<a name="l03835"></a>03835 <span class="preprocessor"></span>
<a name="l03836"></a>03836                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a140f91786436fd1069e932733eba5abd">removeConstraint</a>( y_min_number,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l03837"></a>03837                         {
<a name="l03838"></a>03838                                 returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaddb537678cb9d40290ba4e0ef5514a37">RET_REMOVE_FROM_ACTIVESET_FAILED</a>;
<a name="l03839"></a>03839                                 <span class="keywordflow">goto</span> farewell;
<a name="l03840"></a>03840                         }
<a name="l03841"></a>03841                         <a class="code" href="classQProblem.html#a23864f19ab428e3397b1b42f589751f9">excRemC</a> = 1;
<a name="l03842"></a>03842 
<a name="l03843"></a>03843                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+y_min_number] = 0.0;
<a name="l03844"></a>03844                 }
<a name="l03845"></a>03845         }
<a name="l03846"></a>03846         <span class="keywordflow">else</span>
<a name="l03847"></a>03847         {
<a name="l03848"></a>03848                 <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a471b77ce66c8b16a06e61d94af785f91">enableDropInfeasibles</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>) {
<a name="l03849"></a>03849                         <span class="comment">/* dropping of infeasible constraints according to drop priorities */</span>
<a name="l03850"></a>03850                         returnvalue = <a class="code" href="classQProblem.html#adbc81cf7d22c43f5e8459129443abc5a">dropInfeasibles</a> (number, B_status, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, xiB, xiC);
<a name="l03851"></a>03851                 }
<a name="l03852"></a>03852                 <span class="keywordflow">else</span>
<a name="l03853"></a>03853                 {
<a name="l03854"></a>03854                         <span class="comment">/* no constraint/bound can be removed =&gt; QP is infeasible! */</span>
<a name="l03855"></a>03855                         returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eafc49ac2285671f1bd6a1962baa9dcbf4">RET_ENSURELI_FAILED_NOINDEX</a>;
<a name="l03856"></a>03856                         <a class="code" href="classQProblemB.html#a0ee80a22826580862cc33ca63fe35d23">setInfeasibilityFlag</a>( returnvalue );
<a name="l03857"></a>03857                 }
<a name="l03858"></a>03858         }
<a name="l03859"></a>03859 
<a name="l03860"></a>03860 farewell:
<a name="l03861"></a>03861         <span class="keyword">delete</span>[] num;
<a name="l03862"></a>03862         <span class="keyword">delete</span>[] xiB; 
<a name="l03863"></a>03863         <span class="keyword">delete</span>[] xiC_TMP; 
<a name="l03864"></a>03864         <span class="keyword">delete</span>[] xiC;
<a name="l03865"></a>03865 
<a name="l03866"></a>03866         <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea18e98f249c6e5b6f5345620a7ae041c7">RET_LI_RESOLVED</a>,0,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l03867"></a>03867         
<a name="l03868"></a>03868         <span class="keywordflow">return</span> (returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>) ? <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a> (returnvalue) : returnvalue;
<a name="l03869"></a>03869 }
<a name="l03870"></a>03870 
<a name="l03871"></a>03871 
<a name="l03872"></a>03872 
<a name="l03873"></a>03873 <span class="comment">/*</span>
<a name="l03874"></a>03874 <span class="comment"> *      r e m o v e C o n s t r a i n t</span>
<a name="l03875"></a>03875 <span class="comment"> */</span>
<a name="l03876"></a><a class="code" href="classQProblem.html#a140f91786436fd1069e932733eba5abd">03876</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a140f91786436fd1069e932733eba5abd">QProblem::removeConstraint</a>( <span class="keywordtype">int</span> number,
<a name="l03877"></a>03877                                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> updateCholesky,
<a name="l03878"></a>03878                                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> allowFlipping,
<a name="l03879"></a>03879                                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> ensureNZC
<a name="l03880"></a>03880                                                                                 )
<a name="l03881"></a>03881 {
<a name="l03882"></a>03882         <span class="keywordtype">int</span> i, j, ii, jj;
<a name="l03883"></a>03883         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l03884"></a>03884         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> hasFlipped = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l03885"></a>03885 
<a name="l03886"></a>03886         <span class="comment">/* consistency check */</span>
<a name="l03887"></a>03887         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda5ce84ee8a93fc7e780e2c1e9440c95ed">QPS_NOTINITIALISED</a> )    ||
<a name="l03888"></a>03888                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda1ace398d1f8eddff294c06c72bc58fdb">QPS_AUXILIARYQPSOLVED</a> ) ||
<a name="l03889"></a>03889                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda6f8af598b9b98f5a3582f8063f3b3ecb">QPS_HOMOTOPYQPSOLVED</a> )  ||
<a name="l03890"></a>03890                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdaeaeec92065e112d99b1f82851e069bd3">QPS_SOLVED</a> )            )
<a name="l03891"></a>03891         {
<a name="l03892"></a>03892                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaee57058f3b42d5e58c701115a79c38a0">RET_UNKNOWN_BUG</a> );
<a name="l03893"></a>03893         }
<a name="l03894"></a>03894 
<a name="l03895"></a>03895         <span class="comment">/* some definitions */</span>
<a name="l03896"></a>03896         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l03897"></a>03897         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l03898"></a>03898         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l03899"></a>03899         <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l03900"></a>03900 
<a name="l03901"></a>03901         <span class="keywordtype">int</span> tcol = <a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a> - nAC;
<a name="l03902"></a>03902         <span class="keywordtype">int</span> number_idx = <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#ad6531121bb05cfc3ab38d05973b462d9">getIndex</a>( number );
<a name="l03903"></a>03903 
<a name="l03904"></a>03904         <span class="keywordtype">int</span> addIdx;
<a name="l03905"></a>03905         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> addBoundNotConstraint;
<a name="l03906"></a>03906         <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> addStatus;
<a name="l03907"></a>03907         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> exchangeHappened = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l03908"></a>03908 
<a name="l03909"></a>03909 
<a name="l03910"></a>03910         <span class="comment">/* consistency checks */</span>
<a name="l03911"></a>03911         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( number ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> )
<a name="l03912"></a>03912                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eab5e9882293ca4d4cea8d8b2473c2a8e1">RET_CONSTRAINT_NOT_ACTIVE</a> );
<a name="l03913"></a>03913 
<a name="l03914"></a>03914         <span class="keywordflow">if</span> ( ( number_idx &lt; 0 ) || ( number_idx &gt;= nAC ) )
<a name="l03915"></a>03915                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eab5e9882293ca4d4cea8d8b2473c2a8e1">RET_CONSTRAINT_NOT_ACTIVE</a> );
<a name="l03916"></a>03916 
<a name="l03917"></a>03917 
<a name="l03918"></a>03918         <span class="keywordtype">int</span>* FR_idx;
<a name="l03919"></a>03919         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l03920"></a>03920 
<a name="l03921"></a>03921         <span class="comment">/* N) PERFORM ZERO CURVATURE TEST. */</span>
<a name="l03922"></a>03922         <span class="keywordflow">if</span> (ensureNZC == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>)
<a name="l03923"></a>03923         {
<a name="l03924"></a>03924                 returnvalue = <a class="code" href="classQProblem.html#af31805351afbf485558eaf51e0bab3fd">ensureNonzeroCurvature</a>(<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, number, exchangeHappened, addBoundNotConstraint, addIdx, addStatus);
<a name="l03925"></a>03925 
<a name="l03926"></a>03926                 <span class="keywordflow">if</span> (returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>)
<a name="l03927"></a>03927                         <span class="keywordflow">return</span> returnvalue;
<a name="l03928"></a>03928         }
<a name="l03929"></a>03929 
<a name="l03930"></a>03930         <span class="comment">/* save index sets and decompositions for flipping bounds strategy */</span>
<a name="l03931"></a>03931         <span class="keywordflow">if</span> ( ( exchangeHappened == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) &amp;&amp; ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#abba3f3ece76237c647b5719eae9c26f2">enableFlippingBounds</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( allowFlipping == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) )
<a name="l03932"></a>03932                 <a class="code" href="classQProblemB.html#afc23c08b6cdc0ca93f9c049e9a318744">flipper</a>.<a class="code" href="classFlipper.html#a918b42bfc9a7caa375170ffb50ff5708">set</a>( &amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>,<a class="code" href="classQProblemB.html#a8402fb9f4dbfaa9ad433457ba03751f0">R</a>,&amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>,<a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>,<a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> );
<a name="l03933"></a>03933 
<a name="l03934"></a>03934         <span class="comment">/* I) REMOVE &lt;number&gt;th ROW FROM T,</span>
<a name="l03935"></a>03935 <span class="comment">         *    i.e. shift rows number+1 through nAC  upwards (instead of the actual</span>
<a name="l03936"></a>03936 <span class="comment">         *    constraint number its corresponding index within matrix A is used). */</span>
<a name="l03937"></a>03937         <span class="keywordflow">if</span> ( number_idx &lt; nAC-1 )
<a name="l03938"></a>03938         {
<a name="l03939"></a>03939                 <span class="keywordflow">for</span>( i=(number_idx+1); i&lt;nAC; ++i )
<a name="l03940"></a>03940                         <span class="keywordflow">for</span>( j=(nAC-i-1); j&lt;nAC; ++j )
<a name="l03941"></a>03941                                 <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i-1,tcol+j) = <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,tcol+j);
<a name="l03942"></a>03942                 <span class="comment">/* gimmick: write zeros into the last row of T */</span>
<a name="l03943"></a>03943                 <span class="keywordflow">for</span>( j=0; j&lt;nAC; ++j )
<a name="l03944"></a>03944                         <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-1,tcol+j) = 0.0;
<a name="l03945"></a>03945 
<a name="l03946"></a>03946 
<a name="l03947"></a>03947                 <span class="comment">/* II) RESTORE TRIANGULAR FORM OF T,</span>
<a name="l03948"></a>03948 <span class="comment">                 *     use column-wise Givens rotations to restore reverse triangular form</span>
<a name="l03949"></a>03949 <span class="comment">                 *     of T simultanenous change of Q (i.e. Y). */</span>
<a name="l03950"></a>03950                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> c, s, nu;
<a name="l03951"></a>03951 
<a name="l03952"></a>03952                 <span class="keywordflow">for</span>( j=(nAC-2-number_idx); j&gt;=0; --j )
<a name="l03953"></a>03953                 {
<a name="l03954"></a>03954                         <a class="code" href="classQProblemB.html#a736d704a3575d1a4ec4565ddfdf3e6d8">computeGivens</a>( <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-2-j,tcol+1+j),<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-2-j,tcol+j), <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-2-j,tcol+1+j),<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-2-j,tcol+j),c,s );
<a name="l03955"></a>03955                         nu = s/(1.0+c);
<a name="l03956"></a>03956 
<a name="l03957"></a>03957                         <span class="keywordflow">for</span>( i=(nAC-j-1); i&lt;(nAC-1); ++i )
<a name="l03958"></a>03958                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,tcol+1+j),<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,tcol+j), <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,tcol+1+j),<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,tcol+j) );
<a name="l03959"></a>03959 
<a name="l03960"></a>03960                         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l03961"></a>03961                         {
<a name="l03962"></a>03962                                 ii = FR_idx[i];
<a name="l03963"></a>03963                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+j), <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+j) );
<a name="l03964"></a>03964                         }
<a name="l03965"></a>03965                 }
<a name="l03966"></a>03966         }
<a name="l03967"></a>03967         <span class="keywordflow">else</span>
<a name="l03968"></a>03968         {
<a name="l03969"></a>03969                 <span class="comment">/* gimmick: write zeros into the last row of T */</span>
<a name="l03970"></a>03970                 <span class="keywordflow">for</span>( j=0; j&lt;nAC; ++j )
<a name="l03971"></a>03971                         <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-1,tcol+j) = 0.0;
<a name="l03972"></a>03972         }
<a name="l03973"></a>03973 
<a name="l03974"></a>03974 
<a name="l03975"></a>03975         <span class="keywordflow">if</span> ( ( updateCholesky == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp;
<a name="l03976"></a>03976                  ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )   &amp;&amp; ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> ) )
<a name="l03977"></a>03977         {
<a name="l03978"></a>03978                 <span class="comment">/* III) UPDATE CHOLESKY DECOMPOSITION,</span>
<a name="l03979"></a>03979 <span class="comment">                 *      calculate new additional column (i.e. [r sqrt(rho2)]&#39;)</span>
<a name="l03980"></a>03980 <span class="comment">                 *      of the Cholesky factor R. */</span>
<a name="l03981"></a>03981                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* Hz = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l03982"></a>03982                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* z = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l03983"></a>03983                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> rho2 = 0.0;
<a name="l03984"></a>03984 
<a name="l03985"></a>03985                 <span class="comment">/* 1) Calculate Hz = H*z, where z is the new rightmost column of Z</span>
<a name="l03986"></a>03986 <span class="comment">                 *    (i.e. the old leftmost column of Y).  */</span>
<a name="l03987"></a>03987                 <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l03988"></a>03988                         z[j] = <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(FR_idx[j],nZ);
<a name="l03989"></a>03989                 <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1, 1.0, z, nFR, 0.0, Hz, nFR);
<a name="l03990"></a>03990                 <span class="keyword">delete</span>[] z;
<a name="l03991"></a>03991 
<a name="l03992"></a>03992                 <span class="keywordflow">if</span> ( nZ &gt; 0 )
<a name="l03993"></a>03993                 {
<a name="l03994"></a>03994                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* ZHz = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nZ];
<a name="l03995"></a>03995                         <span class="keywordflow">for</span> ( i=0; i&lt;nZ; ++i )
<a name="l03996"></a>03996                                 ZHz[i] = 0.0;
<a name="l03997"></a>03997                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* r = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nZ];
<a name="l03998"></a>03998 
<a name="l03999"></a>03999                         <span class="comment">/* 2) Calculate ZHz = Z&#39;*Hz (old Z). */</span>
<a name="l04000"></a>04000                         <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l04001"></a>04001                         {
<a name="l04002"></a>04002                                 jj = FR_idx[j];
<a name="l04003"></a>04003 
<a name="l04004"></a>04004                                 <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l04005"></a>04005                                         ZHz[i] += <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(jj,i) * Hz[j];
<a name="l04006"></a>04006                         }
<a name="l04007"></a>04007 
<a name="l04008"></a>04008                         <span class="comment">/* 3) Calculate r = R^-T * ZHz. */</span>
<a name="l04009"></a>04009                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a95838c30238aac5f614731cd33ceb48e">backsolveR</a>( ZHz,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,r ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l04010"></a>04010                         {
<a name="l04011"></a>04011                                 <span class="keyword">delete</span>[] Hz; <span class="keyword">delete</span>[] r; <span class="keyword">delete</span>[] ZHz;
<a name="l04012"></a>04012                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5fc42134f421c9bd4d84642049efe873">RET_REMOVECONSTRAINT_FAILED</a> );
<a name="l04013"></a>04013                         }
<a name="l04014"></a>04014 
<a name="l04015"></a>04015                         <span class="comment">/* 4) Calculate rho2 = rho^2 = z&#39;*Hz - r&#39;*r</span>
<a name="l04016"></a>04016 <span class="comment">                         *    and store r into R. */</span>
<a name="l04017"></a>04017                         <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l04018"></a>04018                         {
<a name="l04019"></a>04019                                 rho2 -= r[i]*r[i];
<a name="l04020"></a>04020                                 <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,nZ) = r[i];
<a name="l04021"></a>04021                         }
<a name="l04022"></a>04022 
<a name="l04023"></a>04023                         <span class="keyword">delete</span>[] r; <span class="keyword">delete</span>[] ZHz;
<a name="l04024"></a>04024                 }
<a name="l04025"></a>04025 
<a name="l04026"></a>04026                 <span class="comment">/* 5) Store rho into R. */</span>
<a name="l04027"></a>04027                 <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l04028"></a>04028                         rho2 += <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(FR_idx[j],nZ) * Hz[j];
<a name="l04029"></a>04029 
<a name="l04030"></a>04030                 <span class="keyword">delete</span>[] Hz;
<a name="l04031"></a>04031 
<a name="l04032"></a>04032                 <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#abba3f3ece76237c647b5719eae9c26f2">enableFlippingBounds</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( allowFlipping == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( exchangeHappened == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) )
<a name="l04033"></a>04033                 {
<a name="l04034"></a>04034                         <span class="keywordflow">if</span> ( rho2 &gt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aadb15470a12af09f0146a8b24e1a26fd">epsFlipping</a> )
<a name="l04035"></a>04035                                 <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(nZ,nZ) = sqrt( rho2 );
<a name="l04036"></a>04036                         <span class="keywordflow">else</span>
<a name="l04037"></a>04037                         {
<a name="l04038"></a>04038                                 <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> = <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a4bd6c8ccecaaf211801db7381f2361ec">HST_SEMIDEF</a>;
<a name="l04039"></a>04039 
<a name="l04040"></a>04040                                 <a class="code" href="classQProblemB.html#afc23c08b6cdc0ca93f9c049e9a318744">flipper</a>.<a class="code" href="classFlipper.html#adb66871d1abbf22109618085b9636f26">get</a>( &amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>,<a class="code" href="classQProblemB.html#a8402fb9f4dbfaa9ad433457ba03751f0">R</a>,&amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>,<a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>,<a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> );
<a name="l04041"></a>04041                                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a20c83fc0fac5e0d0167569ddda86b184">flipFixed</a>(number);
<a name="l04042"></a>04042                                 <a class="code" href="classQProblem.html#a1b23ea57017d56736b4d90e3f067132d">idxAddC</a> = number;
<a name="l04043"></a>04043                                 <a class="code" href="classQProblem.html#adc925de671d66633d16b96fec82566e5">excAddC</a> = 2;
<a name="l04044"></a>04044 
<a name="l04045"></a>04045                                 <span class="keywordflow">switch</span> (<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(number))
<a name="l04046"></a>04046                                 {
<a name="l04047"></a>04047                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>:
<a name="l04048"></a>04048                                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[number] = <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[number]; <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[number] = -<a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[number]; <span class="keywordflow">break</span>;
<a name="l04049"></a>04049                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>:
<a name="l04050"></a>04050                                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[number] = <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[number]; <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[number] = -<a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[number]; <span class="keywordflow">break</span>;
<a name="l04051"></a>04051                                         <span class="keywordflow">default</span>:
<a name="l04052"></a>04052                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eab3a33d8e827abc7dc3c89a4a3ff8bc53">RET_MOVING_BOUND_FAILED</a> );
<a name="l04053"></a>04053                                 }
<a name="l04054"></a>04054 
<a name="l04055"></a>04055                                 hasFlipped = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l04056"></a>04056                         }
<a name="l04057"></a>04057                 }
<a name="l04058"></a>04058                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( exchangeHappened == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l04059"></a>04059                 {
<a name="l04060"></a>04060                         <span class="keywordflow">if</span> ( rho2 &gt; <a class="code" href="Constants_8hpp.html#ad819f2d51fdea4cd4ff6023e9e276e11">ZERO</a> )
<a name="l04061"></a>04061                                 <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(nZ,nZ) = sqrt( rho2 );
<a name="l04062"></a>04062                         <span class="keywordflow">else</span>
<a name="l04063"></a>04063                         {
<a name="l04064"></a>04064                                 <span class="keywordflow">if</span> ( allowFlipping == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l04065"></a>04065                                 {
<a name="l04066"></a>04066                                         <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(nZ,nZ) = 100.0*<a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a>;
<a name="l04067"></a>04067                                 }
<a name="l04068"></a>04068                                 <span class="keywordflow">else</span>
<a name="l04069"></a>04069                                 {
<a name="l04070"></a>04070                                         <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> = <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a4bd6c8ccecaaf211801db7381f2361ec">HST_SEMIDEF</a>;
<a name="l04071"></a>04071                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea02db76e7e6badd1b34350674562e9284">RET_HESSIAN_NOT_SPD</a> );
<a name="l04072"></a>04072                                 }
<a name="l04073"></a>04073                         }
<a name="l04074"></a>04074                 }
<a name="l04075"></a>04075         }
<a name="l04076"></a>04076 
<a name="l04077"></a>04077 
<a name="l04078"></a>04078         <span class="comment">/* IV) UPDATE INDICES */</span>
<a name="l04079"></a>04079         <a class="code" href="classQProblem.html#ac90fd3f4126680ffdceb86c5a64d1cb8">idxRemC</a> = number;
<a name="l04080"></a>04080         <span class="keywordflow">if</span> ( hasFlipped == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l04081"></a>04081         {
<a name="l04082"></a>04082                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a255ceba7c9460781c6e21b417304cedf">moveActiveToInactive</a>( number ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l04083"></a>04083                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5fc42134f421c9bd4d84642049efe873">RET_REMOVECONSTRAINT_FAILED</a> );
<a name="l04084"></a>04084         }
<a name="l04085"></a>04085 
<a name="l04086"></a>04086         <span class="keywordflow">if</span> (exchangeHappened == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>)
<a name="l04087"></a>04087         {
<a name="l04088"></a>04088                 <span class="comment">/* add bound or constraint */</span>
<a name="l04089"></a>04089 
<a name="l04090"></a>04090                 <span class="comment">/* hessianType = HST_SEMIDEF; */</span>
<a name="l04091"></a>04091                 <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(nZ,nZ) = 0.0;
<a name="l04092"></a>04092 
<a name="l04093"></a>04093                 <span class="keywordflow">if</span> ( addBoundNotConstraint )
<a name="l04094"></a>04094                 {
<a name="l04095"></a>04095                         <a class="code" href="classQProblem.html#abaeb7f9dc975f9c19342d1f846ee4e24">addBound</a>(addIdx, addStatus, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>);
<a name="l04096"></a>04096                         <a class="code" href="classQProblem.html#a36f054a93eb8dd2876a3e9d8bfb24922">excAddB</a> = 1;
<a name="l04097"></a>04097                 }
<a name="l04098"></a>04098                 <span class="keywordflow">else</span>
<a name="l04099"></a>04099                 {
<a name="l04100"></a>04100                         <a class="code" href="classQProblem.html#a9afd51a8349533f7ff5467518c761529">addConstraint</a>(addIdx, addStatus, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>);
<a name="l04101"></a>04101                         <a class="code" href="classQProblem.html#adc925de671d66633d16b96fec82566e5">excAddC</a> = 1;
<a name="l04102"></a>04102                 }
<a name="l04103"></a>04103         }
<a name="l04104"></a>04104 
<a name="l04105"></a>04105         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l04106"></a>04106 }
<a name="l04107"></a>04107 
<a name="l04108"></a>04108 
<a name="l04109"></a>04109 <span class="comment">/*</span>
<a name="l04110"></a>04110 <span class="comment"> *      r e m o v e B o u n d</span>
<a name="l04111"></a>04111 <span class="comment"> */</span>
<a name="l04112"></a><a class="code" href="classQProblem.html#a12931eb86b975a1e3b0537c94c30a290">04112</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a12931eb86b975a1e3b0537c94c30a290">QProblem::removeBound</a>(      <span class="keywordtype">int</span> number,
<a name="l04113"></a>04113                                                                         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> updateCholesky,
<a name="l04114"></a>04114                                                                         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> allowFlipping,
<a name="l04115"></a>04115                                                                         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> ensureNZC
<a name="l04116"></a>04116                                                                         )
<a name="l04117"></a>04117 {
<a name="l04118"></a>04118         <span class="keywordtype">int</span> i, j, ii, jj;
<a name="l04119"></a>04119         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l04120"></a>04120         <span class="keywordtype">int</span> addIdx;
<a name="l04121"></a>04121         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> addBoundNotConstraint;
<a name="l04122"></a>04122         <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> addStatus;
<a name="l04123"></a>04123         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> exchangeHappened = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l04124"></a>04124 
<a name="l04125"></a>04125 
<a name="l04126"></a>04126         <span class="comment">/* consistency checks */</span>
<a name="l04127"></a>04127         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( number ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> )
<a name="l04128"></a>04128                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eabc45ece4ce89b5f1099909a2fb7cdedd">RET_BOUND_NOT_ACTIVE</a> );
<a name="l04129"></a>04129 
<a name="l04130"></a>04130         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda5ce84ee8a93fc7e780e2c1e9440c95ed">QPS_NOTINITIALISED</a> )    ||
<a name="l04131"></a>04131                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda1ace398d1f8eddff294c06c72bc58fdb">QPS_AUXILIARYQPSOLVED</a> ) ||
<a name="l04132"></a>04132                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abda6f8af598b9b98f5a3582f8063f3b3ecb">QPS_HOMOTOPYQPSOLVED</a> )  ||
<a name="l04133"></a>04133                  ( <a class="code" href="classQProblemB.html#a6977b3a990bab9268ca1c71e8b0d30cf">getStatus</a>( ) == <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdaeaeec92065e112d99b1f82851e069bd3">QPS_SOLVED</a> )            )
<a name="l04134"></a>04134         {
<a name="l04135"></a>04135                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaee57058f3b42d5e58c701115a79c38a0">RET_UNKNOWN_BUG</a> );
<a name="l04136"></a>04136         }
<a name="l04137"></a>04137 
<a name="l04138"></a>04138         <span class="comment">/* some definitions */</span>
<a name="l04139"></a>04139         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l04140"></a>04140         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l04141"></a>04141         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l04142"></a>04142         <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l04143"></a>04143 
<a name="l04144"></a>04144         <span class="keywordtype">int</span> tcol = <a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a> - nAC;
<a name="l04145"></a>04145 
<a name="l04146"></a>04146         <span class="comment">/* N) PERFORM ZERO CURVATURE TEST. */</span>
<a name="l04147"></a>04147         <span class="keywordflow">if</span> (ensureNZC == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>)
<a name="l04148"></a>04148         {
<a name="l04149"></a>04149                 returnvalue = <a class="code" href="classQProblem.html#af31805351afbf485558eaf51e0bab3fd">ensureNonzeroCurvature</a>(<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, number, exchangeHappened, addBoundNotConstraint, addIdx, addStatus);
<a name="l04150"></a>04150 
<a name="l04151"></a>04151                 <span class="keywordflow">if</span> (returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>)
<a name="l04152"></a>04152                         <span class="keywordflow">return</span> returnvalue;
<a name="l04153"></a>04153         }
<a name="l04154"></a>04154 
<a name="l04155"></a>04155         <span class="comment">/* save index sets and decompositions for flipping bounds strategy */</span>
<a name="l04156"></a>04156         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#abba3f3ece76237c647b5719eae9c26f2">enableFlippingBounds</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( allowFlipping == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( exchangeHappened == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) )
<a name="l04157"></a>04157                 <a class="code" href="classQProblemB.html#afc23c08b6cdc0ca93f9c049e9a318744">flipper</a>.<a class="code" href="classFlipper.html#a918b42bfc9a7caa375170ffb50ff5708">set</a>( &amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>,<a class="code" href="classQProblemB.html#a8402fb9f4dbfaa9ad433457ba03751f0">R</a>,&amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>,<a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>,<a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> );
<a name="l04158"></a>04158 
<a name="l04159"></a>04159         <span class="comment">/* I) UPDATE INDICES */</span>
<a name="l04160"></a>04160         <a class="code" href="classQProblem.html#abad5c15e6d0c621cea0d7355a5eb16c1">idxRemB</a> = number;
<a name="l04161"></a>04161         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#ad5b809717231157ee0e02ab972106795">moveFixedToFree</a>( number ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l04162"></a>04162                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eac2eeb585c861a7dd1f953d3ccfc82761">RET_REMOVEBOUND_FAILED</a> );
<a name="l04163"></a>04163 
<a name="l04164"></a>04164         <span class="keywordtype">int</span>* FR_idx;
<a name="l04165"></a>04165         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l04166"></a>04166 
<a name="l04167"></a>04167         <span class="comment">/* I) APPEND &lt;nFR+1&gt;th UNITY VECTOR TO Q. */</span>
<a name="l04168"></a>04168         <span class="keywordtype">int</span> nnFRp1 = FR_idx[nFR];
<a name="l04169"></a>04169         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l04170"></a>04170         {
<a name="l04171"></a>04171                 ii = FR_idx[i];
<a name="l04172"></a>04172                 <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nFR) = 0.0;
<a name="l04173"></a>04173                 <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(nnFRp1,i) = 0.0;
<a name="l04174"></a>04174         }
<a name="l04175"></a>04175         <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(nnFRp1,nFR) = 1.0;
<a name="l04176"></a>04176 
<a name="l04177"></a>04177         <span class="keywordflow">if</span> ( nAC &gt; 0 )
<a name="l04178"></a>04178         {
<a name="l04179"></a>04179                 <span class="comment">/* store new column a in a temporary vector instead of shifting T one column to the left and appending a */</span>
<a name="l04180"></a>04180                 <span class="keywordtype">int</span>* AC_idx;
<a name="l04181"></a>04181                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l04182"></a>04182 
<a name="l04183"></a>04183                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* tmp = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l04184"></a>04184                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#a7b9f4ce0fe8c2efc34503bb260383d2c">getCol</a>(number, <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>(), 1.0, tmp);
<a name="l04185"></a>04185 
<a name="l04186"></a>04186 
<a name="l04187"></a>04187                 <span class="comment">/* II) RESTORE TRIANGULAR FORM OF T,</span>
<a name="l04188"></a>04188 <span class="comment">                 *     use column-wise Givens rotations to restore reverse triangular form</span>
<a name="l04189"></a>04189 <span class="comment">                 *     of T = [T A(:,number)], simultanenous change of Q (i.e. Y and Z). */</span>
<a name="l04190"></a>04190                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> c, s, nu;
<a name="l04191"></a>04191 
<a name="l04192"></a>04192                 <span class="keywordflow">for</span>( j=(nAC-1); j&gt;=0; --j )
<a name="l04193"></a>04193                 {
<a name="l04194"></a>04194                         <a class="code" href="classQProblemB.html#a736d704a3575d1a4ec4565ddfdf3e6d8">computeGivens</a>( tmp[nAC-1-j],<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-1-j,tcol+j),<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nAC-1-j,tcol+j),tmp[nAC-1-j],c,s );
<a name="l04195"></a>04195                         nu = s/(1.0+c);
<a name="l04196"></a>04196 
<a name="l04197"></a>04197                         <span class="keywordflow">for</span>( i=(nAC-j); i&lt;nAC; ++i )
<a name="l04198"></a>04198                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,tmp[i],<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,tcol+j),<a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,tcol+j),tmp[i] );
<a name="l04199"></a>04199 
<a name="l04200"></a>04200                         <span class="keywordflow">for</span>( i=0; i&lt;=nFR; ++i )
<a name="l04201"></a>04201                         {
<a name="l04202"></a>04202                                 ii = FR_idx[i];
<a name="l04203"></a>04203                                 <span class="comment">/* nZ+1+nAC = nFR+1  /  nZ+(1) = nZ+1 */</span>
<a name="l04204"></a>04204                                 <a class="code" href="classQProblemB.html#acd1eae6b1b9fe21d5b9341a64dc82e98">applyGivens</a>( c,s,nu,<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+1+j),<a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+j) );
<a name="l04205"></a>04205                         }
<a name="l04206"></a>04206                 }
<a name="l04207"></a>04207 
<a name="l04208"></a>04208                 <span class="keyword">delete</span>[] tmp;
<a name="l04209"></a>04209         }
<a name="l04210"></a>04210 
<a name="l04211"></a>04211 
<a name="l04212"></a>04212         <span class="keywordflow">if</span> ( ( updateCholesky == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp;
<a name="l04213"></a>04213                  ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )   &amp;&amp; ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> != <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> ) )
<a name="l04214"></a>04214         {
<a name="l04215"></a>04215                 <span class="comment">/* III) UPDATE CHOLESKY DECOMPOSITION,</span>
<a name="l04216"></a>04216 <span class="comment">                 *      calculate new additional column (i.e. [r sqrt(rho2)]&#39;)</span>
<a name="l04217"></a>04217 <span class="comment">                 *      of the Cholesky factor R: */</span>
<a name="l04218"></a>04218                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> z2 = <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(nnFRp1,nZ);
<a name="l04219"></a>04219                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> rho2 = <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#ab78435722398170cb87b0eb9650d8ca1">diag</a>(nnFRp1)*z2*z2; <span class="comment">/* rho2 = h2*z2*z2 */</span>
<a name="l04220"></a>04220 
<a name="l04221"></a>04221                 <span class="keywordflow">if</span> ( nFR &gt; 0 )
<a name="l04222"></a>04222                 {
<a name="l04223"></a>04223                         <span class="comment">/* Attention: Index list of free variables has already grown by one! */</span>
<a name="l04224"></a>04224                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* Hz = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR+1];
<a name="l04225"></a>04225                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* z = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR+1];
<a name="l04226"></a>04226                         <span class="comment">/* 1) Calculate R&#39;*r = Zfr&#39;*Hfr*z1 + z2*Zfr&#39;*h1 =: Zfr&#39;*Hz + z2*Zfr&#39;*h1 =: rhs and</span>
<a name="l04227"></a>04227 <span class="comment">                         *    rho2 = z1&#39;*Hfr*z1 + 2*z2*h1&#39;*z1 + h2*z2^2 - r&#39;*r =: z1&#39;*Hz + 2*z2*h1&#39;*z1 + h2*z2^2 - r&#39;r */</span>
<a name="l04228"></a>04228                         <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l04229"></a>04229                                 z[j] = <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(FR_idx[j],nZ);
<a name="l04230"></a>04230                         z[nFR] = 0.0;
<a name="l04231"></a>04231                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1, 1.0, z, nFR+1, 0.0, Hz, nFR+1);
<a name="l04232"></a>04232 
<a name="l04233"></a>04233                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#a7b9f4ce0fe8c2efc34503bb260383d2c">getCol</a>(nnFRp1, <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1.0, z);
<a name="l04234"></a>04234 
<a name="l04235"></a>04235                         <span class="keywordflow">if</span> ( nZ &gt; 0 )
<a name="l04236"></a>04236                         {
<a name="l04237"></a>04237                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* r = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nZ];
<a name="l04238"></a>04238                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* rhs = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nZ];
<a name="l04239"></a>04239                                 <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l04240"></a>04240                                         rhs[i] = 0.0;
<a name="l04241"></a>04241 
<a name="l04242"></a>04242                                 <span class="comment">/* 2) Calculate rhs. */</span>
<a name="l04243"></a>04243                                 <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l04244"></a>04244                                 {
<a name="l04245"></a>04245                                         jj = FR_idx[j];
<a name="l04246"></a>04246                                         <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l04247"></a>04247                                                                                 <span class="comment">/* Zfr&#39; * ( Hz + z2*h1 ) */</span>
<a name="l04248"></a>04248                                                 rhs[i] += <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(jj,i) * ( Hz[j] + z2 * z[j] );
<a name="l04249"></a>04249                                 }
<a name="l04250"></a>04250 
<a name="l04251"></a>04251                                 <span class="comment">/* 3) Calculate r = R^-T * rhs. */</span>
<a name="l04252"></a>04252                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a95838c30238aac5f614731cd33ceb48e">backsolveR</a>( rhs,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,r ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l04253"></a>04253                                 {
<a name="l04254"></a>04254                                         <span class="keyword">delete</span>[] z;
<a name="l04255"></a>04255                                         <span class="keyword">delete</span>[] Hz; <span class="keyword">delete</span>[] r; <span class="keyword">delete</span>[] rhs;
<a name="l04256"></a>04256                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eac2eeb585c861a7dd1f953d3ccfc82761">RET_REMOVEBOUND_FAILED</a> );
<a name="l04257"></a>04257                                 }
<a name="l04258"></a>04258 
<a name="l04259"></a>04259 
<a name="l04260"></a>04260                                 <span class="comment">/* 4) Calculate rho2 = rho^2 = z&#39;*Hz - r&#39;*r</span>
<a name="l04261"></a>04261 <span class="comment">                                 *    and store r into R. */</span>
<a name="l04262"></a>04262                                 <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l04263"></a>04263                                 {
<a name="l04264"></a>04264                                         rho2 -= r[i]*r[i];
<a name="l04265"></a>04265                                         <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(i,nZ) = r[i];
<a name="l04266"></a>04266                                 }
<a name="l04267"></a>04267 
<a name="l04268"></a>04268                                 <span class="keyword">delete</span>[] rhs; <span class="keyword">delete</span>[] r;
<a name="l04269"></a>04269                         }
<a name="l04270"></a>04270 
<a name="l04271"></a>04271                         <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l04272"></a>04272                         {
<a name="l04273"></a>04273                                 jj = FR_idx[j];
<a name="l04274"></a>04274                                                         <span class="comment">/* z1&#39; * ( Hz + 2*z2*h1 ) */</span>
<a name="l04275"></a>04275                                 rho2 += <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(jj,nZ) * ( Hz[j] + 2.0*z2*z[j] );
<a name="l04276"></a>04276                         }
<a name="l04277"></a>04277 
<a name="l04278"></a>04278                         <span class="keyword">delete</span>[] z;
<a name="l04279"></a>04279                         <span class="keyword">delete</span>[] Hz;
<a name="l04280"></a>04280                 }
<a name="l04281"></a>04281 
<a name="l04282"></a>04282                 <span class="comment">/* 5) Store rho into R. */</span>
<a name="l04283"></a>04283                 <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#abba3f3ece76237c647b5719eae9c26f2">enableFlippingBounds</a> == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( allowFlipping == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( exchangeHappened == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) )
<a name="l04284"></a>04284                 {
<a name="l04285"></a>04285                         <span class="keywordflow">if</span> ( rho2 &gt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aadb15470a12af09f0146a8b24e1a26fd">epsFlipping</a> )
<a name="l04286"></a>04286                                 <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(nZ,nZ) = sqrt( rho2 );
<a name="l04287"></a>04287                         <span class="keywordflow">else</span>
<a name="l04288"></a>04288                         {
<a name="l04289"></a>04289                                 <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> = <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a4bd6c8ccecaaf211801db7381f2361ec">HST_SEMIDEF</a>;
<a name="l04290"></a>04290 
<a name="l04291"></a>04291                                 <a class="code" href="classQProblemB.html#afc23c08b6cdc0ca93f9c049e9a318744">flipper</a>.<a class="code" href="classFlipper.html#adb66871d1abbf22109618085b9636f26">get</a>( &amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>,<a class="code" href="classQProblemB.html#a8402fb9f4dbfaa9ad433457ba03751f0">R</a>,&amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>,<a class="code" href="classQProblem.html#aa8bebb2350185cb95782c3bbb98f739f">Q</a>,<a class="code" href="classQProblem.html#a73598120773468b6d4d792d520fb1382">T</a> );
<a name="l04292"></a>04292                                 <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#ae040b8d26920a6e52a572171504891df">flipFixed</a>(number);
<a name="l04293"></a>04293                                 <a class="code" href="classQProblem.html#aee232819e1d7bd8720872a886aa63f1d">idxAddB</a> = number;
<a name="l04294"></a>04294                                 <a class="code" href="classQProblem.html#a36f054a93eb8dd2876a3e9d8bfb24922">excAddB</a> = 2;
<a name="l04295"></a>04295 
<a name="l04296"></a>04296                                 <span class="keywordflow">switch</span> (<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(number))
<a name="l04297"></a>04297                                 {
<a name="l04298"></a>04298                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>: 
<a name="l04299"></a>04299                                                 <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[number] = <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[number]; 
<a name="l04300"></a>04300                                                 <span class="keywordflow">break</span>;
<a name="l04301"></a>04301                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>: 
<a name="l04302"></a>04302                                                 <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[number] = <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[number]; 
<a name="l04303"></a>04303                                                 <span class="keywordflow">break</span>;
<a name="l04304"></a>04304                                         <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eab3a33d8e827abc7dc3c89a4a3ff8bc53">RET_MOVING_BOUND_FAILED</a> );
<a name="l04305"></a>04305                                 }
<a name="l04306"></a>04306 
<a name="l04307"></a>04307                         }
<a name="l04308"></a>04308                 }
<a name="l04309"></a>04309                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( exchangeHappened == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l04310"></a>04310                 {
<a name="l04311"></a>04311                         <span class="keywordflow">if</span> ( rho2 &gt; <a class="code" href="Constants_8hpp.html#ad819f2d51fdea4cd4ff6023e9e276e11">ZERO</a> )
<a name="l04312"></a>04312                                 <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(nZ,nZ) = sqrt( rho2 );
<a name="l04313"></a>04313                         <span class="keywordflow">else</span>
<a name="l04314"></a>04314                         {
<a name="l04315"></a>04315                                 <span class="keywordflow">if</span> ( allowFlipping == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l04316"></a>04316                                         <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(nZ,nZ) = 100.0*<a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a>;
<a name="l04317"></a>04317                                 <span class="keywordflow">else</span>
<a name="l04318"></a>04318                                 {
<a name="l04319"></a>04319                                         <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> = <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a4bd6c8ccecaaf211801db7381f2361ec">HST_SEMIDEF</a>;
<a name="l04320"></a>04320                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea02db76e7e6badd1b34350674562e9284">RET_HESSIAN_NOT_SPD</a> );
<a name="l04321"></a>04321                                 }
<a name="l04322"></a>04322                         }
<a name="l04323"></a>04323                 }
<a name="l04324"></a>04324                 <span class="keywordflow">else</span>
<a name="l04325"></a>04325                 {
<a name="l04326"></a>04326                         <span class="comment">/* add bound or constraint */</span>
<a name="l04327"></a>04327 
<a name="l04328"></a>04328                         <span class="comment">/* hessianType = HST_SEMIDEF; */</span>
<a name="l04329"></a>04329                         <a class="code" href="Types_8hpp.html#ad1a7cec2a5fe530a76ed5d03ea25ef66">RR</a>(nZ,nZ) = 0.0;
<a name="l04330"></a>04330 
<a name="l04331"></a>04331                         <span class="keywordflow">if</span> ( addBoundNotConstraint )
<a name="l04332"></a>04332                         {
<a name="l04333"></a>04333                                 <a class="code" href="classQProblem.html#abaeb7f9dc975f9c19342d1f846ee4e24">addBound</a>(addIdx, addStatus, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>);
<a name="l04334"></a>04334                                 <a class="code" href="classQProblem.html#a36f054a93eb8dd2876a3e9d8bfb24922">excAddB</a> = 1;
<a name="l04335"></a>04335                         }
<a name="l04336"></a>04336                         <span class="keywordflow">else</span>
<a name="l04337"></a>04337                         {
<a name="l04338"></a>04338                                 <a class="code" href="classQProblem.html#a9afd51a8349533f7ff5467518c761529">addConstraint</a>(addIdx, addStatus, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>);
<a name="l04339"></a>04339                                 <a class="code" href="classQProblem.html#adc925de671d66633d16b96fec82566e5">excAddC</a> = 1;
<a name="l04340"></a>04340                         }
<a name="l04341"></a>04341                 }
<a name="l04342"></a>04342         }
<a name="l04343"></a>04343 
<a name="l04344"></a>04344         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l04345"></a>04345 }
<a name="l04346"></a>04346 
<a name="l04347"></a>04347 
<a name="l04348"></a>04348 
<a name="l04349"></a><a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">04349</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">QProblem::performPlainRatioTest</a>(    <span class="keywordtype">int</span> nIdx,
<a name="l04350"></a>04350                                                                                                 <span class="keyword">const</span> <span class="keywordtype">int</span>* <span class="keyword">const</span> idxList,
<a name="l04351"></a>04351                                                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> num,
<a name="l04352"></a>04352                                                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> den,
<a name="l04353"></a>04353                                                                                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> epsNum,
<a name="l04354"></a>04354                                                                                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> epsDen,
<a name="l04355"></a>04355                                                                                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>&amp; t,
<a name="l04356"></a>04356                                                                                                 <span class="keywordtype">int</span>&amp; BC_idx
<a name="l04357"></a>04357                                                                                                 )<span class="keyword"> const</span>
<a name="l04358"></a>04358 <span class="keyword"></span>{
<a name="l04359"></a>04359         <span class="keywordtype">int</span> i;
<a name="l04360"></a>04360         <span class="keywordflow">for</span> (i = 0; i &lt; nIdx; i++)
<a name="l04361"></a>04361                 <span class="keywordflow">if</span> ( (num[i] &gt; epsNum) &amp;&amp; (den[i] &gt; epsDen) &amp;&amp; (t * den[i] &gt; num[i]) )
<a name="l04362"></a>04362                 {
<a name="l04363"></a>04363                         t = num[i] / den[i];
<a name="l04364"></a>04364                         BC_idx = idxList[i];
<a name="l04365"></a>04365                 }
<a name="l04366"></a>04366                 
<a name="l04367"></a>04367         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l04368"></a>04368 }
<a name="l04369"></a>04369 
<a name="l04370"></a>04370 
<a name="l04371"></a><a class="code" href="classQProblem.html#af31805351afbf485558eaf51e0bab3fd">04371</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#af31805351afbf485558eaf51e0bab3fd">QProblem::ensureNonzeroCurvature</a>(
<a name="l04372"></a>04372                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> removeBoundNotConstraint,
<a name="l04373"></a>04373                 <span class="keywordtype">int</span> remIdx,
<a name="l04374"></a>04374                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> &amp;exchangeHappened,
<a name="l04375"></a>04375                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> &amp;addBoundNotConstraint,
<a name="l04376"></a>04376                 <span class="keywordtype">int</span> &amp;addIdx,
<a name="l04377"></a>04377                 <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> &amp;addStatus
<a name="l04378"></a>04378                 )
<a name="l04379"></a>04379 {
<a name="l04380"></a>04380         <span class="keywordtype">int</span> i, ii;
<a name="l04381"></a>04381         <span class="keywordtype">int</span> addLBndIdx = -1, addLCnstrIdx = -1, addUBndIdx = -1, addUCnstrIdx = -1; <span class="comment">/* exchange indices */</span>
<a name="l04382"></a>04382         <span class="keywordtype">int</span> *FX_idx, *AC_idx, *IAC_idx;
<a name="l04383"></a>04383         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l04384"></a>04384 <span class="comment">// </span>
<a name="l04385"></a>04385         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l04386"></a>04386         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l04387"></a>04387         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l04388"></a>04388         <span class="keywordtype">int</span> nC  = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l04389"></a>04389         <span class="keywordtype">int</span> nFX = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>( );
<a name="l04390"></a>04390         <span class="keywordtype">int</span> nIAC = <a class="code" href="classQProblem.html#a98e1d71a037c6b4a47cc6b38a4737296">getNIAC</a>( );
<a name="l04391"></a>04391 
<a name="l04392"></a>04392         <span class="keywordtype">int</span>* FR_idx;
<a name="l04393"></a>04393         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l04394"></a>04394 
<a name="l04395"></a>04395 <span class="comment">//      real_t *delta_g   = new real_t[nV];</span>
<a name="l04396"></a>04396         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_xFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l04397"></a>04397         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_xFR = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFR];
<a name="l04398"></a>04398         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_yAC = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nAC];
<a name="l04399"></a>04399         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *delta_yFX = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nFX];
<a name="l04400"></a>04400 
<a name="l04401"></a>04401         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FX_idx );
<a name="l04402"></a>04402         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l04403"></a>04403         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#ab4d19324b973e26a90f1a406b2dcfc1d">getInactive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;IAC_idx );
<a name="l04404"></a>04404 
<a name="l04405"></a>04405         addBoundNotConstraint = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l04406"></a>04406         addStatus = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>;
<a name="l04407"></a>04407         exchangeHappened = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l04408"></a>04408 
<a name="l04409"></a>04409         <span class="keywordflow">if</span> (removeBoundNotConstraint)
<a name="l04410"></a>04410         {
<a name="l04411"></a>04411                 <span class="keywordtype">int</span> dim = nV &lt; nC ? nC : nV;
<a name="l04412"></a>04412                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *nul = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[dim];
<a name="l04413"></a>04413                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *ek = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV]; <span class="comment">/* minus e_k (bound k is removed) */</span>
<a name="l04414"></a>04414                 <span class="keywordflow">for</span> (ii = 0; ii &lt; dim; ++ii)
<a name="l04415"></a>04415                         nul[ii]=0.0;
<a name="l04416"></a>04416                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nV; ++ii)
<a name="l04417"></a>04417                         ek[ii]=0.0;
<a name="l04418"></a>04418                 ek[remIdx] = <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(remIdx) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ? 1.0 : -1.0;
<a name="l04419"></a>04419 
<a name="l04420"></a>04420                 returnvalue = <a class="code" href="classQProblem.html#a1b2636572bd7eeed4f23222a6a1653e1">determineStepDirection</a> (nul, nul, nul, ek, ek,
<a name="l04421"></a>04421                                                                                           <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,
<a name="l04422"></a>04422                                                                                           delta_xFX, delta_xFR, delta_yAC, delta_yFX);
<a name="l04423"></a>04423                 <span class="keyword">delete</span>[] ek;
<a name="l04424"></a>04424                 <span class="keyword">delete</span>[] nul;
<a name="l04425"></a>04425         }
<a name="l04426"></a>04426         <span class="keywordflow">else</span>
<a name="l04427"></a>04427         {
<a name="l04428"></a>04428                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *nul = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l04429"></a>04429                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *ek = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC]; <span class="comment">/* minus e_k (constraint k is removed) */</span>
<a name="l04430"></a>04430                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nV; ++ii)
<a name="l04431"></a>04431                         nul[ii]=0.0;
<a name="l04432"></a>04432                 <span class="keywordflow">for</span> (ii = 0; ii &lt; nC; ++ii)
<a name="l04433"></a>04433                         ek[ii]=0.0;
<a name="l04434"></a>04434                 ek[remIdx] = <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(remIdx) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> ? 1.0 : -1.0;
<a name="l04435"></a>04435 
<a name="l04436"></a>04436                 returnvalue = <a class="code" href="classQProblem.html#a1b2636572bd7eeed4f23222a6a1653e1">determineStepDirection</a> (nul,
<a name="l04437"></a>04437                                                                                           ek, ek, nul, nul,
<a name="l04438"></a>04438                                                                                           <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,
<a name="l04439"></a>04439                                                                                           delta_xFX, delta_xFR, delta_yAC, delta_yFX);
<a name="l04440"></a>04440                 <span class="keyword">delete</span>[] ek;
<a name="l04441"></a>04441                 <span class="keyword">delete</span>[] nul;
<a name="l04442"></a>04442         }
<a name="l04443"></a>04443 
<a name="l04444"></a>04444         <span class="comment">/* compute the weight in inf-norm */</span>
<a name="l04445"></a>04445         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> normXi = 0.0;
<a name="l04446"></a>04446         <span class="keywordflow">for</span> (ii = 0; ii &lt; nAC; ++ii)
<a name="l04447"></a>04447         {
<a name="l04448"></a>04448                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_yAC[ii]);
<a name="l04449"></a>04449                 <span class="keywordflow">if</span> (normXi &lt; a) normXi = a;
<a name="l04450"></a>04450         }
<a name="l04451"></a>04451         <span class="keywordflow">for</span> (ii = 0; ii &lt; nFX; ++ii)
<a name="l04452"></a>04452         {
<a name="l04453"></a>04453                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_yFX[ii]);
<a name="l04454"></a>04454                 <span class="keywordflow">if</span> (normXi &lt; a) normXi = a;
<a name="l04455"></a>04455         }
<a name="l04456"></a>04456 
<a name="l04457"></a>04457         <span class="comment">/* look at the &quot;zero&quot; in a relative inf-norm */</span>
<a name="l04458"></a>04458         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> normS = 0.0;
<a name="l04459"></a>04459         <span class="keywordflow">for</span> (ii = 0; ii &lt; nFX; ++ii)
<a name="l04460"></a>04460         {
<a name="l04461"></a>04461                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_xFX[ii]);
<a name="l04462"></a>04462                 <span class="keywordflow">if</span> (normS &lt; a) normS = a;
<a name="l04463"></a>04463         }
<a name="l04464"></a>04464         <span class="keywordflow">for</span> (ii = 0; ii &lt; nFR; ++ii)
<a name="l04465"></a>04465         {
<a name="l04466"></a>04466                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> a = fabs (delta_xFR[ii]);
<a name="l04467"></a>04467                 <span class="keywordflow">if</span> (normS &lt; a) normS = a;
<a name="l04468"></a>04468         }
<a name="l04469"></a>04469 
<a name="l04470"></a>04470         <span class="comment">/* relative test against zero in inf-norm */</span>
<a name="l04471"></a>04471         <span class="keywordflow">if</span> (normXi &lt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a636e3942e0ad78b9c4914541a20b70d0">epsNZCTests</a> * normS)
<a name="l04472"></a>04472         {
<a name="l04473"></a>04473                 <span class="comment">/* determine jump in x via ratio tests */</span>
<a name="l04474"></a>04474                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> sigmaLBnd, sigmaLCnstr, sigmaUBnd, sigmaUCnstr, sigma;
<a name="l04475"></a>04475 
<a name="l04476"></a>04476                 <span class="comment">/* bounds */</span>
<a name="l04477"></a>04477 
<a name="l04478"></a>04478                 <span class="comment">/* compress x-u */</span>
<a name="l04479"></a>04479                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *x_W = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[<a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a>(1,nFR)];
<a name="l04480"></a>04480                 <span class="keywordflow">for</span> (i = 0; i &lt; nFR; i++)
<a name="l04481"></a>04481                 {
<a name="l04482"></a>04482                         ii = FR_idx[i];
<a name="l04483"></a>04483                         x_W[i] = <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[ii] - <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[ii];
<a name="l04484"></a>04484                 }
<a name="l04485"></a>04485                 <span class="comment">/* performRatioTest( nFR,FR_idx,&amp;bounds, x_W,delta_xFR, options.epsNum,options.epsDen, sigmaUBnd,addUBndIdx ); */</span>
<a name="l04486"></a>04486                 sigmaUBnd = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a4b40320e0298e2d21720541b117f5d81">maxPrimalJump</a>;
<a name="l04487"></a>04487                 addUBndIdx = -1;
<a name="l04488"></a>04488                 <a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">performPlainRatioTest</a>(nFR, FR_idx, x_W, delta_xFR, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, sigmaUBnd, addUBndIdx);
<a name="l04489"></a>04489                 <span class="keywordflow">if</span> (removeBoundNotConstraint == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> &amp;&amp; <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(remIdx) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>)
<a name="l04490"></a>04490                 {
<a name="l04491"></a>04491                         <span class="comment">/* also consider bound which is to be removed */</span>
<a name="l04492"></a>04492                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> eins = 1.0;
<a name="l04493"></a>04493                         x_W[0] = <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[remIdx] - <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[remIdx];
<a name="l04494"></a>04494                         <a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">performPlainRatioTest</a>(1, &amp;remIdx, x_W, &amp;eins, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, sigmaUBnd, addUBndIdx);
<a name="l04495"></a>04495                 }
<a name="l04496"></a>04496 
<a name="l04497"></a>04497                 <span class="comment">/* compress x-l */</span>
<a name="l04498"></a>04498                 <span class="keywordflow">for</span> (i = 0; i &lt; nFR; i++)
<a name="l04499"></a>04499                 {
<a name="l04500"></a>04500                         ii = FR_idx[i];
<a name="l04501"></a>04501                         x_W[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[ii] - <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[ii];
<a name="l04502"></a>04502                 }
<a name="l04503"></a>04503                 <span class="keywordflow">for</span> (i = 0; i &lt; nFR; i++)
<a name="l04504"></a>04504                         delta_xFR[i] = -delta_xFR[i];
<a name="l04505"></a>04505                 <span class="comment">/* performRatioTest( nFR,FR_idx,&amp;bounds, x_W,delta_xFR, options.epsNum,options.epsDen, sigmaLBnd,addLBndIdx ); */</span>
<a name="l04506"></a>04506                 sigmaLBnd = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a4b40320e0298e2d21720541b117f5d81">maxPrimalJump</a>;
<a name="l04507"></a>04507                 addLBndIdx = -1;
<a name="l04508"></a>04508                 <a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">performPlainRatioTest</a>(nFR, FR_idx, x_W, delta_xFR, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, sigmaLBnd, addLBndIdx);
<a name="l04509"></a>04509                 <span class="keywordflow">if</span> (removeBoundNotConstraint == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> &amp;&amp; <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(remIdx) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>)
<a name="l04510"></a>04510                 {
<a name="l04511"></a>04511                         <span class="comment">/* also consider bound which is to be removed */</span>
<a name="l04512"></a>04512                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> eins = 1.0;
<a name="l04513"></a>04513                         x_W[0] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[remIdx] - <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[remIdx];
<a name="l04514"></a>04514                         <a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">performPlainRatioTest</a>(1, &amp;remIdx, x_W, &amp;eins, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, sigmaLBnd, addLBndIdx);
<a name="l04515"></a>04515                 }
<a name="l04516"></a>04516                 <span class="keywordflow">for</span> (i = 0; i &lt; nFR; i++)
<a name="l04517"></a>04517                         delta_xFR[i] = -delta_xFR[i];
<a name="l04518"></a>04518 
<a name="l04519"></a>04519                 <span class="keyword">delete</span>[] x_W;
<a name="l04520"></a>04520 
<a name="l04521"></a>04521                 <span class="comment">/* constraints */</span>
<a name="l04522"></a>04522 
<a name="l04523"></a>04523                 <span class="comment">/* compute As (compressed to inactive constraints) */</span>
<a name="l04524"></a>04524                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *As = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nIAC];
<a name="l04525"></a>04525                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#ab4d19324b973e26a90f1a406b2dcfc1d">getInactive</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), 1, 1.0, delta_xFX, nFX, 0.0, As, nIAC);
<a name="l04526"></a>04526                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#ab4d19324b973e26a90f1a406b2dcfc1d">getInactive</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1, 1.0, delta_xFR, nFR, 1.0, As, nIAC);
<a name="l04527"></a>04527 
<a name="l04528"></a>04528                 <span class="comment">/* compress Ax_u */</span>
<a name="l04529"></a>04529                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *Ax_W = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nIAC];
<a name="l04530"></a>04530                 <span class="keywordflow">for</span> (i = 0; i &lt; nIAC; i++)
<a name="l04531"></a>04531                 {
<a name="l04532"></a>04532                         ii = IAC_idx[i];
<a name="l04533"></a>04533                         Ax_W[i] = <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[ii];
<a name="l04534"></a>04534                 }
<a name="l04535"></a>04535                 <span class="comment">/* performRatioTest( nIAC,IAC_idx,&amp;constraints, Ax_W,As, options.epsNum,options.epsDen, sigmaUCnstr,addUCnstrIdx ); */</span>
<a name="l04536"></a>04536                 sigmaUCnstr = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a4b40320e0298e2d21720541b117f5d81">maxPrimalJump</a>;
<a name="l04537"></a>04537                 addUCnstrIdx = -1;
<a name="l04538"></a>04538                 <a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">performPlainRatioTest</a>(nIAC, IAC_idx, Ax_W, As, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, sigmaUCnstr, addUCnstrIdx);
<a name="l04539"></a>04539                 <span class="keywordflow">if</span> (removeBoundNotConstraint == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> &amp;&amp; <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(remIdx) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>)
<a name="l04540"></a>04540                 {
<a name="l04541"></a>04541                         <span class="comment">/* also consider constraint which is to be removed */</span>
<a name="l04542"></a>04542                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> eins = 1.0;
<a name="l04543"></a>04543                         <a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">performPlainRatioTest</a>(1, &amp;remIdx, &amp;<a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[remIdx], &amp;eins, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, sigmaUCnstr, addUCnstrIdx);
<a name="l04544"></a>04544                 }
<a name="l04545"></a>04545 
<a name="l04546"></a>04546                 <span class="comment">/* compress Ax_l */</span>
<a name="l04547"></a>04547                 <span class="keywordflow">for</span> (i = 0; i &lt; nIAC; i++)
<a name="l04548"></a>04548                 {
<a name="l04549"></a>04549                         ii = IAC_idx[i];
<a name="l04550"></a>04550                         Ax_W[i] = <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[ii];
<a name="l04551"></a>04551                 }
<a name="l04552"></a>04552                 <span class="keywordflow">for</span> (i = 0; i &lt; nIAC; i++)
<a name="l04553"></a>04553                         As[i] = -As[i];
<a name="l04554"></a>04554                 <span class="comment">/* performRatioTest( nIAC,IAC_idx,&amp;constraints, Ax_W,As, options.epsNum,options.epsDen, sigmaLCnstr,addLCnstrIdx ); */</span>
<a name="l04555"></a>04555                 sigmaLCnstr = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a4b40320e0298e2d21720541b117f5d81">maxPrimalJump</a>;
<a name="l04556"></a>04556                 addLCnstrIdx = -1;
<a name="l04557"></a>04557                 <a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">performPlainRatioTest</a>(nIAC, IAC_idx, Ax_W, As, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, sigmaLCnstr, addLCnstrIdx);
<a name="l04558"></a>04558                 <span class="keywordflow">if</span> (removeBoundNotConstraint == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> &amp;&amp; <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(remIdx) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>)
<a name="l04559"></a>04559                 {
<a name="l04560"></a>04560                         <span class="comment">/* also consider constraint which is to be removed */</span>
<a name="l04561"></a>04561                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> eins = 1.0;
<a name="l04562"></a>04562                         <a class="code" href="classQProblem.html#a1cb0fac050a8a31a2fe98289bdaca196">performPlainRatioTest</a>(1, &amp;remIdx, &amp;<a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[remIdx], &amp;eins, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, sigmaLCnstr, addLCnstrIdx);
<a name="l04563"></a>04563                 }
<a name="l04564"></a>04564 
<a name="l04565"></a>04565                 <span class="comment">/* perform primal jump */</span>
<a name="l04566"></a>04566                 sigma = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a4b40320e0298e2d21720541b117f5d81">maxPrimalJump</a>;
<a name="l04567"></a>04567                 <span class="keywordflow">if</span> (sigmaUCnstr &lt; sigma) { sigma = sigmaUCnstr; addStatus = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>; addBoundNotConstraint = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>; addIdx = addUCnstrIdx; }
<a name="l04568"></a>04568                 <span class="keywordflow">if</span> (sigmaLCnstr &lt; sigma) { sigma = sigmaLCnstr; addStatus = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>; addBoundNotConstraint = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>; addIdx = addLCnstrIdx; }
<a name="l04569"></a>04569                 <span class="keywordflow">if</span> (sigmaUBnd &lt; sigma) { sigma = sigmaUBnd; addStatus = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>; addBoundNotConstraint = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>; addIdx = addUBndIdx; }
<a name="l04570"></a>04570                 <span class="keywordflow">if</span> (sigmaLBnd &lt; sigma) { sigma = sigmaLBnd; addStatus = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>; addBoundNotConstraint = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>; addIdx = addLBndIdx; }
<a name="l04571"></a>04571 
<a name="l04572"></a>04572                 <span class="keywordflow">if</span> (sigma &gt;= <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a4b40320e0298e2d21720541b117f5d81">maxPrimalJump</a>)
<a name="l04573"></a>04573                 {
<a name="l04574"></a>04574                         <a class="code" href="classQProblemB.html#a689fdbbb9231d84e6c653da59d069963">unbounded</a> = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l04575"></a>04575                         returnvalue = <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eadfc914d50d132f250df763ba5908246e">RET_HOTSTART_STOPPED_UNBOUNDEDNESS</a>;
<a name="l04576"></a>04576                 }
<a name="l04577"></a>04577                 <span class="keywordflow">else</span>
<a name="l04578"></a>04578                 {
<a name="l04579"></a>04579                         <span class="keywordflow">for</span> (i = 0; i &lt; nFR; i++)
<a name="l04580"></a>04580                                 <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[FR_idx[i]] += sigma * delta_xFR[i];
<a name="l04581"></a>04581 
<a name="l04582"></a>04582                         <span class="keywordflow">for</span> (i = 0; i &lt; nFX; i++)
<a name="l04583"></a>04583                                 <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[FX_idx[i]] += sigma * delta_xFX[i];
<a name="l04584"></a>04584 
<a name="l04585"></a>04585                         <span class="comment">/* update Ax, Ax_u, and Ax_l */</span>
<a name="l04586"></a>04586                         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(1, 1.0, <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>, nV, 0.0, <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>, nC);
<a name="l04587"></a>04587                         <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++) <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] = <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] - <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i];
<a name="l04588"></a>04588                         <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++) <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i] - <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i];
<a name="l04589"></a>04589 
<a name="l04590"></a>04590                         <span class="comment">/* change working set later */</span>
<a name="l04591"></a>04591                         exchangeHappened = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l04592"></a>04592                 }
<a name="l04593"></a>04593 
<a name="l04594"></a>04594                 <span class="keyword">delete</span>[] Ax_W;
<a name="l04595"></a>04595                 <span class="keyword">delete</span>[] As;
<a name="l04596"></a>04596         }
<a name="l04597"></a>04597 
<a name="l04598"></a>04598         <span class="keyword">delete</span>[] delta_yFX;
<a name="l04599"></a>04599         <span class="keyword">delete</span>[] delta_yAC;
<a name="l04600"></a>04600         <span class="keyword">delete</span>[] delta_xFR;
<a name="l04601"></a>04601         <span class="keyword">delete</span>[] delta_xFX;
<a name="l04602"></a>04602 <span class="comment">//      delete[] delta_g;</span>
<a name="l04603"></a>04603 
<a name="l04604"></a>04604         <span class="keywordflow">return</span> returnvalue;
<a name="l04605"></a>04605 }
<a name="l04606"></a>04606 
<a name="l04607"></a>04607 
<a name="l04608"></a>04608 
<a name="l04609"></a>04609 <span class="comment">/*</span>
<a name="l04610"></a>04610 <span class="comment"> *      b a c k s o l v e T</span>
<a name="l04611"></a>04611 <span class="comment"> */</span>
<a name="l04612"></a><a class="code" href="classQProblem.html#a0563822d48c2b9316ceb1a3abd8ac536">04612</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a0563822d48c2b9316ceb1a3abd8ac536">QProblem::backsolveT</a>( <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> b, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> transposed, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> a )<span class="keyword"> const</span>
<a name="l04613"></a>04613 <span class="keyword"></span>{
<a name="l04614"></a>04614         <span class="keywordtype">int</span> i, j;
<a name="l04615"></a>04615         <span class="keywordtype">int</span> nT = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l04616"></a>04616         <span class="keywordtype">int</span> tcol = <a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a> - nT;
<a name="l04617"></a>04617 
<a name="l04618"></a>04618         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> sum;
<a name="l04619"></a>04619 
<a name="l04620"></a>04620         <span class="comment">/* nothing to do */</span>
<a name="l04621"></a>04621         <span class="keywordflow">if</span> ( nT &lt;= 0 )
<a name="l04622"></a>04622                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l04623"></a>04623 
<a name="l04624"></a>04624 
<a name="l04625"></a>04625         <span class="comment">/* Solve Ta = b, where T might be transposed. */</span>
<a name="l04626"></a>04626         <span class="keywordflow">if</span> ( transposed == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l04627"></a>04627         {
<a name="l04628"></a>04628                 <span class="comment">/* solve Ta = b */</span>
<a name="l04629"></a>04629                 <span class="keywordflow">for</span>( i=0; i&lt;nT; ++i )
<a name="l04630"></a>04630                 {
<a name="l04631"></a>04631                         sum = b[i];
<a name="l04632"></a>04632                         <span class="keywordflow">for</span>( j=0; j&lt;i; ++j )
<a name="l04633"></a>04633                                 sum -= <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>-1-j) * a[nT-1-j];
<a name="l04634"></a>04634 
<a name="l04635"></a>04635                         <span class="keywordflow">if</span> ( fabs( <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>-1-i) ) &gt; <a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> )
<a name="l04636"></a>04636                                 a[nT-1-i] = sum / <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(i,<a class="code" href="classQProblem.html#a9a4b7880991b697c6a4f7b28a3fc38e9">sizeT</a>-1-i);
<a name="l04637"></a>04637                         <span class="keywordflow">else</span>
<a name="l04638"></a>04638                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5e533c7f28abfed7d3e11d76f298cd9d">RET_DIV_BY_ZERO</a> );
<a name="l04639"></a>04639                 }
<a name="l04640"></a>04640         }
<a name="l04641"></a>04641         <span class="keywordflow">else</span>
<a name="l04642"></a>04642         {
<a name="l04643"></a>04643                 <span class="comment">/* solve T^T*a = b */</span>
<a name="l04644"></a>04644                 <span class="keywordflow">for</span>( i=0; i&lt;nT; ++i )
<a name="l04645"></a>04645                 {
<a name="l04646"></a>04646                         sum = b[i];
<a name="l04647"></a>04647                         <span class="keywordflow">for</span>( j=0; j&lt;i; ++j )
<a name="l04648"></a>04648                                 sum -= <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nT-1-j,tcol+i) * a[nT-1-j];
<a name="l04649"></a>04649 
<a name="l04650"></a>04650                         <span class="keywordflow">if</span> ( fabs( <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nT-1-i,tcol+i) ) &gt; <a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> )
<a name="l04651"></a>04651                                 a[nT-1-i] = sum / <a class="code" href="Types_8hpp.html#a92d9bf9531eedeecf42d4ca9e09e9293">TT</a>(nT-1-i,tcol+i);
<a name="l04652"></a>04652                         <span class="keywordflow">else</span>
<a name="l04653"></a>04653                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5e533c7f28abfed7d3e11d76f298cd9d">RET_DIV_BY_ZERO</a> );
<a name="l04654"></a>04654                 }
<a name="l04655"></a>04655         }
<a name="l04656"></a>04656 
<a name="l04657"></a>04657 
<a name="l04658"></a>04658         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l04659"></a>04659 }
<a name="l04660"></a>04660 
<a name="l04661"></a>04661 
<a name="l04662"></a>04662 <span class="comment">/*</span>
<a name="l04663"></a>04663 <span class="comment"> *      d e t e r m i n e D a t a S h i f t</span>
<a name="l04664"></a>04664 <span class="comment"> */</span>
<a name="l04665"></a><a class="code" href="classQProblem.html#aa72f6a87e8dcda0a07353d3d25eb11a1">04665</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aa72f6a87e8dcda0a07353d3d25eb11a1">QProblem::determineDataShift</a>(       <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> g_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lbA_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ubA_new,
<a name="l04666"></a>04666                                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lb_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ub_new,
<a name="l04667"></a>04667                                                                                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_g, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_lbA, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_ubA,
<a name="l04668"></a>04668                                                                                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_lb, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_ub,
<a name="l04669"></a>04669                                                                                         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a>&amp; Delta_bC_isZero, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a>&amp; Delta_bB_isZero
<a name="l04670"></a>04670                                                                                         )
<a name="l04671"></a>04671 {
<a name="l04672"></a>04672         <span class="keywordtype">int</span> i, ii;
<a name="l04673"></a>04673         <span class="keywordtype">int</span> nC  = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l04674"></a>04674         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l04675"></a>04675         
<a name="l04676"></a>04676         <span class="keywordtype">int</span>* FX_idx;
<a name="l04677"></a>04677         <span class="keywordtype">int</span>* AC_idx;
<a name="l04678"></a>04678 
<a name="l04679"></a>04679         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FX_idx );
<a name="l04680"></a>04680         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l04681"></a>04681 
<a name="l04682"></a>04682 
<a name="l04683"></a>04683 
<a name="l04684"></a>04684         <span class="comment">/* I) DETERMINE DATA SHIFT FOR BOUNDS */</span>
<a name="l04685"></a>04685         <a class="code" href="classQProblem.html#aa72f6a87e8dcda0a07353d3d25eb11a1">QProblemB::determineDataShift</a>(  g_new,lb_new,ub_new,
<a name="l04686"></a>04686                                                                         delta_g,delta_lb,delta_ub,
<a name="l04687"></a>04687                                                                         Delta_bB_isZero );
<a name="l04688"></a>04688 
<a name="l04689"></a>04689 
<a name="l04690"></a>04690         <span class="comment">/* II) DETERMINE DATA SHIFT FOR CONSTRAINTS */</span>
<a name="l04691"></a>04691         <span class="comment">/* 1) Calculate shift directions. */</span>
<a name="l04692"></a>04692         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l04693"></a>04693         {
<a name="l04694"></a>04694                 <span class="comment">/* if lower constraints&#39; bounds are to be disabled or do not exist, shift them to -infinity */</span>
<a name="l04695"></a>04695                 <span class="keywordflow">if</span> ( lbA_new != 0 )
<a name="l04696"></a>04696                         delta_lbA[i] = lbA_new[i] - <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i];
<a name="l04697"></a>04697                 <span class="keywordflow">else</span>
<a name="l04698"></a>04698                         delta_lbA[i] = -<a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> - lbA[i];
<a name="l04699"></a>04699         }
<a name="l04700"></a>04700 
<a name="l04701"></a>04701         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l04702"></a>04702         {
<a name="l04703"></a>04703                 <span class="comment">/* if upper constraints&#39; bounds are to be disabled or do not exist, shift them to infinity */</span>
<a name="l04704"></a>04704                 <span class="keywordflow">if</span> ( ubA_new != 0 )
<a name="l04705"></a>04705                         delta_ubA[i] = ubA_new[i] - <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i];
<a name="l04706"></a>04706                 <span class="keywordflow">else</span>
<a name="l04707"></a>04707                         delta_ubA[i] = <a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a> - ubA[i];
<a name="l04708"></a>04708         }
<a name="l04709"></a>04709 
<a name="l04710"></a>04710         <span class="comment">/* 2) Determine if active constraints&#39; bounds are to be shifted. */</span>
<a name="l04711"></a>04711         Delta_bC_isZero = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l04712"></a>04712 
<a name="l04713"></a>04713         <span class="keywordflow">for</span> ( i=0; i&lt;nAC; ++i )
<a name="l04714"></a>04714         {
<a name="l04715"></a>04715                 ii = AC_idx[i];
<a name="l04716"></a>04716 
<a name="l04717"></a>04717                 <span class="keywordflow">if</span> ( ( fabs( delta_lbA[ii] ) &gt; <a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> ) || ( fabs( delta_ubA[ii] ) &gt; <a class="code" href="Constants_8hpp.html#afc9ba76ddc87912abdb9b0e9029ea34e">EPS</a> ) )
<a name="l04718"></a>04718                 {
<a name="l04719"></a>04719                         Delta_bC_isZero = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l04720"></a>04720                         <span class="keywordflow">break</span>;
<a name="l04721"></a>04721                 }
<a name="l04722"></a>04722         }
<a name="l04723"></a>04723 
<a name="l04724"></a>04724         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l04725"></a>04725 }
<a name="l04726"></a>04726 
<a name="l04727"></a>04727 
<a name="l04728"></a>04728 <span class="comment">/*</span>
<a name="l04729"></a>04729 <span class="comment"> *      d e t e r m i n e S t e p D i r e c t i o n</span>
<a name="l04730"></a>04730 <span class="comment"> */</span>
<a name="l04731"></a><a class="code" href="classQProblem.html#a1b2636572bd7eeed4f23222a6a1653e1">04731</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a1b2636572bd7eeed4f23222a6a1653e1">QProblem::determineStepDirection</a>(   <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_g, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_lbA, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_ubA,
<a name="l04732"></a>04732                                                                                                 <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_lb, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_ub,
<a name="l04733"></a>04733                                                                                                 <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> Delta_bC_isZero, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> Delta_bB_isZero,
<a name="l04734"></a>04734                                                                                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_xFX, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_xFR,
<a name="l04735"></a>04735                                                                                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_yAC, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_yFX
<a name="l04736"></a>04736                                                                                                 )
<a name="l04737"></a>04737 {
<a name="l04738"></a>04738         <span class="keywordtype">int</span> i, j, ii, jj, r;
<a name="l04739"></a>04739         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l04740"></a>04740         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l04741"></a>04741         <span class="keywordtype">int</span> nFX = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>( );
<a name="l04742"></a>04742         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l04743"></a>04743         <span class="keywordtype">int</span> nZ  = <a class="code" href="classQProblem.html#a6b2b50f9dede95dfd6d440c63a0c97e5">getNZ</a>( );
<a name="l04744"></a>04744         
<a name="l04745"></a>04745         <span class="keywordtype">int</span>* FR_idx;
<a name="l04746"></a>04746         <span class="keywordtype">int</span>* FX_idx;
<a name="l04747"></a>04747         <span class="keywordtype">int</span>* AC_idx;
<a name="l04748"></a>04748 
<a name="l04749"></a>04749         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l04750"></a>04750         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FX_idx );
<a name="l04751"></a>04751         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l04752"></a>04752 
<a name="l04753"></a>04753 
<a name="l04754"></a>04754         <span class="comment">/* I) DETERMINE delta_xFX (this is exact, does not need refinement) */</span>
<a name="l04755"></a>04755         <span class="keywordflow">if</span> ( Delta_bB_isZero == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l04756"></a>04756         {
<a name="l04757"></a>04757                 <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l04758"></a>04758                 {
<a name="l04759"></a>04759                         ii = FX_idx[i];
<a name="l04760"></a>04760 
<a name="l04761"></a>04761                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( ii ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l04762"></a>04762                                 delta_xFX[i] = delta_lb[ii];
<a name="l04763"></a>04763                         <span class="keywordflow">else</span>
<a name="l04764"></a>04764                                 delta_xFX[i] = delta_ub[ii];
<a name="l04765"></a>04765                 }
<a name="l04766"></a>04766         }
<a name="l04767"></a>04767         <span class="keywordflow">else</span>
<a name="l04768"></a>04768         {
<a name="l04769"></a>04769                 <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l04770"></a>04770                         delta_xFX[i] = 0.0;
<a name="l04771"></a>04771         }
<a name="l04772"></a>04772 
<a name="l04773"></a>04773 
<a name="l04774"></a>04774         <span class="comment">/* tempA and tempB hold the residuals in gFR and bA (= lbA or ubA)</span>
<a name="l04775"></a>04775 <span class="comment">         * delta_xFR, delta_yAC hold the steps that get refined */</span>
<a name="l04776"></a>04776         <span class="keywordflow">for</span> ( i=0; i&lt;nFR; ++i )
<a name="l04777"></a>04777         {
<a name="l04778"></a>04778                 ii = FR_idx[i];
<a name="l04779"></a>04779                 <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>[i] = delta_g[ii];
<a name="l04780"></a>04780                 delta_xFR[i] = 0.0;
<a name="l04781"></a>04781         }
<a name="l04782"></a>04782         <span class="keywordflow">for</span> ( i=0; i&lt;nAC; ++i )
<a name="l04783"></a>04783                 delta_yAC[i] = 0.0;
<a name="l04784"></a>04784         <span class="keywordflow">if</span> ( Delta_bC_isZero == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l04785"></a>04785         {
<a name="l04786"></a>04786                 <span class="keywordflow">for</span> ( i=0; i&lt;nAC; ++i )
<a name="l04787"></a>04787                 {
<a name="l04788"></a>04788                         ii = AC_idx[i];
<a name="l04789"></a>04789                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( ii ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l04790"></a>04790                                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i] = delta_lbA[ii];
<a name="l04791"></a>04791                         <span class="keywordflow">else</span>
<a name="l04792"></a>04792                                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i] = delta_ubA[ii];
<a name="l04793"></a>04793                 }
<a name="l04794"></a>04794         }
<a name="l04795"></a>04795         <span class="keywordflow">else</span>
<a name="l04796"></a>04796         {
<a name="l04797"></a>04797                 <span class="keywordflow">for</span> ( i=0; i&lt;nAC; ++i )
<a name="l04798"></a>04798                         <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i] = 0.0;
<a name="l04799"></a>04799         }
<a name="l04800"></a>04800 
<a name="l04801"></a>04801         <span class="comment">/* Iterative refinement loop for delta_xFRz, delta_xFRy, delta_yAC */</span>
<a name="l04802"></a>04802         <span class="keywordflow">for</span> ( r=0; r&lt;=<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a090518bedb440a53f6b7e31f45b9b4a5">numRefinementSteps</a>; ++r )
<a name="l04803"></a>04803         {
<a name="l04804"></a>04804                 <span class="comment">/* II) DETERMINE delta_xFR */</span>
<a name="l04805"></a>04805                 <span class="keywordflow">if</span> ( nFR &gt; 0 )
<a name="l04806"></a>04806                 {
<a name="l04807"></a>04807                         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l04808"></a>04808                                 <a class="code" href="classQProblemB.html#a06e401f5f0d6f9a9ce2caa81dc5d85b6">delta_xFR_TMP</a>[i] = 0.0;
<a name="l04809"></a>04809 
<a name="l04810"></a>04810                         <span class="comment">/* 1) Determine delta_xFRy. */</span>
<a name="l04811"></a>04811                         <span class="keywordflow">if</span> ( nAC &gt; 0 )
<a name="l04812"></a>04812                         {
<a name="l04813"></a>04813                                 <span class="keywordflow">if</span> ( ( Delta_bC_isZero == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) &amp;&amp; ( Delta_bB_isZero == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) )
<a name="l04814"></a>04814                                 {
<a name="l04815"></a>04815                                         <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l04816"></a>04816                                                 <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a>[i] = 0.0;
<a name="l04817"></a>04817                                 }
<a name="l04818"></a>04818                                 <span class="keywordflow">else</span>
<a name="l04819"></a>04819                                 {
<a name="l04820"></a>04820                                         <span class="comment">/* compute bA - A * delta_xFX. tempB already holds bA-&gt;</span>
<a name="l04821"></a>04821 <span class="comment">                                         * in refinements r&gt;=1, delta_xFX is exactly zero */</span>
<a name="l04822"></a>04822                                         <span class="keywordflow">if</span> ( ( Delta_bB_isZero == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) &amp;&amp; ( r == 0 ) )
<a name="l04823"></a>04823                                                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), 1, -1.0, delta_xFX, nFX, 1.0, <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>, nAC);
<a name="l04824"></a>04824 
<a name="l04825"></a>04825                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0563822d48c2b9316ceb1a3abd8ac536">backsolveT</a>( <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l04826"></a>04826                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaf47a87065fef6a209a317624116ea210">RET_STEPDIRECTION_FAILED_TQ</a> );
<a name="l04827"></a>04827 
<a name="l04828"></a>04828                                         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l04829"></a>04829                                         {
<a name="l04830"></a>04830                                                 ii = FR_idx[i];
<a name="l04831"></a>04831                                                 <span class="keywordflow">for</span>( j=0; j&lt;nAC; ++j )
<a name="l04832"></a>04832                                                         <a class="code" href="classQProblemB.html#a06e401f5f0d6f9a9ce2caa81dc5d85b6">delta_xFR_TMP</a>[i] += <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+j) * <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a>[j];
<a name="l04833"></a>04833                                         }
<a name="l04834"></a>04834                                 }
<a name="l04835"></a>04835                         }
<a name="l04836"></a>04836 
<a name="l04837"></a>04837 
<a name="l04838"></a>04838                         <span class="comment">/* 2) Determine delta_xFRz. */</span>
<a name="l04839"></a>04839                         <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l04840"></a>04840                                 <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a>[i] = 0.0;
<a name="l04841"></a>04841 
<a name="l04842"></a>04842                         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> ) || ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> ) )
<a name="l04843"></a>04843                         {
<a name="l04844"></a>04844                                 <span class="comment">/* compute Z*delta_gFR [/eps] (delta_gFR is stored in tempA) */</span>
<a name="l04845"></a>04845                                 <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l04846"></a>04846                                 {
<a name="l04847"></a>04847                                         jj = FR_idx[j];
<a name="l04848"></a>04848                                         <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l04849"></a>04849                                                 <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a>[i] -= <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(jj,i) * <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>[j];
<a name="l04850"></a>04850                                 }
<a name="l04851"></a>04851 
<a name="l04852"></a>04852                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )
<a name="l04853"></a>04853                                 {
<a name="l04854"></a>04854                                         <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l04855"></a>04855                                                 <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a>[i] /= <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3521b2ae6a97e3f10f08ef8130ca7a49">epsRegularisation</a>;
<a name="l04856"></a>04856                                 }
<a name="l04857"></a>04857                         }
<a name="l04858"></a>04858                         <span class="keywordflow">else</span>
<a name="l04859"></a>04859                         {
<a name="l04860"></a>04860                                 <span class="comment">/* compute HMX*delta_xFX. DESTROY delta_gFR that was in tempA */</span>
<a name="l04861"></a>04861                                 <span class="keywordflow">if</span> ( ( Delta_bB_isZero == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) &amp;&amp; ( r == 0 ) )
<a name="l04862"></a>04862                                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), 1, 1.0, delta_xFX, nFX, 1.0, <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>, nFR);
<a name="l04863"></a>04863 
<a name="l04864"></a>04864                                 <span class="comment">/* compute HFR*delta_xFRy */</span>
<a name="l04865"></a>04865                                 <span class="keywordflow">if</span> ( ( nAC &gt; 0 ) &amp;&amp; ( ( Delta_bC_isZero == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) || ( Delta_bB_isZero == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) ) )
<a name="l04866"></a>04866                                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1, 1.0, <a class="code" href="classQProblemB.html#a06e401f5f0d6f9a9ce2caa81dc5d85b6">delta_xFR_TMP</a>, nFR, 1.0, <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>, nFR);
<a name="l04867"></a>04867 
<a name="l04868"></a>04868                                 <span class="comment">/* compute ZFR_delta_xFRz = (Z&#39;*HFR*Z) \ Z * (HFR*delta_xFR + HMX*delta_xFX + delta_gFR) */</span>
<a name="l04869"></a>04869                                 <span class="keywordflow">if</span> ( nZ &gt; 0 )
<a name="l04870"></a>04870                                 {
<a name="l04871"></a>04871                                         <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l04872"></a>04872                                         {
<a name="l04873"></a>04873                                                 jj = FR_idx[j];
<a name="l04874"></a>04874                                                 <span class="keywordflow">for</span>( i=0; i&lt;nZ; ++i )
<a name="l04875"></a>04875                                                         <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a>[i] -= <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(jj,i) * <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>[j];
<a name="l04876"></a>04876                                         }
<a name="l04877"></a>04877 
<a name="l04878"></a>04878                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a95838c30238aac5f614731cd33ceb48e">backsolveR</a>( <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l04879"></a>04879                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea66c9c26f584341bd30d86c0f48c5a006">RET_STEPDIRECTION_FAILED_CHOLESKY</a> );
<a name="l04880"></a>04880 
<a name="l04881"></a>04881                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a95838c30238aac5f614731cd33ceb48e">backsolveR</a>( <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>,<a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l04882"></a>04882                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea66c9c26f584341bd30d86c0f48c5a006">RET_STEPDIRECTION_FAILED_CHOLESKY</a> );
<a name="l04883"></a>04883                                 }
<a name="l04884"></a>04884                         }
<a name="l04885"></a>04885 
<a name="l04886"></a>04886                         <span class="comment">/* compute Z * ZFR_delta_xFRz */</span>
<a name="l04887"></a>04887                         <span class="keywordflow">if</span> ( nZ &gt; 0 )
<a name="l04888"></a>04888                         {
<a name="l04889"></a>04889                                 <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l04890"></a>04890                                 {
<a name="l04891"></a>04891                                         <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a>[i] = 0.0;
<a name="l04892"></a>04892 
<a name="l04893"></a>04893                                         ii = FR_idx[i];
<a name="l04894"></a>04894                                         <span class="keywordflow">for</span>( j=0; j&lt;nZ; ++j )
<a name="l04895"></a>04895                                                 <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a>[i] += <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,j) * <a class="code" href="classQProblem.html#a40b30d04725b2a901b1eed044fd371a2">delta_xFRz</a>[j];
<a name="l04896"></a>04896 
<a name="l04897"></a>04897                                         <a class="code" href="classQProblemB.html#a06e401f5f0d6f9a9ce2caa81dc5d85b6">delta_xFR_TMP</a>[i] += <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a>[i];
<a name="l04898"></a>04898                                 }
<a name="l04899"></a>04899                         }
<a name="l04900"></a>04900                 }
<a name="l04901"></a>04901 
<a name="l04902"></a>04902                 <span class="comment">/* III) DETERMINE delta_yAC */</span>
<a name="l04903"></a>04903                 <span class="keywordflow">if</span> ( nAC &gt; 0 ) <span class="comment">/* =&gt; ( nFR = nZ + nAC &gt; 0 ) */</span>
<a name="l04904"></a>04904                 {
<a name="l04905"></a>04905                         <span class="keywordflow">if</span> ( ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> ) || ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> ) )
<a name="l04906"></a>04906                         {
<a name="l04907"></a>04907                                 <span class="comment">/* if zero:     delta_yAC = (T&#39;)^-1 * ( Yfr*delta_gFR + eps*delta_xFRy ),</span>
<a name="l04908"></a>04908 <span class="comment">                                 * if identity: delta_yAC = (T&#39;)^-1 * ( Yfr*delta_gFR +     delta_xFRy )</span>
<a name="l04909"></a>04909 <span class="comment">                                 *</span>
<a name="l04910"></a>04910 <span class="comment">                                 * DESTROY residual_bA that was stored in tempB</span>
<a name="l04911"></a>04911 <span class="comment">                                 * If we come here, residual_gFR in tempA is STILL VALID</span>
<a name="l04912"></a>04912 <span class="comment">                                 */</span>
<a name="l04913"></a>04913                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> )
<a name="l04914"></a>04914                                 {
<a name="l04915"></a>04915                                         <span class="keywordflow">for</span>( j=0; j&lt;nAC; ++j )
<a name="l04916"></a>04916                                                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[j] = <a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a>[j];
<a name="l04917"></a>04917                                 }
<a name="l04918"></a>04918                                 <span class="keywordflow">else</span> <span class="comment">/* hessianType == HST_ZERO */</span>
<a name="l04919"></a>04919                                 {
<a name="l04920"></a>04920                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ad3b0413d59cf68b7ee855561082b60ef">usingRegularisation</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l04921"></a>04921                                         {
<a name="l04922"></a>04922                                                 <span class="keywordflow">for</span>( j=0; j&lt;nAC; ++j )
<a name="l04923"></a>04923                                                         <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[j] = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3521b2ae6a97e3f10f08ef8130ca7a49">epsRegularisation</a>*<a class="code" href="classQProblem.html#af88e0da3fce31851dfe3f40c565da46d">delta_xFRy</a>[j];
<a name="l04924"></a>04924                                         }
<a name="l04925"></a>04925                                         <span class="keywordflow">else</span>
<a name="l04926"></a>04926                                         {
<a name="l04927"></a>04927                                                 <span class="keywordflow">for</span>( j=0; j&lt;nAC; ++j )
<a name="l04928"></a>04928                                                         <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[j] = 0.0;
<a name="l04929"></a>04929                                         }
<a name="l04930"></a>04930                                 }
<a name="l04931"></a>04931 
<a name="l04932"></a>04932                                 <span class="keywordflow">for</span>( j=0; j&lt;nAC; ++j )
<a name="l04933"></a>04933                                 {
<a name="l04934"></a>04934                                         <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l04935"></a>04935                                         {
<a name="l04936"></a>04936                                                 ii = FR_idx[i];
<a name="l04937"></a>04937                                                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[j] += <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(ii,nZ+j) * <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>[i];
<a name="l04938"></a>04938                                         }
<a name="l04939"></a>04939                                 }
<a name="l04940"></a>04940                         }
<a name="l04941"></a>04941                         <span class="keywordflow">else</span>
<a name="l04942"></a>04942                         {
<a name="l04943"></a>04943                                 <span class="comment">/* Compute HFR * delta_xFR + HMX*delta_xFX</span>
<a name="l04944"></a>04944 <span class="comment">                                 * Here, tempA holds (HFR*delta_xFRy + HMX*delta_xFX) */</span>
<a name="l04945"></a>04945                                 <span class="keywordflow">if</span> ( nZ &gt; 0 )
<a name="l04946"></a>04946                                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1, 1.0, <a class="code" href="classQProblem.html#a70a3a688b2ac0d3f5c51ea1112ffe6e2">ZFR_delta_xFRz</a>, nFR, 1.0, <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>, nFR);
<a name="l04947"></a>04947 
<a name="l04948"></a>04948                                 <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i)
<a name="l04949"></a>04949                                 {
<a name="l04950"></a>04950                                         <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i] = 0.0;
<a name="l04951"></a>04951                                         <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l04952"></a>04952                                         {
<a name="l04953"></a>04953                                                 jj = FR_idx[j];
<a name="l04954"></a>04954                                                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i] += <a class="code" href="Types_8hpp.html#a8c3eb8c289a88e534b934306375b9b41">QQ</a>(jj,nZ+i) * <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>[j];
<a name="l04955"></a>04955                                         }
<a name="l04956"></a>04956                                 }
<a name="l04957"></a>04957                         }
<a name="l04958"></a>04958 
<a name="l04959"></a>04959                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0563822d48c2b9316ceb1a3abd8ac536">backsolveT</a>( <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l04960"></a>04960                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaf47a87065fef6a209a317624116ea210">RET_STEPDIRECTION_FAILED_TQ</a> );
<a name="l04961"></a>04961                 }
<a name="l04962"></a>04962 
<a name="l04963"></a>04963                 <span class="comment">/* refine the solution found so far */</span>
<a name="l04964"></a>04964                 <span class="keywordflow">for</span> ( i=0; i&lt;nFR; ++i )
<a name="l04965"></a>04965                         delta_xFR[i] += <a class="code" href="classQProblemB.html#a06e401f5f0d6f9a9ce2caa81dc5d85b6">delta_xFR_TMP</a>[i];
<a name="l04966"></a>04966                 <span class="keywordflow">for</span> ( i=0; i&lt;nAC; ++i )
<a name="l04967"></a>04967                         delta_yAC[i] += <a class="code" href="classQProblem.html#ae45447ddd6349c02648331e25302c08f">delta_yAC_TMP</a>[i];
<a name="l04968"></a>04968 
<a name="l04969"></a>04969                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a090518bedb440a53f6b7e31f45b9b4a5">numRefinementSteps</a> &gt; 0 )
<a name="l04970"></a>04970                 {
<a name="l04971"></a>04971                         <span class="comment">/* compute residuals in tempA and tempB, and max-norm */</span>
<a name="l04972"></a>04972                         <span class="keywordflow">for</span> ( i=0; i&lt;nFR; ++i )
<a name="l04973"></a>04973                         {
<a name="l04974"></a>04974                                 ii = FR_idx[i];
<a name="l04975"></a>04975                                 <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>[i] = delta_g[ii];
<a name="l04976"></a>04976                         }
<a name="l04977"></a>04977 
<a name="l04978"></a>04978                         <span class="keywordflow">switch</span> ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> )
<a name="l04979"></a>04979                         {
<a name="l04980"></a>04980                                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a>:
<a name="l04981"></a>04981                                         <span class="keywordflow">break</span>;
<a name="l04982"></a>04982 
<a name="l04983"></a>04983                                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a>:
<a name="l04984"></a>04984                                         <span class="keywordflow">for</span> ( i=0; i&lt;nFR; ++i )
<a name="l04985"></a>04985                                                 <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>[i] += delta_xFR[i];
<a name="l04986"></a>04986                                         <span class="keywordflow">break</span>;
<a name="l04987"></a>04987 
<a name="l04988"></a>04988                                 <span class="keywordflow">default</span>:
<a name="l04989"></a>04989                                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(),  1, 1.0, delta_xFR, nFR, 1.0, <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>, nFR);
<a name="l04990"></a>04990                                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), 1, 1.0, delta_xFX, nFX, 1.0, <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>, nFR);
<a name="l04991"></a>04991                                         <span class="keywordflow">break</span>;
<a name="l04992"></a>04992                         }
<a name="l04993"></a>04993 
<a name="l04994"></a>04994                         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aae760f106376a34dfaf0c168fa836d84">transTimes</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1, -1.0, delta_yAC, nAC, 1.0, <a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>, nFR);
<a name="l04995"></a>04995                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> rnrm = 0.0;
<a name="l04996"></a>04996                         <span class="keywordflow">for</span> ( i=0; i&lt;nFR; ++i )
<a name="l04997"></a>04997                                 <span class="keywordflow">if</span> (rnrm &lt; fabs (<a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>[i]))
<a name="l04998"></a>04998                                         rnrm = fabs (<a class="code" href="classQProblem.html#a6d03bae8b65750b03fb41f642e99ac83">tempA</a>[i]);
<a name="l04999"></a>04999 
<a name="l05000"></a>05000                         <span class="keywordflow">if</span> (!Delta_bC_isZero)
<a name="l05001"></a>05001                         {
<a name="l05002"></a>05002                                 <span class="keywordflow">for</span> ( i=0; i&lt;nAC; ++i )
<a name="l05003"></a>05003                                 {
<a name="l05004"></a>05004                                         ii = AC_idx[i];
<a name="l05005"></a>05005                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( ii ) == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l05006"></a>05006                                                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i] = delta_lbA[ii];
<a name="l05007"></a>05007                                         <span class="keywordflow">else</span>
<a name="l05008"></a>05008                                                 <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i] = delta_ubA[ii];
<a name="l05009"></a>05009                                 }
<a name="l05010"></a>05010                         }
<a name="l05011"></a>05011                         <span class="keywordflow">else</span>
<a name="l05012"></a>05012                         {
<a name="l05013"></a>05013                                 <span class="keywordflow">for</span> ( i=0; i&lt;nAC; ++i )
<a name="l05014"></a>05014                                         <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i] = 0.0;
<a name="l05015"></a>05015                         }
<a name="l05016"></a>05016                         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1, -1.0, delta_xFR, nFR, 1.0, <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>, nAC);
<a name="l05017"></a>05017                         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), 1, -1.0, delta_xFX, nFX, 1.0, <a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>, nAC);
<a name="l05018"></a>05018                         <span class="keywordflow">for</span> ( i=0; i&lt;nAC; ++i )
<a name="l05019"></a>05019                                 <span class="keywordflow">if</span> (rnrm &lt; fabs (<a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i]))
<a name="l05020"></a>05020                                         rnrm = fabs (<a class="code" href="classQProblem.html#a576bbbc7847e72d00700610fbd0d9ce5">tempB</a>[i]);
<a name="l05021"></a>05021 
<a name="l05022"></a>05022                         <span class="comment">/* early termination of residual norm small enough */</span>
<a name="l05023"></a>05023                         <span class="keywordflow">if</span> ( rnrm &lt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a8d7b0b4ab3311519b73e0c30a98e7295">epsIterRef</a> )
<a name="l05024"></a>05024                                 <span class="keywordflow">break</span>;
<a name="l05025"></a>05025                 }
<a name="l05026"></a>05026         } <span class="comment">/* end of refinement loop for delta_xFRz, delta_xFRy, delta_yAC */</span>
<a name="l05027"></a>05027 
<a name="l05028"></a>05028 
<a name="l05029"></a>05029         <span class="comment">/* IV) DETERMINE delta_yFX */</span>
<a name="l05030"></a>05030         <span class="keywordflow">if</span> ( nFX &gt; 0 )
<a name="l05031"></a>05031         {
<a name="l05032"></a>05032                 <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l05033"></a>05033                         delta_yFX[i] = delta_g[FX_idx[i]];
<a name="l05034"></a>05034 
<a name="l05035"></a>05035                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aae760f106376a34dfaf0c168fa836d84">transTimes</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), 1, -1.0, delta_yAC, nAC, 1.0, delta_yFX, nFX);
<a name="l05036"></a>05036 
<a name="l05037"></a>05037                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )
<a name="l05038"></a>05038                 {
<a name="l05039"></a>05039                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ad3b0413d59cf68b7ee855561082b60ef">usingRegularisation</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l05040"></a>05040                                 <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l05041"></a>05041                                         delta_yFX[i] += <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3521b2ae6a97e3f10f08ef8130ca7a49">epsRegularisation</a>*delta_xFX[i];
<a name="l05042"></a>05042                 }
<a name="l05043"></a>05043                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a801323f9ac1f4bd78ea51fef79d7d975">HST_IDENTITY</a> )
<a name="l05044"></a>05044                 {
<a name="l05045"></a>05045                         <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l05046"></a>05046                                 delta_yFX[i] += delta_xFX[i];
<a name="l05047"></a>05047                 }
<a name="l05048"></a>05048                 <span class="keywordflow">else</span>
<a name="l05049"></a>05049                 {
<a name="l05050"></a>05050                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>(), 1, 1.0, delta_xFR, nFR, 1.0, delta_yFX, nFX);
<a name="l05051"></a>05051                         <a class="code" href="classQProblemB.html#a10b5660ca133fee1cedbb9636cea8431">H</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>(), 1, 1.0, delta_xFX, nFX, 1.0, delta_yFX, nFX);
<a name="l05052"></a>05052                 }
<a name="l05053"></a>05053         }
<a name="l05054"></a>05054 
<a name="l05055"></a>05055         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05056"></a>05056 }
<a name="l05057"></a>05057 
<a name="l05058"></a>05058 
<a name="l05059"></a>05059 <span class="comment">/*</span>
<a name="l05060"></a>05060 <span class="comment"> *      p e r f o r m S t e p</span>
<a name="l05061"></a>05061 <span class="comment"> */</span>
<a name="l05062"></a><a class="code" href="classQProblem.html#ab5540a5ac739561b704c815116f1dc7d">05062</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#ab5540a5ac739561b704c815116f1dc7d">QProblem::performStep</a>(      <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_g,
<a name="l05063"></a>05063                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_lbA, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_ubA,
<a name="l05064"></a>05064                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_lb, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_ub,
<a name="l05065"></a>05065                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_xFX, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_xFR,
<a name="l05066"></a>05066                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_yAC, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> delta_yFX,
<a name="l05067"></a>05067                                                                         <span class="keywordtype">int</span>&amp; BC_idx, <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a>&amp; BC_status, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a>&amp; BC_isBound
<a name="l05068"></a>05068                                                                         )
<a name="l05069"></a>05069 {
<a name="l05070"></a>05070         <span class="keywordtype">int</span> i, j, ii, jj;
<a name="l05071"></a>05071         <span class="keywordtype">int</span> nV  = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l05072"></a>05072         <span class="keywordtype">int</span> nC  = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l05073"></a>05073         <span class="keywordtype">int</span> nFR = <a class="code" href="classQProblemB.html#af7bd05a4562b10f6abda736cfed019d2">getNFR</a>( );
<a name="l05074"></a>05074         <span class="keywordtype">int</span> nFX = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>( );
<a name="l05075"></a>05075         <span class="keywordtype">int</span> nAC = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( );
<a name="l05076"></a>05076         <span class="keywordtype">int</span> nIAC = <a class="code" href="classQProblem.html#a98e1d71a037c6b4a47cc6b38a4737296">getNIAC</a>( );
<a name="l05077"></a>05077         
<a name="l05078"></a>05078         <span class="keywordtype">int</span>* FR_idx;
<a name="l05079"></a>05079         <span class="keywordtype">int</span>* FX_idx;
<a name="l05080"></a>05080         <span class="keywordtype">int</span>* AC_idx;
<a name="l05081"></a>05081         <span class="keywordtype">int</span>* IAC_idx;
<a name="l05082"></a>05082 
<a name="l05083"></a>05083         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#aa015d4fafc119776f4274c51a0e60a08">getFree</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FR_idx );
<a name="l05084"></a>05084         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FX_idx );
<a name="l05085"></a>05085         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l05086"></a>05086         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#ab4d19324b973e26a90f1a406b2dcfc1d">getInactive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;IAC_idx );
<a name="l05087"></a>05087 
<a name="l05088"></a>05088 
<a name="l05089"></a>05089         <span class="comment">/* initialise maximum steplength array */</span>
<a name="l05090"></a>05090         <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a> = 1.0;
<a name="l05091"></a>05091         BC_idx = -1;
<a name="l05092"></a>05092         BC_status = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a>;
<a name="l05093"></a>05093 
<a name="l05094"></a>05094         <span class="keywordtype">int</span> BC_idx_tmp = -1;
<a name="l05095"></a>05095 
<a name="l05096"></a>05096         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* num = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[ <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a>( nV,nC ) ];
<a name="l05097"></a>05097         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* den = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[ <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a>( nV,nC ) ];
<a name="l05098"></a>05098 
<a name="l05099"></a>05099         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_Ax_l = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l05100"></a>05100         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_Ax_u = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l05101"></a>05101         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_Ax   = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC];
<a name="l05102"></a>05102 
<a name="l05103"></a>05103         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* delta_x = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nV];
<a name="l05104"></a>05104         <span class="keywordflow">for</span>( j=0; j&lt;nFR; ++j )
<a name="l05105"></a>05105         {
<a name="l05106"></a>05106                 jj = FR_idx[j];
<a name="l05107"></a>05107                 delta_x[jj] = delta_xFR[j];
<a name="l05108"></a>05108         }
<a name="l05109"></a>05109         <span class="keywordflow">for</span>( j=0; j&lt;nFX; ++j )
<a name="l05110"></a>05110         {
<a name="l05111"></a>05111                 jj = FX_idx[j];
<a name="l05112"></a>05112                 delta_x[jj] = delta_xFX[j];
<a name="l05113"></a>05113         }
<a name="l05114"></a>05114 
<a name="l05115"></a>05115 
<a name="l05116"></a>05116         <span class="comment">/* I) DETERMINE MAXIMUM DUAL STEPLENGTH: */</span>
<a name="l05117"></a>05117         <span class="comment">/* 1) Ensure that active dual constraints&#39; bounds remain valid</span>
<a name="l05118"></a>05118 <span class="comment">         *    (ignoring inequality constraints).  */</span>
<a name="l05119"></a>05119         <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l05120"></a>05120         {
<a name="l05121"></a>05121                 ii = AC_idx[i];
<a name="l05122"></a>05122 
<a name="l05123"></a>05123                 num[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+ii];
<a name="l05124"></a>05124                 den[i] = -delta_yAC[i];
<a name="l05125"></a>05125         }
<a name="l05126"></a>05126 
<a name="l05127"></a>05127         <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a>( nAC,AC_idx,&amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>, num,den, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>,BC_idx_tmp );
<a name="l05128"></a>05128 
<a name="l05129"></a>05129         <span class="keywordflow">if</span> ( BC_idx_tmp &gt;= 0 )
<a name="l05130"></a>05130         {
<a name="l05131"></a>05131                 BC_idx = BC_idx_tmp;
<a name="l05132"></a>05132                 BC_status = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>;
<a name="l05133"></a>05133                 BC_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l05134"></a>05134         }
<a name="l05135"></a>05135 
<a name="l05136"></a>05136 
<a name="l05137"></a>05137         <span class="comment">/* 2) Ensure that active dual bounds remain valid</span>
<a name="l05138"></a>05138 <span class="comment">         *    (ignoring implicitly fixed variables). */</span>
<a name="l05139"></a>05139         <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l05140"></a>05140         {
<a name="l05141"></a>05141                 ii = FX_idx[i];
<a name="l05142"></a>05142                 num[i] = <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[ii];
<a name="l05143"></a>05143                 den[i] = -delta_yFX[i];
<a name="l05144"></a>05144         }
<a name="l05145"></a>05145 
<a name="l05146"></a>05146         <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a>( nFX,FX_idx,&amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>, num,den, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>,BC_idx_tmp );
<a name="l05147"></a>05147 
<a name="l05148"></a>05148         <span class="keywordflow">if</span> ( BC_idx_tmp &gt;= 0 )
<a name="l05149"></a>05149         {
<a name="l05150"></a>05150                 BC_idx = BC_idx_tmp;
<a name="l05151"></a>05151                 BC_status = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>;
<a name="l05152"></a>05152                 BC_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l05153"></a>05153         }
<a name="l05154"></a>05154 
<a name="l05155"></a>05155 
<a name="l05156"></a>05156         <span class="comment">/* II) DeETERMINE MAXIMUM PRIMAL STEPLENGTH */</span>
<a name="l05157"></a>05157         <span class="comment">/* 1) Ensure that inactive constraints&#39; bounds remain valid</span>
<a name="l05158"></a>05158 <span class="comment">         *    (ignoring unbounded constraints). */</span>
<a name="l05159"></a>05159 
<a name="l05160"></a>05160 <span class="preprocessor">        #ifdef __MANY_CONSTRAINTS__</span>
<a name="l05161"></a>05161 <span class="preprocessor"></span>        <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> delta_x_max = 0.0;
<a name="l05162"></a>05162         <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l05163"></a>05163         {
<a name="l05164"></a>05164                 <span class="keywordflow">if</span> ( fabs( delta_x[i] ) &gt; delta_x_max )
<a name="l05165"></a>05165                         delta_x_max = fabs( delta_x[i] );
<a name="l05166"></a>05166         }
<a name="l05167"></a>05167 
<a name="l05168"></a>05168         <span class="keywordflow">for</span>( i=0; i&lt;nIAC; ++i )
<a name="l05169"></a>05169         {
<a name="l05170"></a>05170                 ii = IAC_idx[i];
<a name="l05171"></a>05171 
<a name="l05172"></a>05172                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( ii ) != <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a> )
<a name="l05173"></a>05173                 {
<a name="l05174"></a>05174                         delta_Ax_l[ii] = -delta_x_max;
<a name="l05175"></a>05175                         <span class="keywordflow">if</span> ( delta_lbA[ii] &gt; 0.0 )
<a name="l05176"></a>05176                                 delta_Ax_l[ii] -= delta_lbA[ii];
<a name="l05177"></a>05177 
<a name="l05178"></a>05178                         delta_Ax_u[ii] = -delta_x_max;
<a name="l05179"></a>05179                         <span class="keywordflow">if</span> ( delta_ubA[ii] &gt; 0.0 )
<a name="l05180"></a>05180                                 delta_Ax_u[ii] -= delta_ubA[ii];
<a name="l05181"></a>05181 
<a name="l05182"></a>05182                         <span class="keywordflow">if</span> ( ( -delta_Ax_l[ii] &gt;= <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[ii] ) || ( -delta_Ax_u[ii] &gt;= <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[ii] ) )
<a name="l05183"></a>05183                         {
<a name="l05184"></a>05184                                 <span class="comment">/* calculate products A*x and A*deltaX */</span>
<a name="l05185"></a>05185                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a> == 0 )
<a name="l05186"></a>05186                                 {
<a name="l05187"></a>05187                                         <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[ii] = 0.0;
<a name="l05188"></a>05188                                         delta_Ax[ii] = 0.0;
<a name="l05189"></a>05189                                         <span class="keywordflow">for</span>( j=0; j&lt;nV; ++j )
<a name="l05190"></a>05190                                         {
<a name="l05191"></a>05191                                                 <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[ii] += AA(ii,j) * <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[j]; <span class="comment">/* Andreas: Do not touch many constraints case yet */</span>
<a name="l05192"></a>05192                                                 delta_Ax[ii] += AA(ii,j) * delta_x[j];
<a name="l05193"></a>05193                                         }
<a name="l05194"></a>05194                                 }
<a name="l05195"></a>05195                                 <span class="keywordflow">else</span>
<a name="l05196"></a>05196                                 {
<a name="l05197"></a>05197                                         <span class="keywordflow">if</span> ( (*<a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a>)( ii,<a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>, &amp;(<a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[ii]) ) != 0 )
<a name="l05198"></a>05198                                         {
<a name="l05199"></a>05199                                                 <span class="keyword">delete</span>[] den; <span class="keyword">delete</span>[] num;
<a name="l05200"></a>05200                                                 <span class="keyword">delete</span>[] delta_Ax; <span class="keyword">delete</span>[] delta_Ax_u; <span class="keyword">delete</span>[] delta_Ax; <span class="keyword">delete</span>[] delta_x;
<a name="l05201"></a>05201                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea698539f14e8cb2874a3862519e67f93c">RET_ERROR_IN_CONSTRAINTPRODUCT</a> );
<a name="l05202"></a>05202                                         }
<a name="l05203"></a>05203 
<a name="l05204"></a>05204                                         <span class="keywordflow">if</span> ( (*<a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a>)( ii,delta_x, &amp;(delta_Ax[ii]) ) != 0 )
<a name="l05205"></a>05205                                         {
<a name="l05206"></a>05206                                                 <span class="keyword">delete</span>[] den; <span class="keyword">delete</span>[] num;
<a name="l05207"></a>05207                                                 <span class="keyword">delete</span>[] delta_Ax; <span class="keyword">delete</span>[] delta_Ax_u; <span class="keyword">delete</span>[] delta_Ax_l; <span class="keyword">delete</span>[] delta_x;
<a name="l05208"></a>05208                                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea698539f14e8cb2874a3862519e67f93c">RET_ERROR_IN_CONSTRAINTPRODUCT</a> );
<a name="l05209"></a>05209                                         }
<a name="l05210"></a>05210                                 }
<a name="l05211"></a>05211 
<a name="l05212"></a>05212                                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[ii] = <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[ii] - <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[ii];
<a name="l05213"></a>05213                                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[ii] = Ax[ii] - <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[ii];
<a name="l05214"></a>05214 
<a name="l05215"></a>05215                                 <span class="comment">/* inactive lower constraints&#39; bounds */</span>
<a name="l05216"></a>05216                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#af4b7739129483c2d7e67048f5f5ed54b">hasNoLower</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l05217"></a>05217                                 {
<a name="l05218"></a>05218                                         num[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a>( <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[ii],0.0 );
<a name="l05219"></a>05219                                         den[i] = delta_lbA[ii] - delta_Ax[ii];
<a name="l05220"></a>05220 
<a name="l05221"></a>05221                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a1586927949ceff7c43b8063f81887c0b">isBlocking</a>( ii,num[i],den[i], <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a> ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l05222"></a>05222                                         {
<a name="l05223"></a>05223                                                 <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a> = num[i]/den[i];
<a name="l05224"></a>05224                                                 BC_idx = ii;
<a name="l05225"></a>05225                                                 BC_status = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>;
<a name="l05226"></a>05226                                                 BC_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l05227"></a>05227                                         }
<a name="l05228"></a>05228                                 }
<a name="l05229"></a>05229                                 delta_Ax_l[ii] = delta_Ax[ii] - delta_lbA[ii];
<a name="l05230"></a>05230 
<a name="l05231"></a>05231                                 <span class="comment">/* inactive upper constraints&#39; bounds */</span>
<a name="l05232"></a>05232                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a53058aa23ff9f956de32494ae2d3eab2">hasNoUpper</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l05233"></a>05233                                 {
<a name="l05234"></a>05234                                         num[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a>( <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[ii],0.0 );
<a name="l05235"></a>05235                                         den[i] = delta_Ax[ii] - delta_ubA[ii];
<a name="l05236"></a>05236 
<a name="l05237"></a>05237                                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a1586927949ceff7c43b8063f81887c0b">isBlocking</a>( ii,num[i],den[i], <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a> ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l05238"></a>05238                                         {
<a name="l05239"></a>05239                                                 <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a> = num[i]/den[i];
<a name="l05240"></a>05240                                                 BC_status = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>;
<a name="l05241"></a>05241                                                 BC_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l05242"></a>05242                                         }
<a name="l05243"></a>05243                                 }
<a name="l05244"></a>05244                                 delta_Ax_u[ii] = delta_ubA[ii] - delta_Ax[ii];
<a name="l05245"></a>05245                         }
<a name="l05246"></a>05246                 }
<a name="l05247"></a>05247         }
<a name="l05248"></a>05248 <span class="preprocessor">        #else </span><span class="comment">/* NOT __MANY_CONSTRAINTS__ */</span>
<a name="l05249"></a>05249         <span class="comment">/* calculate product A*x */</span>
<a name="l05250"></a>05250         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a> == 0 )
<a name="l05251"></a>05251         {
<a name="l05252"></a>05252                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#ab4d19324b973e26a90f1a406b2dcfc1d">getInactive</a>(), 0, 1, 1.0, delta_x, nV, 0.0, delta_Ax, nC, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>);
<a name="l05253"></a>05253         }
<a name="l05254"></a>05254         <span class="keywordflow">else</span>
<a name="l05255"></a>05255         {
<a name="l05256"></a>05256                 <span class="keywordflow">for</span>( i=0; i&lt;nIAC; ++i )
<a name="l05257"></a>05257                 {
<a name="l05258"></a>05258                         ii = IAC_idx[i];
<a name="l05259"></a>05259 
<a name="l05260"></a>05260                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( ii ) != <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a> )
<a name="l05261"></a>05261                         {
<a name="l05262"></a>05262                                 <span class="keywordflow">if</span> ( (*<a class="code" href="classQProblem.html#abea467ddb7e5129e3b48878e00d03689">constraintProduct</a>)( ii,delta_x, &amp;(delta_Ax[ii]) ) != 0 )
<a name="l05263"></a>05263                                 {
<a name="l05264"></a>05264                                         <span class="keyword">delete</span>[] den; <span class="keyword">delete</span>[] num;
<a name="l05265"></a>05265                                         <span class="keyword">delete</span>[] delta_Ax; <span class="keyword">delete</span>[] delta_Ax_u; <span class="keyword">delete</span>[] delta_Ax_l; <span class="keyword">delete</span>[] delta_x;
<a name="l05266"></a>05266                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea698539f14e8cb2874a3862519e67f93c">RET_ERROR_IN_CONSTRAINTPRODUCT</a> );
<a name="l05267"></a>05267                                 }
<a name="l05268"></a>05268                         }
<a name="l05269"></a>05269                 }
<a name="l05270"></a>05270         }
<a name="l05271"></a>05271 
<a name="l05272"></a>05272         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#af4b7739129483c2d7e67048f5f5ed54b">hasNoLower</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l05273"></a>05273         {
<a name="l05274"></a>05274                 <span class="keywordflow">for</span>( i=0; i&lt;nIAC; ++i )
<a name="l05275"></a>05275                 {
<a name="l05276"></a>05276                         ii = IAC_idx[i];
<a name="l05277"></a>05277                         num[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a>( <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[ii],0.0 );
<a name="l05278"></a>05278                         den[i] = delta_lbA[ii] - delta_Ax[ii];
<a name="l05279"></a>05279                 }
<a name="l05280"></a>05280 
<a name="l05281"></a>05281                 <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a>( nIAC,IAC_idx,&amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>, num,den, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>,BC_idx_tmp );
<a name="l05282"></a>05282 
<a name="l05283"></a>05283                 <span class="keywordflow">if</span> ( BC_idx_tmp &gt;= 0 )
<a name="l05284"></a>05284                 {
<a name="l05285"></a>05285                         BC_idx = BC_idx_tmp;
<a name="l05286"></a>05286                         BC_status = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>;
<a name="l05287"></a>05287                         BC_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l05288"></a>05288                 }
<a name="l05289"></a>05289         }
<a name="l05290"></a>05290 
<a name="l05291"></a>05291         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a53058aa23ff9f956de32494ae2d3eab2">hasNoUpper</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l05292"></a>05292         {
<a name="l05293"></a>05293                 <span class="keywordflow">for</span>( i=0; i&lt;nIAC; ++i )
<a name="l05294"></a>05294                 {
<a name="l05295"></a>05295                         ii = IAC_idx[i];
<a name="l05296"></a>05296                         num[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a>( <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[ii],0.0 );
<a name="l05297"></a>05297                         den[i] = delta_Ax[ii] - delta_ubA[ii];
<a name="l05298"></a>05298                 }
<a name="l05299"></a>05299 
<a name="l05300"></a>05300                 <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a>( nIAC,IAC_idx,&amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>, num,den, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>,BC_idx_tmp );
<a name="l05301"></a>05301 
<a name="l05302"></a>05302                 <span class="keywordflow">if</span> ( BC_idx_tmp &gt;= 0 )
<a name="l05303"></a>05303                 {
<a name="l05304"></a>05304                         BC_idx = BC_idx_tmp;
<a name="l05305"></a>05305                         BC_status = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>;
<a name="l05306"></a>05306                         BC_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l05307"></a>05307                 }
<a name="l05308"></a>05308         }
<a name="l05309"></a>05309 
<a name="l05310"></a>05310 
<a name="l05311"></a>05311         <span class="keywordflow">for</span>( i=0; i&lt;nIAC; ++i )
<a name="l05312"></a>05312         {
<a name="l05313"></a>05313                 ii = IAC_idx[i];
<a name="l05314"></a>05314 
<a name="l05315"></a>05315                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( ii ) != <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a> )
<a name="l05316"></a>05316                 {
<a name="l05317"></a>05317                         delta_Ax_l[ii] = delta_Ax[ii] - delta_lbA[ii];
<a name="l05318"></a>05318                         delta_Ax_u[ii] = delta_ubA[ii] - delta_Ax[ii];
<a name="l05319"></a>05319                 }
<a name="l05320"></a>05320         }
<a name="l05321"></a>05321 <span class="preprocessor">        #endif </span><span class="comment">/* __MANY_CONSTRAINTS__ */</span>
<a name="l05322"></a>05322 
<a name="l05323"></a>05323 
<a name="l05324"></a>05324         <span class="comment">/* 2) Ensure that inactive bounds remain valid</span>
<a name="l05325"></a>05325 <span class="comment">         *    (ignoring unbounded variables). */</span>
<a name="l05326"></a>05326         <span class="comment">/* inactive lower bounds */</span>
<a name="l05327"></a>05327         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#af4b7739129483c2d7e67048f5f5ed54b">hasNoLower</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l05328"></a>05328         {
<a name="l05329"></a>05329                 <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l05330"></a>05330                 {
<a name="l05331"></a>05331                         ii = FR_idx[i];
<a name="l05332"></a>05332                         num[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a>( <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[ii] - <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[ii],0.0 );
<a name="l05333"></a>05333                         den[i] = delta_lb[ii] - delta_xFR[i];
<a name="l05334"></a>05334                 }
<a name="l05335"></a>05335 
<a name="l05336"></a>05336                 <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a>( nFR,FR_idx,&amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>, num,den, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>,BC_idx_tmp );
<a name="l05337"></a>05337 
<a name="l05338"></a>05338                 <span class="keywordflow">if</span> ( BC_idx_tmp &gt;= 0 )
<a name="l05339"></a>05339                 {
<a name="l05340"></a>05340                         BC_idx = BC_idx_tmp;
<a name="l05341"></a>05341                         BC_status = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>;
<a name="l05342"></a>05342                         BC_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l05343"></a>05343                 }
<a name="l05344"></a>05344         }
<a name="l05345"></a>05345 
<a name="l05346"></a>05346         <span class="comment">/* inactive upper bounds */</span>
<a name="l05347"></a>05347         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a53058aa23ff9f956de32494ae2d3eab2">hasNoUpper</a>( ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> )
<a name="l05348"></a>05348         {
<a name="l05349"></a>05349                 <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l05350"></a>05350                 {
<a name="l05351"></a>05351                         ii = FR_idx[i];
<a name="l05352"></a>05352                         num[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a>( <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[ii] - <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[ii],0.0 );
<a name="l05353"></a>05353                         den[i] = delta_xFR[i] - delta_ub[ii];
<a name="l05354"></a>05354                 }
<a name="l05355"></a>05355 
<a name="l05356"></a>05356                 <a class="code" href="classQProblemB.html#afe150f11de090a35ae1bdcc9a00761b6">performRatioTest</a>( nFR,FR_idx,&amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>, num,den, <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#af655ae1250e2c425b278644163cd3a61">epsNum</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>, <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>,BC_idx_tmp );
<a name="l05357"></a>05357 
<a name="l05358"></a>05358                 <span class="keywordflow">if</span> ( BC_idx_tmp &gt;= 0 )
<a name="l05359"></a>05359                 {
<a name="l05360"></a>05360                         BC_idx = BC_idx_tmp;
<a name="l05361"></a>05361                         BC_status = <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>;
<a name="l05362"></a>05362                         BC_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l05363"></a>05363                 }
<a name="l05364"></a>05364         }
<a name="l05365"></a>05365 
<a name="l05366"></a>05366         <span class="keyword">delete</span>[] den;
<a name="l05367"></a>05367         <span class="keyword">delete</span>[] num;
<a name="l05368"></a>05368         <span class="keyword">delete</span>[] delta_x;
<a name="l05369"></a>05369 
<a name="l05370"></a>05370 
<a name="l05371"></a>05371 <span class="preprocessor">        #ifndef __XPCTARGET__</span>
<a name="l05372"></a>05372 <span class="preprocessor"></span>        <span class="keywordtype">char</span> messageString[80];
<a name="l05373"></a>05373 
<a name="l05374"></a>05374         <span class="keywordflow">if</span> ( BC_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> )
<a name="l05375"></a>05375                 snprintf( messageString,80,<span class="stringliteral">&quot;Stepsize is %.16e!&quot;</span>,<a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a> );
<a name="l05376"></a>05376         <span class="keywordflow">else</span>
<a name="l05377"></a>05377                 snprintf( messageString,80,<span class="stringliteral">&quot;Stepsize is %.16e! (BC_idx = %d, BC_isBound = %d, BC_status = %d)&quot;</span>,<a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>,BC_idx,BC_isBound,BC_status );
<a name="l05378"></a>05378 
<a name="l05379"></a>05379         <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eae69f81d8a36bcb7389dbea1da59f84a1">RET_STEPSIZE_NONPOSITIVE</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l05380"></a>05380 <span class="preprocessor">        #endif</span>
<a name="l05381"></a>05381 <span class="preprocessor"></span>
<a name="l05382"></a>05382 
<a name="l05383"></a>05383         <span class="comment">/* III) PERFORM STEP ALONG HOMOTOPY PATH */</span>
<a name="l05384"></a>05384         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a> &gt; <a class="code" href="Constants_8hpp.html#ad819f2d51fdea4cd4ff6023e9e276e11">ZERO</a> )
<a name="l05385"></a>05385         {
<a name="l05386"></a>05386                 <span class="comment">/* 1) Perform step in primal und dual space... */</span>
<a name="l05387"></a>05387                 <span class="keywordflow">for</span>( i=0; i&lt;nFR; ++i )
<a name="l05388"></a>05388                 {
<a name="l05389"></a>05389                         ii = FR_idx[i];
<a name="l05390"></a>05390                         <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[ii] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_xFR[i];
<a name="l05391"></a>05391                 }
<a name="l05392"></a>05392 
<a name="l05393"></a>05393                 <span class="keywordflow">for</span>( i=0; i&lt;nFX; ++i )
<a name="l05394"></a>05394                 {
<a name="l05395"></a>05395                         ii = FX_idx[i];
<a name="l05396"></a>05396                         <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[ii] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_xFX[i];
<a name="l05397"></a>05397                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[ii] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_yFX[i];
<a name="l05398"></a>05398                 }
<a name="l05399"></a>05399 
<a name="l05400"></a>05400                 <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l05401"></a>05401                 {
<a name="l05402"></a>05402                         ii = AC_idx[i];
<a name="l05403"></a>05403                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+ii] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_yAC[i];
<a name="l05404"></a>05404                 }
<a name="l05405"></a>05405 
<a name="l05406"></a>05406                 <span class="comment">/* 2) Shift QP data. */</span>
<a name="l05407"></a>05407                 <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l05408"></a>05408                 {
<a name="l05409"></a>05409                         <a class="code" href="classQProblemB.html#a3efcc81e7338d5d41c99e58a766315ba">g</a>[i]  += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_g[i];
<a name="l05410"></a>05410                         <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_lb[i];
<a name="l05411"></a>05411                         <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_ub[i];
<a name="l05412"></a>05412                 }
<a name="l05413"></a>05413 
<a name="l05414"></a>05414                 <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l05415"></a>05415                 {
<a name="l05416"></a>05416                         <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_lbA[i];
<a name="l05417"></a>05417                         <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_ubA[i];
<a name="l05418"></a>05418                 }
<a name="l05419"></a>05419 
<a name="l05420"></a>05420                 <span class="comment">/* recompute Ax. */</span>
<a name="l05421"></a>05421                 <span class="comment">/*A-&gt;times(1, 1.0, x, nV, 0.0, Ax, nC);</span>
<a name="l05422"></a>05422 <span class="comment">                for( i=0; i&lt;nC; ++i )</span>
<a name="l05423"></a>05423 <span class="comment">                {</span>
<a name="l05424"></a>05424 <span class="comment">                        Ax_u[i] = ubA[i] - Ax[i];</span>
<a name="l05425"></a>05425 <span class="comment">                        Ax_l[i] = Ax[i] - lbA[i];</span>
<a name="l05426"></a>05426 <span class="comment">                }*/</span>
<a name="l05427"></a>05427 
<a name="l05428"></a>05428                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>(),0, 1, 1.0, <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>, nV, 0.0, <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>, nC, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> );
<a name="l05429"></a>05429                 <span class="keywordflow">for</span>( i=0; i&lt;nAC; ++i )
<a name="l05430"></a>05430                 {
<a name="l05431"></a>05431                         ii = AC_idx[i];
<a name="l05432"></a>05432                         <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[ii] = <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[ii] - <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[ii];
<a name="l05433"></a>05433                         <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[ii] = Ax[ii] - <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[ii];
<a name="l05434"></a>05434                 }
<a name="l05435"></a>05435                 <span class="keywordflow">for</span>( i=0; i&lt;nIAC; ++i )
<a name="l05436"></a>05436                 {
<a name="l05437"></a>05437                         ii = IAC_idx[i];
<a name="l05438"></a>05438                         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>( ii ) != <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a> )
<a name="l05439"></a>05439                         {
<a name="l05440"></a>05440                                 <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[ii]   += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_Ax[ii];
<a name="l05441"></a>05441                                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[ii] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_Ax_l[ii];
<a name="l05442"></a>05442                                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[ii] += <a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>*delta_Ax_u[ii];
<a name="l05443"></a>05443                         }
<a name="l05444"></a>05444                 }
<a name="l05445"></a>05445         }
<a name="l05446"></a>05446         <span class="keywordflow">else</span>
<a name="l05447"></a>05447         {
<a name="l05448"></a>05448                 <span class="comment">/* print a stepsize warning if stepsize is zero */</span>
<a name="l05449"></a>05449 <span class="preprocessor">                #ifndef __XPCTARGET__</span>
<a name="l05450"></a>05450 <span class="preprocessor"></span>                snprintf( messageString,80,<span class="stringliteral">&quot;Stepsize is %.16e&quot;</span>,<a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a> );
<a name="l05451"></a>05451                 <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a20916177fb0e5a55e1cc74df22e53795">throwWarning</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea6e31912b4cbd2f653ff795896707fd41">RET_STEPSIZE</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l05452"></a>05452 <span class="preprocessor">                #endif</span>
<a name="l05453"></a>05453 <span class="preprocessor"></span>        }
<a name="l05454"></a>05454 
<a name="l05455"></a>05455         <span class="keyword">delete</span>[] delta_Ax; <span class="keyword">delete</span>[] delta_Ax_u; <span class="keyword">delete</span>[] delta_Ax_l;
<a name="l05456"></a>05456 
<a name="l05457"></a>05457         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05458"></a>05458 }
<a name="l05459"></a>05459 
<a name="l05460"></a>05460 
<a name="l05461"></a>05461 <span class="comment">/*</span>
<a name="l05462"></a>05462 <span class="comment"> *      c h a n g e A c t i v e S e t</span>
<a name="l05463"></a>05463 <span class="comment"> */</span>
<a name="l05464"></a><a class="code" href="classQProblem.html#a87b0484bebb552796bcfcfd14a87136a">05464</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a87b0484bebb552796bcfcfd14a87136a">QProblem::changeActiveSet</a>( <span class="keywordtype">int</span> BC_idx, <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> BC_status, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> BC_isBound )
<a name="l05465"></a>05465 {
<a name="l05466"></a>05466         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l05467"></a>05467 
<a name="l05468"></a>05468         <span class="keywordtype">char</span> messageString[80];
<a name="l05469"></a>05469 
<a name="l05470"></a>05470         <span class="keywordflow">switch</span> ( BC_status )
<a name="l05471"></a>05471         {
<a name="l05472"></a>05472                 <span class="comment">/* Optimal solution found as no working set change detected. */</span>
<a name="l05473"></a>05473                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a>:
<a name="l05474"></a>05474                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05475"></a>05475 
<a name="l05476"></a>05476                 <span class="comment">/* Remove one variable from active set. */</span>
<a name="l05477"></a>05477                 <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>:
<a name="l05478"></a>05478                         <span class="keywordflow">if</span> ( BC_isBound == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l05479"></a>05479                         {
<a name="l05480"></a>05480 <span class="preprocessor">                                #ifndef __XPCTARGET__</span>
<a name="l05481"></a>05481 <span class="preprocessor"></span>                                snprintf( messageString,80,<span class="stringliteral">&quot;bound no. %d.&quot;</span>, BC_idx );
<a name="l05482"></a>05482                                 <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0f461fcae9d87e4b1334401a3be6eb46">RET_REMOVE_FROM_ACTIVESET</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l05483"></a>05483 <span class="preprocessor">                                #endif</span>
<a name="l05484"></a>05484 <span class="preprocessor"></span>
<a name="l05485"></a>05485                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a12931eb86b975a1e3b0537c94c30a290">removeBound</a>( BC_idx,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aeec0473a768989b1a2f587f51709636a">enableNZCTests</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05486"></a>05486                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaddb537678cb9d40290ba4e0ef5514a37">RET_REMOVE_FROM_ACTIVESET_FAILED</a> );
<a name="l05487"></a>05487 
<a name="l05488"></a>05488                                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[BC_idx] = 0.0;
<a name="l05489"></a>05489                         }
<a name="l05490"></a>05490                         <span class="keywordflow">else</span>
<a name="l05491"></a>05491                         {
<a name="l05492"></a>05492 <span class="preprocessor">                                #ifndef __XPCTARGET__</span>
<a name="l05493"></a>05493 <span class="preprocessor"></span>                                snprintf( messageString,80,<span class="stringliteral">&quot;constraint no. %d.&quot;</span>, BC_idx );
<a name="l05494"></a>05494                                 <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0f461fcae9d87e4b1334401a3be6eb46">RET_REMOVE_FROM_ACTIVESET</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l05495"></a>05495 <span class="preprocessor">                                #endif</span>
<a name="l05496"></a>05496 <span class="preprocessor"></span>
<a name="l05497"></a>05497                                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a140f91786436fd1069e932733eba5abd">removeConstraint</a>( BC_idx,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>,<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aeec0473a768989b1a2f587f51709636a">enableNZCTests</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05498"></a>05498                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaddb537678cb9d40290ba4e0ef5514a37">RET_REMOVE_FROM_ACTIVESET_FAILED</a> );
<a name="l05499"></a>05499 
<a name="l05500"></a>05500                                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+BC_idx] = 0.0;
<a name="l05501"></a>05501                         }
<a name="l05502"></a>05502                         <span class="keywordflow">break</span>;
<a name="l05503"></a>05503 
<a name="l05504"></a>05504 
<a name="l05505"></a>05505                 <span class="comment">/* Add one variable to active set. */</span>
<a name="l05506"></a>05506                 <span class="keywordflow">default</span>:
<a name="l05507"></a>05507                         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue;
<a name="l05508"></a>05508                         <span class="keywordflow">if</span> ( BC_isBound == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l05509"></a>05509                         {
<a name="l05510"></a>05510 <span class="preprocessor">                                #ifndef __XPCTARGET__</span>
<a name="l05511"></a>05511 <span class="preprocessor"></span>                                <span class="keywordflow">if</span> ( BC_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l05512"></a>05512                                         snprintf( messageString,80,<span class="stringliteral">&quot;lower bound no. %d.&quot;</span>, BC_idx );
<a name="l05513"></a>05513                                 <span class="keywordflow">else</span>
<a name="l05514"></a>05514                                         snprintf( messageString,80,<span class="stringliteral">&quot;upper bound no. %d.&quot;</span>, BC_idx );
<a name="l05515"></a>05515                                 <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea586818f37876f1823e68e0dbbc944811">RET_ADD_TO_ACTIVESET</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l05516"></a>05516 <span class="preprocessor">                                #endif</span>
<a name="l05517"></a>05517 <span class="preprocessor"></span>
<a name="l05518"></a>05518                                 returnvalue = <a class="code" href="classQProblem.html#abaeb7f9dc975f9c19342d1f846ee4e24">addBound</a>( BC_idx,BC_status,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> );
<a name="l05519"></a>05519                                 <span class="keywordflow">if</span> ( returnvalue == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaa05e2c81a7cd42017cb24d782c14fcaf">RET_ADDBOUND_FAILED_INFEASIBILITY</a> )
<a name="l05520"></a>05520                                         <span class="keywordflow">return</span> returnvalue;
<a name="l05521"></a>05521                                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05522"></a>05522                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea80918441c8f157b07cd0b40ed5cd9bd8">RET_ADD_TO_ACTIVESET_FAILED</a> );
<a name="l05523"></a>05523                         }
<a name="l05524"></a>05524                         <span class="keywordflow">else</span>
<a name="l05525"></a>05525                         {
<a name="l05526"></a>05526 <span class="preprocessor">                                #ifndef __XPCTARGET__</span>
<a name="l05527"></a>05527 <span class="preprocessor"></span>                                <span class="keywordflow">if</span> ( BC_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a> )
<a name="l05528"></a>05528                                         snprintf( messageString,80,<span class="stringliteral">&quot;lower constraint&#39;s bound no. %d.&quot;</span>, BC_idx );
<a name="l05529"></a>05529                                 <span class="keywordflow">else</span>
<a name="l05530"></a>05530                                         snprintf( messageString,80,<span class="stringliteral">&quot;upper constraint&#39;s bound no. %d.&quot;</span>, BC_idx );
<a name="l05531"></a>05531                                 <a class="code" href="MessageHandling_8hpp.html#aaa22c4eae12c4dd65bdb0459ba26e372">getGlobalMessageHandler</a>( )-&gt;<a class="code" href="classMessageHandling.html#a57fafea776d1d7be7a36676a7396aabe">throwInfo</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea586818f37876f1823e68e0dbbc944811">RET_ADD_TO_ACTIVESET</a>,messageString,<a class="code" href="MessageHandling_8hpp.html#a828bb1dfda1afd67ca795075903d227d">__FUNCTION__</a>,<a class="code" href="MessageHandling_8hpp.html#a2f6bd616afd004b1ce994c2ba2ac9937">__FILE__</a>,<a class="code" href="MessageHandling_8hpp.html#adbfa1be789063f1c21478696be51bb70">__LINE__</a>,<a class="code" href="Types_8hpp.html#a36503475bb1fea0a7fd7087259ee63c1a3ff036f60aca3f1da826be88496d219b">VS_VISIBLE</a> );
<a name="l05532"></a>05532 <span class="preprocessor">                                #endif</span>
<a name="l05533"></a>05533 <span class="preprocessor"></span>
<a name="l05534"></a>05534                                 returnvalue = <a class="code" href="classQProblem.html#a9afd51a8349533f7ff5467518c761529">addConstraint</a>( BC_idx,BC_status,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> );
<a name="l05535"></a>05535                                 <span class="keywordflow">if</span> ( returnvalue == <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea953528526fd257edbe17b3965b43d236">RET_ADDCONSTRAINT_FAILED_INFEASIBILITY</a> )
<a name="l05536"></a>05536                                         <span class="keywordflow">return</span> returnvalue;
<a name="l05537"></a>05537                                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05538"></a>05538                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea80918441c8f157b07cd0b40ed5cd9bd8">RET_ADD_TO_ACTIVESET_FAILED</a> );
<a name="l05539"></a>05539                         }
<a name="l05540"></a>05540         }
<a name="l05541"></a>05541 
<a name="l05542"></a>05542         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05543"></a>05543 }
<a name="l05544"></a>05544 
<a name="l05545"></a>05545 
<a name="l05546"></a>05546 
<a name="l05547"></a>05547 <span class="comment">/*</span>
<a name="l05548"></a>05548 <span class="comment"> * r e l a t i v e H o m o t o p y L e n g t h</span>
<a name="l05549"></a>05549 <span class="comment"> */</span>
<a name="l05550"></a><a class="code" href="classQProblem.html#ac9bd93c9a1eaaacdac0b61d36262f650">05550</a> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> <a class="code" href="classQProblem.html#ac9bd93c9a1eaaacdac0b61d36262f650">QProblem::relativeHomotopyLength</a>(        <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> g_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lb_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ub_new,
<a name="l05551"></a>05551                                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lbA_new, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ubA_new)
<a name="l05552"></a>05552 {
<a name="l05553"></a>05553         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( ), i;
<a name="l05554"></a>05554         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> len = <a class="code" href="classQProblem.html#ac9bd93c9a1eaaacdac0b61d36262f650">QProblemB::relativeHomotopyLength</a>(g_new, lb_new, ub_new);
<a name="l05555"></a>05555         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> d, s;
<a name="l05556"></a>05556 
<a name="l05557"></a>05557         <span class="comment">/* lower constraint bounds */</span>
<a name="l05558"></a>05558         <span class="keywordflow">for</span> (i = 0; i &lt; nC &amp;&amp; lbA_new; i++)
<a name="l05559"></a>05559         {
<a name="l05560"></a>05560                 s = fabs(lbA_new[i]);
<a name="l05561"></a>05561                 <span class="keywordflow">if</span> (s &lt; 1.0) s = 1.0;
<a name="l05562"></a>05562                 d = fabs(lbA_new[i] - <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i]) / s;
<a name="l05563"></a>05563                 <span class="keywordflow">if</span> (d &gt; len) len = d;
<a name="l05564"></a>05564         }
<a name="l05565"></a>05565 
<a name="l05566"></a>05566         <span class="comment">/* upper constraint bounds */</span>
<a name="l05567"></a>05567         <span class="keywordflow">for</span> (i = 0; i &lt; nC &amp;&amp; ubA_new; i++)
<a name="l05568"></a>05568         {
<a name="l05569"></a>05569                 s = fabs(ubA_new[i]);
<a name="l05570"></a>05570                 <span class="keywordflow">if</span> (s &lt; 1.0) s = 1.0;
<a name="l05571"></a>05571                 d = fabs(ubA_new[i] - <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i]) / s;
<a name="l05572"></a>05572                 <span class="keywordflow">if</span> (d &gt; len) len = d;
<a name="l05573"></a>05573         }
<a name="l05574"></a>05574 
<a name="l05575"></a>05575         <span class="keywordflow">return</span> len;
<a name="l05576"></a>05576 }
<a name="l05577"></a>05577 
<a name="l05578"></a>05578 
<a name="l05579"></a>05579 <span class="comment">/*</span>
<a name="l05580"></a>05580 <span class="comment"> * p e r f o r m R a m p i n g</span>
<a name="l05581"></a>05581 <span class="comment"> */</span>
<a name="l05582"></a><a class="code" href="classQProblem.html#a1905b766c096a2dded5927a9e9824b65">05582</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a1905b766c096a2dded5927a9e9824b65">QProblem::performRamping</a>( )
<a name="l05583"></a>05583 {
<a name="l05584"></a>05584         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( ), nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( ), bstat, cstat, i, nRamp;
<a name="l05585"></a>05585         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> tP, rampValP, tD, rampValD, sca;
<a name="l05586"></a>05586 
<a name="l05587"></a>05587         <span class="comment">/* compute number of values in ramp */</span>
<a name="l05588"></a>05588         nRamp = nV + nC + nC + nV;
<a name="l05589"></a>05589         
<a name="l05590"></a>05590         <span class="comment">/* ramp inactive variable bounds and active dual bound variables */</span>
<a name="l05591"></a>05591         <span class="keywordflow">for</span> (i = 0; i &lt; nV; i++)
<a name="l05592"></a>05592         {
<a name="l05593"></a>05593                 <span class="keywordflow">switch</span> (<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>(i))
<a name="l05594"></a>05594                 {
<a name="l05595"></a>05595                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a>: 
<a name="l05596"></a>05596                                 <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i]; <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];  <span class="comment">/* reestablish exact feasibility */</span>
<a name="l05597"></a>05597                                 <span class="keywordflow">continue</span>; 
<a name="l05598"></a>05598 
<a name="l05599"></a>05599                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3ad2ba0f85d1cc4d5ee72baabed496af36">ST_BOUNDED</a>:
<a name="l05600"></a>05600                                 tP = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((i+<a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % nRamp) / <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>(nRamp-1);
<a name="l05601"></a>05601                                 rampValP = (1.0-tP) * <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a> + tP * <a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a>;
<a name="l05602"></a>05602                                 tD = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((nV+nC+nC+i+<a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % nRamp) / <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>(nRamp-1);
<a name="l05603"></a>05603                                 rampValD = (1.0-tD) * <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a> + tD * <a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a>;
<a name="l05604"></a>05604                                 bstat = <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(i);
<a name="l05605"></a>05605                                 <span class="keywordflow">if</span> (bstat != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>) { sca = fmax(fabs(<a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i]), 1.0); <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] - sca * rampValP; }
<a name="l05606"></a>05606                                 <span class="keywordflow">if</span> (bstat != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>) { sca = fmax(fabs(<a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i]), 1.0); <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i] + sca * rampValP; }
<a name="l05607"></a>05607                                 <span class="keywordflow">if</span> (bstat == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>) { <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i]; <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] = +rampValD; }
<a name="l05608"></a>05608                                 <span class="keywordflow">if</span> (bstat == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>) { <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i]; <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] = -rampValD; }
<a name="l05609"></a>05609                                 <span class="keywordflow">if</span> (bstat == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>) <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] = 0.0; <span class="comment">/* reestablish exact complementarity */</span>
<a name="l05610"></a>05610                                 <span class="keywordflow">break</span>;
<a name="l05611"></a>05611                                 
<a name="l05612"></a>05612                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a>: 
<a name="l05613"></a>05613                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a0dee93bdee24d1a0823663359cb5f448">ST_DISABLED</a>:
<a name="l05614"></a>05614                         <span class="keywordflow">default</span>: 
<a name="l05615"></a>05615                                  <span class="keywordflow">continue</span>;
<a name="l05616"></a>05616                 }
<a name="l05617"></a>05617         }
<a name="l05618"></a>05618 
<a name="l05619"></a>05619         <span class="comment">/* ramp inactive constraints and active dual constraint variables */</span>
<a name="l05620"></a>05620         <span class="keywordflow">for</span> (i = 0; i &lt; nC; i++)
<a name="l05621"></a>05621         {
<a name="l05622"></a>05622                 <span class="keywordflow">switch</span> (<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a>(i))
<a name="l05623"></a>05623                 {
<a name="l05624"></a>05624                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a>: 
<a name="l05625"></a>05625                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i]; <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i];  <span class="comment">/* reestablish exact feasibility */</span>
<a name="l05626"></a>05626                                 <span class="keywordflow">continue</span>; 
<a name="l05627"></a>05627                                                         
<a name="l05628"></a>05628                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3ad2ba0f85d1cc4d5ee72baabed496af36">ST_BOUNDED</a>:
<a name="l05629"></a>05629                                 tP = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((nV+i+<a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % nRamp) / <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>(nRamp-1);
<a name="l05630"></a>05630                                 rampValP = (1.0-tP) * <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a> + tP * <a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a>;
<a name="l05631"></a>05631                                 tD = <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>((nV+nC+i+<a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>) % nRamp) / <span class="keyword">static_cast&lt;</span><a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a><span class="keyword">&gt;</span>(nRamp-1);
<a name="l05632"></a>05632                                 rampValD = (1.0-tD) * <a class="code" href="classQProblemB.html#ac26a4dc4501ff1d6249631ea24e98d4c">ramp0</a> + tD * <a class="code" href="classQProblemB.html#ac3741a9c8073cbb90b2fa071f10930b6">ramp1</a>;
<a name="l05633"></a>05633                                 cstat = <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>(i);
<a name="l05634"></a>05634                                 <span class="keywordflow">if</span> (cstat != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>) { sca = fmax(fabs(<a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i]), 1.0); <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i] - sca * rampValP; }
<a name="l05635"></a>05635                                 <span class="keywordflow">if</span> (cstat != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>) { sca = fmax(fabs(<a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i]), 1.0); <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i] + sca * rampValP; }
<a name="l05636"></a>05636                                 <span class="keywordflow">if</span> (cstat == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>) { <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i]; <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+i] = +rampValD; }
<a name="l05637"></a>05637                                 <span class="keywordflow">if</span> (cstat == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>) { <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i]; <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+i] = -rampValD; }
<a name="l05638"></a>05638                                 <span class="keywordflow">if</span> (cstat == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>) <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+i] = 0.0; <span class="comment">/* reestablish exact complementarity */</span>
<a name="l05639"></a>05639                                         
<a name="l05640"></a>05640                                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i] - <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i];
<a name="l05641"></a>05641                                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] = <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] - <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i];
<a name="l05642"></a>05642                                 <span class="keywordflow">break</span>;
<a name="l05643"></a>05643 
<a name="l05644"></a>05644                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a>: 
<a name="l05645"></a>05645                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a0dee93bdee24d1a0823663359cb5f448">ST_DISABLED</a>: 
<a name="l05646"></a>05646                         <span class="keywordflow">default</span>: 
<a name="l05647"></a>05647                                 <span class="keywordflow">continue</span>;
<a name="l05648"></a>05648                 }
<a name="l05649"></a>05649         }
<a name="l05650"></a>05650 
<a name="l05651"></a>05651         <span class="comment">/* reestablish exact stationarity */</span>
<a name="l05652"></a>05652         <a class="code" href="classQProblem.html#a20876832f9f362aa98ae9fde45713297">setupAuxiliaryQPgradient</a>( );
<a name="l05653"></a>05653 
<a name="l05654"></a>05654         <span class="comment">/* advance ramp offset to avoid Ramping cycles */</span>
<a name="l05655"></a>05655         <a class="code" href="classQProblemB.html#ad71bc98142b24dd9de4d6127b56b5f1b">rampOffset</a>++;
<a name="l05656"></a>05656 
<a name="l05657"></a>05657         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05658"></a>05658 }
<a name="l05659"></a>05659 
<a name="l05660"></a>05660 
<a name="l05661"></a>05661 <span class="comment">/*</span>
<a name="l05662"></a>05662 <span class="comment"> * p e r f o r m D r i f t C o r r e c t i o n</span>
<a name="l05663"></a>05663 <span class="comment"> */</span>
<a name="l05664"></a><a class="code" href="classQProblem.html#a3535afaf58904aa56fd17e4e49eb50aa">05664</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a3535afaf58904aa56fd17e4e49eb50aa">QProblem::performDriftCorrection</a>( )
<a name="l05665"></a>05665 {
<a name="l05666"></a>05666         <span class="keywordtype">int</span> i;
<a name="l05667"></a>05667         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a> ();
<a name="l05668"></a>05668         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a> ();
<a name="l05669"></a>05669 
<a name="l05670"></a>05670         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l05671"></a>05671         {
<a name="l05672"></a>05672                 <span class="keywordflow">switch</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a> ( i ) )
<a name="l05673"></a>05673                 {
<a name="l05674"></a>05674                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3ad2ba0f85d1cc4d5ee72baabed496af36">ST_BOUNDED</a>:
<a name="l05675"></a>05675                                 <span class="keywordflow">switch</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a> ( i ) )
<a name="l05676"></a>05676                                 {
<a name="l05677"></a>05677                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>:
<a name="l05678"></a>05678                                                 <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l05679"></a>05679                                                 <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (<a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i], <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i]);
<a name="l05680"></a>05680                                                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i], 0.0);
<a name="l05681"></a>05681                                                 <span class="keywordflow">break</span>;
<a name="l05682"></a>05682                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>:
<a name="l05683"></a>05683                                                 <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (<a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i], <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i]);
<a name="l05684"></a>05684                                                 <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l05685"></a>05685                                                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i], 0.0);
<a name="l05686"></a>05686                                                 <span class="keywordflow">break</span>;
<a name="l05687"></a>05687                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>:
<a name="l05688"></a>05688                                                 <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (<a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i], <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i]);
<a name="l05689"></a>05689                                                 <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (<a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i], <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i]);
<a name="l05690"></a>05690                                                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] = 0.0;
<a name="l05691"></a>05691                                                 <span class="keywordflow">break</span>;
<a name="l05692"></a>05692                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a>:
<a name="l05693"></a>05693                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ac8720c8c1c59b164e2661101ef805887">ST_INFEASIBLE_LOWER</a>:
<a name="l05694"></a>05694                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4aba6d460c0037c0df179a4f3843317e9a">ST_INFEASIBLE_UPPER</a>:
<a name="l05695"></a>05695                                                 <span class="keywordflow">break</span>;
<a name="l05696"></a>05696                                 }
<a name="l05697"></a>05697                                 <span class="keywordflow">break</span>;
<a name="l05698"></a>05698                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a>:
<a name="l05699"></a>05699                                 <a class="code" href="classQProblemB.html#a424f1b8c4badffef270a68a461671d44">lb</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l05700"></a>05700                                 <a class="code" href="classQProblemB.html#ae7d207471df9894e89e974b252fc341e">ub</a>[i] = <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>[i];
<a name="l05701"></a>05701                                 <span class="keywordflow">break</span>;
<a name="l05702"></a>05702                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a>:
<a name="l05703"></a>05703                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a795a8c4151ff34f7ec9fb9d39b419064">ST_UNKNOWN</a>:
<a name="l05704"></a>05704             <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a0dee93bdee24d1a0823663359cb5f448">ST_DISABLED</a>:
<a name="l05705"></a>05705                                 <span class="keywordflow">break</span>;
<a name="l05706"></a>05706                 }
<a name="l05707"></a>05707         }
<a name="l05708"></a>05708 
<a name="l05709"></a>05709         <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l05710"></a>05710         {
<a name="l05711"></a>05711                 <span class="keywordflow">switch</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a> ( i ) )
<a name="l05712"></a>05712                 {
<a name="l05713"></a>05713                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3ad2ba0f85d1cc4d5ee72baabed496af36">ST_BOUNDED</a>:
<a name="l05714"></a>05714                                 <span class="keywordflow">switch</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a> ( i ) )
<a name="l05715"></a>05715                                 {
<a name="l05716"></a>05716                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>:
<a name="l05717"></a>05717                                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i];
<a name="l05718"></a>05718                                                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] = 0.0;
<a name="l05719"></a>05719                                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (<a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i], <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i]);
<a name="l05720"></a>05720                                                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] = <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] - <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i];
<a name="l05721"></a>05721                                                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i+nV] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i+nV], 0.0);
<a name="l05722"></a>05722                                                 <span class="keywordflow">break</span>;
<a name="l05723"></a>05723                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a75adc57fce7eec5df99c4e3d373e204b">ST_UPPER</a>:
<a name="l05724"></a>05724                                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (<a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i], Ax[i]);
<a name="l05725"></a>05725                                                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] = Ax[i] - <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i];
<a name="l05726"></a>05726                                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = Ax[i];
<a name="l05727"></a>05727                                                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] = 0.0;
<a name="l05728"></a>05728                                                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i+nV] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (<a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i+nV], 0.0);
<a name="l05729"></a>05729                                                 <span class="keywordflow">break</span>;
<a name="l05730"></a>05730                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a>:
<a name="l05731"></a>05731                                                 lbA[i] = <a class="code" href="Utils_8hpp.html#aa083f5ed6e68f9cf54621ab4dc072fcf">getMin</a> (lbA[i], Ax[i]);
<a name="l05732"></a>05732                                                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] = Ax[i] - lbA[i];
<a name="l05733"></a>05733                                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="Utils_8hpp.html#a63c73c0daee32d69d1113f09e8e8825c">getMax</a> (<a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i], Ax[i]);
<a name="l05734"></a>05734                                                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] = <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] - Ax[i];
<a name="l05735"></a>05735                                                 <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i+nV] = 0.0;
<a name="l05736"></a>05736                                                 <span class="keywordflow">break</span>;
<a name="l05737"></a>05737                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a>:
<a name="l05738"></a>05738                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ac8720c8c1c59b164e2661101ef805887">ST_INFEASIBLE_LOWER</a>:
<a name="l05739"></a>05739                                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4aba6d460c0037c0df179a4f3843317e9a">ST_INFEASIBLE_UPPER</a>:
<a name="l05740"></a>05740                                                 <span class="keywordflow">break</span>;
<a name="l05741"></a>05741                                 }
<a name="l05742"></a>05742                                 <span class="keywordflow">break</span>;
<a name="l05743"></a>05743                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a>:
<a name="l05744"></a>05744                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i];
<a name="l05745"></a>05745                                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[i] = 0.0;
<a name="l05746"></a>05746                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[i];
<a name="l05747"></a>05747                                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[i] = 0.0;
<a name="l05748"></a>05748                                 <span class="keywordflow">break</span>;
<a name="l05749"></a>05749                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a9dd4eea536b458dbd9fb66950c52eb87">ST_UNBOUNDED</a>:
<a name="l05750"></a>05750                         <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a795a8c4151ff34f7ec9fb9d39b419064">ST_UNKNOWN</a>:
<a name="l05751"></a>05751             <span class="keywordflow">case</span> <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a0dee93bdee24d1a0823663359cb5f448">ST_DISABLED</a>:
<a name="l05752"></a>05752                                 <span class="keywordflow">break</span>;
<a name="l05753"></a>05753                 }
<a name="l05754"></a>05754         }
<a name="l05755"></a>05755 
<a name="l05756"></a>05756         <a class="code" href="classQProblem.html#a20876832f9f362aa98ae9fde45713297">setupAuxiliaryQPgradient</a>( );
<a name="l05757"></a>05757 
<a name="l05758"></a>05758         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05759"></a>05759 }
<a name="l05760"></a>05760 
<a name="l05761"></a>05761 <span class="comment">/*</span>
<a name="l05762"></a>05762 <span class="comment"> *      s e t u p A u x i l i a r y Q P</span>
<a name="l05763"></a>05763 <span class="comment"> */</span>
<a name="l05764"></a><a class="code" href="classQProblem.html#af76db9fd0aa230001e11b5c86bbfbae9">05764</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#af76db9fd0aa230001e11b5c86bbfbae9">QProblem::setupAuxiliaryQP</a>( <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> guessedBounds, <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> guessedConstraints )
<a name="l05765"></a>05765 {
<a name="l05766"></a>05766         <span class="keywordtype">int</span> i, j;
<a name="l05767"></a>05767         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l05768"></a>05768         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l05769"></a>05769 
<a name="l05770"></a>05770         <span class="comment">/* consistency check */</span>
<a name="l05771"></a>05771         <span class="keywordflow">if</span> ( ( guessedBounds == 0 ) || ( guessedConstraints == 0 ) )
<a name="l05772"></a>05772                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l05773"></a>05773 
<a name="l05774"></a>05774         <span class="comment">/* nothing to do */</span>
<a name="l05775"></a>05775         <span class="keywordflow">if</span> ( ( guessedBounds == &amp;<a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a> ) &amp;&amp; ( guessedConstraints == &amp;<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a> ) )
<a name="l05776"></a>05776                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05777"></a>05777 
<a name="l05778"></a>05778         <a class="code" href="classQProblemB.html#acc7ad0699dc78f9376ac5d5e84517b47">status</a> = <a class="code" href="Types_8hpp.html#a8d5ce5a92124dc0106a5720f6d9a5abdac5afc0889e446a94b965bff2b1e823d6">QPS_PREPARINGAUXILIARYQP</a>;
<a name="l05779"></a>05779 
<a name="l05780"></a>05780 
<a name="l05781"></a>05781         <span class="comment">/* I) SETUP WORKING SET ... */</span>
<a name="l05782"></a>05782         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a651ca5acf98ea0d707ecfa33bee8e2a6">shallRefactorise</a>( guessedBounds,guessedConstraints ) == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l05783"></a>05783         {
<a name="l05784"></a>05784                 <span class="comment">/* ... WITH REFACTORISATION: */</span>
<a name="l05785"></a>05785                 <span class="comment">/* 1) Reset bounds/constraints ... */</span>
<a name="l05786"></a>05786                 <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a11440ef91a144d38738d0d979ee8e9e3">init</a>( nV );
<a name="l05787"></a>05787                 <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a953ff0d47d33a2ed94587316a803b978">init</a>( nC );
<a name="l05788"></a>05788 
<a name="l05789"></a>05789                 <span class="comment">/*    ... and set them up afresh. */</span>
<a name="l05790"></a>05790                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#af024ebec53f988671f24ee98e71394a1">setupSubjectToType</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05791"></a>05791                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l05792"></a>05792 
<a name="l05793"></a>05793                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#ae2f0eb4f34eb9a16b7d036ce23fa7ad0">setupAllFree</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05794"></a>05794                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l05795"></a>05795 
<a name="l05796"></a>05796                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#ac49c5bae8433f8c6623e55088f33d226">setupAllInactive</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05797"></a>05797                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l05798"></a>05798 
<a name="l05799"></a>05799                 <span class="comment">/* 2) Setup TQ factorisation. */</span>
<a name="l05800"></a>05800                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a08d6dfbf81516910e5d7af60f4f67faa">setupTQfactorisation</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05801"></a>05801                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l05802"></a>05802 
<a name="l05803"></a>05803                 <span class="comment">/* 3) Setup guessed working sets afresh. */</span>
<a name="l05804"></a>05804                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a1779e923a5f84cdddd33bbe38735f58c">setupAuxiliaryWorkingSet</a>( guessedBounds,guessedConstraints,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05805"></a>05805                         <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l05806"></a>05806 
<a name="l05807"></a>05807                 <span class="comment">/* 4) Computes Cholesky decomposition of projected Hessian</span>
<a name="l05808"></a>05808 <span class="comment">                 *    This now handles all special cases (no active bounds/constraints, no nullspace) */</span>
<a name="l05809"></a>05809                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a8587edd6e4cb55879d84a5297c4896fd">setupCholeskyDecompositionProjected</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05810"></a>05810                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l05811"></a>05811         }
<a name="l05812"></a>05812         <span class="keywordflow">else</span>
<a name="l05813"></a>05813         {
<a name="l05814"></a>05814                 <span class="comment">/* ... WITHOUT REFACTORISATION: */</span>
<a name="l05815"></a>05815                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a1779e923a5f84cdddd33bbe38735f58c">setupAuxiliaryWorkingSet</a>( guessedBounds,guessedConstraints,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05816"></a>05816                         <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l05817"></a>05817         }
<a name="l05818"></a>05818 
<a name="l05819"></a>05819 
<a name="l05820"></a>05820         <span class="comment">/* II) SETUP AUXILIARY QP DATA: */</span>
<a name="l05821"></a>05821         <span class="comment">/* 1) Ensure that dual variable is zero for fixed bounds and active constraints. */</span>
<a name="l05822"></a>05822         <span class="keywordflow">for</span> ( i=0; i&lt;nV; ++i )
<a name="l05823"></a>05823                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> )
<a name="l05824"></a>05824                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[i] = 0.0;
<a name="l05825"></a>05825 
<a name="l05826"></a>05826         <span class="keywordflow">for</span> ( i=0; i&lt;nC; ++i )
<a name="l05827"></a>05827                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> )
<a name="l05828"></a>05828                         <a class="code" href="classQProblemB.html#a3fcf4f7abdb0189fd304e6bd31431d4f">y</a>[nV+i] = 0.0;
<a name="l05829"></a>05829 
<a name="l05830"></a>05830         <span class="comment">/* 2) Setup gradient and (constraints&#39;) bound vectors. */</span>
<a name="l05831"></a>05831         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a20876832f9f362aa98ae9fde45713297">setupAuxiliaryQPgradient</a>( ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05832"></a>05832                 <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l05833"></a>05833 
<a name="l05834"></a>05834         <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#aab443ceb9e4e37d3efca65f446872dc2">times</a>(1, 1.0, <a class="code" href="classQProblemB.html#af5f392cdcebe7abe2fc827929e8cfe3b">x</a>, nV, 0.0, <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>, nC);
<a name="l05835"></a>05835         <span class="keywordflow">for</span> ( j=0; j&lt;nC; ++j )
<a name="l05836"></a>05836         {
<a name="l05837"></a>05837                 <a class="code" href="classQProblem.html#a79c7d319fdd782c617728eaf260d15c9">Ax_l</a>[j] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[j];
<a name="l05838"></a>05838                 <a class="code" href="classQProblem.html#a0aed3f7b675010b4117c6e3cbc1a38e4">Ax_u</a>[j] = <a class="code" href="classQProblem.html#a5471677b58b0d513b546e8238c583472">Ax</a>[j];
<a name="l05839"></a>05839         }
<a name="l05840"></a>05840 
<a name="l05841"></a>05841         <span class="comment">/* (also sets Ax_l and Ax_u) */</span>
<a name="l05842"></a>05842         <span class="keywordflow">if</span> ( <a class="code" href="classQProblem.html#a0db2ab7f578d4254353279643219a7f1">setupAuxiliaryQPbounds</a>( 0,0,<a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a> ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05843"></a>05843                 <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea5f98321449f88fd725b91988f83da87a">RET_SETUP_AUXILIARYQP_FAILED</a> );
<a name="l05844"></a>05844 
<a name="l05845"></a>05845         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05846"></a>05846 }
<a name="l05847"></a>05847 
<a name="l05848"></a>05848 
<a name="l05849"></a>05849 <span class="comment">/*</span>
<a name="l05850"></a>05850 <span class="comment"> *      s h a l l R e f a c t o r i s e</span>
<a name="l05851"></a>05851 <span class="comment"> */</span>
<a name="l05852"></a>05852 
<a name="l05853"></a><a class="code" href="classQProblem.html#a651ca5acf98ea0d707ecfa33bee8e2a6">05853</a> <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> <a class="code" href="classQProblem.html#a651ca5acf98ea0d707ecfa33bee8e2a6">QProblem::shallRefactorise</a>( <span class="keyword">const</span> <a class="code" href="classBounds.html" title="Manages working sets of bounds (= box constraints).">Bounds</a>* <span class="keyword">const</span> guessedBounds,
<a name="l05854"></a>05854                                                                                 <span class="keyword">const</span> <a class="code" href="classConstraints.html" title="Manages working sets of constraints.">Constraints</a>* <span class="keyword">const</span> guessedConstraints
<a name="l05855"></a>05855                                                                                 )<span class="keyword"> const</span>
<a name="l05856"></a>05856 <span class="keyword"></span>{
<a name="l05857"></a>05857         <span class="keywordtype">int</span> i;
<a name="l05858"></a>05858         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l05859"></a>05859         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l05860"></a>05860 
<a name="l05861"></a>05861         <span class="comment">/* always refactorise if Hessian is not known to be positive definite */</span>
<a name="l05862"></a>05862         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#acffad5ba74e516c1ebca5e67739bc107">getHessianType</a>( ) == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9a4bd6c8ccecaaf211801db7381f2361ec">HST_SEMIDEF</a> )
<a name="l05863"></a>05863                 <span class="keywordflow">return</span> <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l05864"></a>05864 
<a name="l05865"></a>05865         <span class="comment">/* 1) Determine number of bounds that have same status</span>
<a name="l05866"></a>05866 <span class="comment">         *    in guessed AND current bounds.*/</span>
<a name="l05867"></a>05867         <span class="keywordtype">int</span> differenceNumberBounds = 0;
<a name="l05868"></a>05868 
<a name="l05869"></a>05869         <span class="keywordflow">for</span>( i=0; i&lt;nV; ++i )
<a name="l05870"></a>05870                 <span class="keywordflow">if</span> ( guessedBounds-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) )
<a name="l05871"></a>05871                         ++differenceNumberBounds;
<a name="l05872"></a>05872 
<a name="l05873"></a>05873         <span class="comment">/* 2) Determine number of constraints that have same status</span>
<a name="l05874"></a>05874 <span class="comment">         *    in guessed AND current constraints.*/</span>
<a name="l05875"></a>05875         <span class="keywordtype">int</span> differenceNumberConstraints = 0;
<a name="l05876"></a>05876 
<a name="l05877"></a>05877         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l05878"></a>05878                 <span class="keywordflow">if</span> ( guessedConstraints-&gt;<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) != <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a>( i ) )
<a name="l05879"></a>05879                         ++differenceNumberConstraints;
<a name="l05880"></a>05880 
<a name="l05881"></a>05881         <span class="comment">/* 3) Decide wheter to refactorise or not. */</span>
<a name="l05882"></a>05882         <span class="keywordflow">if</span> ( 2*(differenceNumberBounds+differenceNumberConstraints) &gt; guessedConstraints-&gt;<a class="code" href="classConstraints.html#afb090a720deae4d9342e86abf45699d6">getNAC</a>( )+guessedBounds-&gt;<a class="code" href="classBounds.html#a93af6a24513cae52988646aec520bd89">getNFX</a>( ) )
<a name="l05883"></a>05883                 <span class="keywordflow">return</span> <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l05884"></a>05884         <span class="keywordflow">else</span>
<a name="l05885"></a>05885                 <span class="keywordflow">return</span> <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l05886"></a>05886 }
<a name="l05887"></a>05887 
<a name="l05888"></a>05888 
<a name="l05889"></a>05889 <span class="comment">/*</span>
<a name="l05890"></a>05890 <span class="comment"> *      s e t u p Q P d a t a</span>
<a name="l05891"></a>05891 <span class="comment"> */</span>
<a name="l05892"></a><a class="code" href="classQProblem.html#a795e8ecc363ab25f15ffaf12a9ec4040">05892</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a795e8ecc363ab25f15ffaf12a9ec4040">QProblem::setupQPdata</a>(      <a class="code" href="classSymmetricMatrix.html" title="Abstract base class for interfacing matrix-vector operations tailored to symmetric matrices...">SymmetricMatrix</a> *_H, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _g, <a class="code" href="classMatrix.html" title="Abstract base class for interfacing tailored matrix-vector operations.">Matrix</a> *_A,
<a name="l05893"></a>05893                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lb, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ub,
<a name="l05894"></a>05894                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lbA, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ubA
<a name="l05895"></a>05895                                                                         )
<a name="l05896"></a>05896 {
<a name="l05897"></a>05897         <span class="keywordtype">int</span> i;
<a name="l05898"></a>05898         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l05899"></a>05899 
<a name="l05900"></a>05900 
<a name="l05901"></a>05901         <span class="comment">/* 1) Load Hessian matrix as well as lower and upper bounds vectors. */</span>
<a name="l05902"></a>05902         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ab785215eb0f10994203a19632b715212">QProblemB::setupQPdata</a>( _H,_g,_lb,_ub ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05903"></a>05903                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l05904"></a>05904 
<a name="l05905"></a>05905         <span class="comment">/* 2) Load constraint matrix. */</span>
<a name="l05906"></a>05906         <span class="keywordflow">if</span> ( ( nC &gt; 0 ) &amp;&amp; ( _A == 0 ) )
<a name="l05907"></a>05907                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l05908"></a>05908 
<a name="l05909"></a>05909         <span class="keywordflow">if</span> ( nC &gt; 0 )
<a name="l05910"></a>05910         {
<a name="l05911"></a>05911                 <a class="code" href="classQProblem.html#afd392ee6cbfa4dd00d4941c51939e777">setA</a>( _A );
<a name="l05912"></a>05912 
<a name="l05913"></a>05913                 <span class="comment">/* 3) Setup lower constraints&#39; bounds vector. */</span>
<a name="l05914"></a>05914                 <span class="keywordflow">if</span> ( _lbA != 0 )
<a name="l05915"></a>05915                 {
<a name="l05916"></a>05916                         <a class="code" href="classQProblem.html#a48bae806d7e2703116749a6dba1f3330">setLBA</a>( _lbA );
<a name="l05917"></a>05917                 }
<a name="l05918"></a>05918                 <span class="keywordflow">else</span>
<a name="l05919"></a>05919                 {
<a name="l05920"></a>05920                         <span class="comment">/* if no lower constraints&#39; bounds are specified, set them to -infinity */</span>
<a name="l05921"></a>05921                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l05922"></a>05922                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = -<a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a>;
<a name="l05923"></a>05923                 }
<a name="l05924"></a>05924 
<a name="l05925"></a>05925                 <span class="comment">/* 4) Setup upper constraints&#39; bounds vector. */</span>
<a name="l05926"></a>05926                 <span class="keywordflow">if</span> ( _ubA != 0 )
<a name="l05927"></a>05927                 {
<a name="l05928"></a>05928                         <a class="code" href="classQProblem.html#a354fa56e3cf364846f31dcd68e3b8d02">setUBA</a>( _ubA );
<a name="l05929"></a>05929                 }
<a name="l05930"></a>05930                 <span class="keywordflow">else</span>
<a name="l05931"></a>05931                 {
<a name="l05932"></a>05932                         <span class="comment">/* if no upper constraints&#39; bounds are specified, set them to infinity */</span>
<a name="l05933"></a>05933                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l05934"></a>05934                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a>;
<a name="l05935"></a>05935                 }
<a name="l05936"></a>05936         }
<a name="l05937"></a>05937         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05938"></a>05938 }
<a name="l05939"></a>05939 
<a name="l05940"></a>05940 
<a name="l05941"></a>05941 <span class="comment">/*</span>
<a name="l05942"></a>05942 <span class="comment"> *      s e t u p Q P d a t a</span>
<a name="l05943"></a>05943 <span class="comment"> */</span>
<a name="l05944"></a><a class="code" href="classQProblem.html#a7efaf9fce5842504ec156a0254599a7f">05944</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a795e8ecc363ab25f15ffaf12a9ec4040">QProblem::setupQPdata</a>(      <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _H, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _g, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _A,
<a name="l05945"></a>05945                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lb, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ub,
<a name="l05946"></a>05946                                                                         <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _lbA, <span class="keyword">const</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> _ubA
<a name="l05947"></a>05947                                                                         )
<a name="l05948"></a>05948 {
<a name="l05949"></a>05949         <span class="keywordtype">int</span> i;
<a name="l05950"></a>05950         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l05951"></a>05951 
<a name="l05952"></a>05952 
<a name="l05953"></a>05953         <span class="comment">/* 1) Load Hessian matrix as well as lower and upper bounds vectors. */</span>
<a name="l05954"></a>05954         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#ab785215eb0f10994203a19632b715212">QProblemB::setupQPdata</a>( _H,_g,_lb,_ub ) != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l05955"></a>05955                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l05956"></a>05956 
<a name="l05957"></a>05957         <span class="comment">/* 2) Load constraint matrix. */</span>
<a name="l05958"></a>05958         <span class="keywordflow">if</span> ( ( nC &gt; 0 ) &amp;&amp; ( _A == 0 ) )
<a name="l05959"></a>05959                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l05960"></a>05960 
<a name="l05961"></a>05961         <span class="keywordflow">if</span> ( nC &gt; 0 )
<a name="l05962"></a>05962         {
<a name="l05963"></a>05963                 <a class="code" href="classQProblem.html#afd392ee6cbfa4dd00d4941c51939e777">setA</a>( _A );
<a name="l05964"></a>05964 
<a name="l05965"></a>05965                 <span class="comment">/* 3) Setup lower constraints&#39; bounds vector. */</span>
<a name="l05966"></a>05966                 <span class="keywordflow">if</span> ( _lbA != 0 )
<a name="l05967"></a>05967                 {
<a name="l05968"></a>05968                         <a class="code" href="classQProblem.html#a48bae806d7e2703116749a6dba1f3330">setLBA</a>( _lbA );
<a name="l05969"></a>05969                 }
<a name="l05970"></a>05970                 <span class="keywordflow">else</span>
<a name="l05971"></a>05971                 {
<a name="l05972"></a>05972                         <span class="comment">/* if no lower constraints&#39; bounds are specified, set them to -infinity */</span>
<a name="l05973"></a>05973                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l05974"></a>05974                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = -<a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a>;
<a name="l05975"></a>05975                 }
<a name="l05976"></a>05976 
<a name="l05977"></a>05977                 <span class="comment">/* 4) Setup upper constraints&#39; bounds vector. */</span>
<a name="l05978"></a>05978                 <span class="keywordflow">if</span> ( _ubA != 0 )
<a name="l05979"></a>05979                 {
<a name="l05980"></a>05980                         <a class="code" href="classQProblem.html#a354fa56e3cf364846f31dcd68e3b8d02">setUBA</a>( _ubA );
<a name="l05981"></a>05981                 }
<a name="l05982"></a>05982                 <span class="keywordflow">else</span>
<a name="l05983"></a>05983                 {
<a name="l05984"></a>05984                         <span class="comment">/* if no upper constraints&#39; bounds are specified, set them to infinity */</span>
<a name="l05985"></a>05985                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l05986"></a>05986                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a>;
<a name="l05987"></a>05987                 }
<a name="l05988"></a>05988         }
<a name="l05989"></a>05989 
<a name="l05990"></a>05990         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l05991"></a>05991 }
<a name="l05992"></a>05992 
<a name="l05993"></a>05993 
<a name="l05994"></a>05994 <span class="comment">/*</span>
<a name="l05995"></a>05995 <span class="comment"> *      s e t u p Q P d a t a F r o m F i l e</span>
<a name="l05996"></a>05996 <span class="comment"> */</span>
<a name="l05997"></a><a class="code" href="classQProblem.html#a080fb229af9e97e338a543de442315d5">05997</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#a080fb229af9e97e338a543de442315d5">QProblem::setupQPdataFromFile</a>(      <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> H_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> g_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> A_file,
<a name="l05998"></a>05998                                                                                         <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lb_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ub_file,
<a name="l05999"></a>05999                                                                                         <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lbA_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ubA_file
<a name="l06000"></a>06000                                                                                         )
<a name="l06001"></a>06001 {
<a name="l06002"></a>06002         <span class="keywordtype">int</span> i;
<a name="l06003"></a>06003         <span class="keywordtype">int</span> nV = <a class="code" href="classQProblemB.html#a341a93cc01d9a586ae407a6dfa9728bc">getNV</a>( );
<a name="l06004"></a>06004         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l06005"></a>06005 
<a name="l06006"></a>06006         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue;
<a name="l06007"></a>06007 
<a name="l06008"></a>06008 
<a name="l06009"></a>06009         <span class="comment">/* 1) Load Hessian matrix as well as lower and upper bounds vectors from files. */</span>
<a name="l06010"></a>06010         returnvalue = <a class="code" href="classQProblem.html#a080fb229af9e97e338a543de442315d5">QProblemB::setupQPdataFromFile</a>( H_file,g_file,lb_file,ub_file );
<a name="l06011"></a>06011         <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l06012"></a>06012                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( returnvalue );
<a name="l06013"></a>06013 
<a name="l06014"></a>06014         <span class="comment">/* 2) Load constraint matrix from file. */</span>
<a name="l06015"></a>06015         <span class="keywordflow">if</span> ( ( nC &gt; 0 ) &amp;&amp; ( A_file == 0 ) )
<a name="l06016"></a>06016                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l06017"></a>06017 
<a name="l06018"></a>06018         <span class="keywordflow">if</span> ( nC &gt; 0 )
<a name="l06019"></a>06019         {
<a name="l06020"></a>06020                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* _A = <span class="keyword">new</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>[nC * nV];
<a name="l06021"></a>06021                 returnvalue = <a class="code" href="Utils_8hpp.html#ab89740d14815571af03d5e8fea961c67">readFromFile</a>( _A, nC,nV, A_file );
<a name="l06022"></a>06022                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l06023"></a>06023                 {
<a name="l06024"></a>06024                         <span class="keyword">delete</span>[] _A;
<a name="l06025"></a>06025                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( returnvalue );
<a name="l06026"></a>06026                 }
<a name="l06027"></a>06027                 <a class="code" href="classQProblem.html#afd392ee6cbfa4dd00d4941c51939e777">setA</a>( _A );
<a name="l06028"></a>06028                 <a class="code" href="classQProblem.html#a3de8a9d6d4204c6907e19f3ceca139f2">A</a>-&gt;<a class="code" href="classMatrix.html#a9b1c0fc70cad1b88d6e6ab960bda478d">doFreeMemory</a>( );
<a name="l06029"></a>06029 
<a name="l06030"></a>06030                 <span class="comment">/* 3) Load lower constraints&#39; bounds vector from file. */</span>
<a name="l06031"></a>06031                 <span class="keywordflow">if</span> ( lbA_file != 0 )
<a name="l06032"></a>06032                 {
<a name="l06033"></a>06033                         returnvalue = <a class="code" href="Utils_8hpp.html#ab89740d14815571af03d5e8fea961c67">readFromFile</a>( <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>, nC, lbA_file );
<a name="l06034"></a>06034                         <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l06035"></a>06035                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( returnvalue );
<a name="l06036"></a>06036                 }
<a name="l06037"></a>06037                 <span class="keywordflow">else</span>
<a name="l06038"></a>06038                 {
<a name="l06039"></a>06039                         <span class="comment">/* if no lower constraints&#39; bounds are specified, set them to -infinity */</span>
<a name="l06040"></a>06040                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l06041"></a>06041                                 <a class="code" href="classQProblem.html#a9326d4986de336d9b1ee22954010e311">lbA</a>[i] = -<a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a>;
<a name="l06042"></a>06042                 }
<a name="l06043"></a>06043 
<a name="l06044"></a>06044                 <span class="comment">/* 4) Load upper constraints&#39; bounds vector from file. */</span>
<a name="l06045"></a>06045                 <span class="keywordflow">if</span> ( ubA_file != 0 )
<a name="l06046"></a>06046                 {
<a name="l06047"></a>06047                         returnvalue = <a class="code" href="Utils_8hpp.html#ab89740d14815571af03d5e8fea961c67">readFromFile</a>( <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>, nC, ubA_file );
<a name="l06048"></a>06048                         <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l06049"></a>06049                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( returnvalue );
<a name="l06050"></a>06050                 }
<a name="l06051"></a>06051                 <span class="keywordflow">else</span>
<a name="l06052"></a>06052                 {
<a name="l06053"></a>06053                         <span class="comment">/* if no upper constraints&#39; bounds are specified, set them to infinity */</span>
<a name="l06054"></a>06054                         <span class="keywordflow">for</span>( i=0; i&lt;nC; ++i )
<a name="l06055"></a>06055                                 <a class="code" href="classQProblem.html#afbb3ece123fd25bb93e9546557cc1b5d">ubA</a>[i] = <a class="code" href="Constants_8hpp.html#a90ebbbce8b8f93a5785ca4d4d19d12a6">INFTY</a>;
<a name="l06056"></a>06056                 }
<a name="l06057"></a>06057         }
<a name="l06058"></a>06058 
<a name="l06059"></a>06059         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l06060"></a>06060 }
<a name="l06061"></a>06061 
<a name="l06062"></a>06062 
<a name="l06063"></a>06063 <span class="comment">/*</span>
<a name="l06064"></a>06064 <span class="comment"> *      l o a d Q P v e c t o r s F r o m F i l e</span>
<a name="l06065"></a>06065 <span class="comment"> */</span>
<a name="l06066"></a><a class="code" href="classQProblem.html#aa9790815d74ce8e61005d130e333d6f4">06066</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aa9790815d74ce8e61005d130e333d6f4">QProblem::loadQPvectorsFromFile</a>(    <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> g_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lb_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ub_file,
<a name="l06067"></a>06067                                                                                                 <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> lbA_file, <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> ubA_file,
<a name="l06068"></a>06068                                                                                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> g_new, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lb_new, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ub_new,
<a name="l06069"></a>06069                                                                                                 <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> lbA_new, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a>* <span class="keyword">const</span> ubA_new
<a name="l06070"></a>06070                                                                                                 )<span class="keyword"> const</span>
<a name="l06071"></a>06071 <span class="keyword"></span>{
<a name="l06072"></a>06072         <span class="keywordtype">int</span> nC = <a class="code" href="classQProblem.html#a4e70a174727f034bf7957fa2bd5eada0">getNC</a>( );
<a name="l06073"></a>06073 
<a name="l06074"></a>06074         <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> returnvalue;
<a name="l06075"></a>06075 
<a name="l06076"></a>06076 
<a name="l06077"></a>06077         <span class="comment">/* 1) Load gradient vector as well as lower and upper bounds vectors from files. */</span>
<a name="l06078"></a>06078         returnvalue = <a class="code" href="classQProblem.html#aa9790815d74ce8e61005d130e333d6f4">QProblemB::loadQPvectorsFromFile</a>( g_file,lb_file,ub_file, g_new,lb_new,ub_new );
<a name="l06079"></a>06079         <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l06080"></a>06080                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( returnvalue );
<a name="l06081"></a>06081 
<a name="l06082"></a>06082         <span class="keywordflow">if</span> ( nC &gt; 0 )
<a name="l06083"></a>06083         {
<a name="l06084"></a>06084                 <span class="comment">/* 2) Load lower constraints&#39; bounds vector from file. */</span>
<a name="l06085"></a>06085                 <span class="keywordflow">if</span> ( lbA_file != 0 )
<a name="l06086"></a>06086                 {
<a name="l06087"></a>06087                         <span class="keywordflow">if</span> ( lbA_new != 0 )
<a name="l06088"></a>06088                         {
<a name="l06089"></a>06089                                 returnvalue = <a class="code" href="Utils_8hpp.html#ab89740d14815571af03d5e8fea961c67">readFromFile</a>( lbA_new, nC, lbA_file );
<a name="l06090"></a>06090                                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l06091"></a>06091                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( returnvalue );
<a name="l06092"></a>06092                         }
<a name="l06093"></a>06093                         <span class="keywordflow">else</span>
<a name="l06094"></a>06094                         {
<a name="l06095"></a>06095                                 <span class="comment">/* If filename is given, storage must be provided! */</span>
<a name="l06096"></a>06096                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l06097"></a>06097                         }
<a name="l06098"></a>06098                 }
<a name="l06099"></a>06099 
<a name="l06100"></a>06100                 <span class="comment">/* 3) Load upper constraints&#39; bounds vector from file. */</span>
<a name="l06101"></a>06101                 <span class="keywordflow">if</span> ( ubA_file != 0 )
<a name="l06102"></a>06102                 {
<a name="l06103"></a>06103                         <span class="keywordflow">if</span> ( ubA_new != 0 )
<a name="l06104"></a>06104                         {
<a name="l06105"></a>06105                                 returnvalue = <a class="code" href="Utils_8hpp.html#ab89740d14815571af03d5e8fea961c67">readFromFile</a>( ubA_new, nC, ubA_file );
<a name="l06106"></a>06106                                 <span class="keywordflow">if</span> ( returnvalue != <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a> )
<a name="l06107"></a>06107                                         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( returnvalue );
<a name="l06108"></a>06108                         }
<a name="l06109"></a>06109                         <span class="keywordflow">else</span>
<a name="l06110"></a>06110                         {
<a name="l06111"></a>06111                                 <span class="comment">/* If filename is given, storage must be provided! */</span>
<a name="l06112"></a>06112                                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l06113"></a>06113                         }
<a name="l06114"></a>06114                 }
<a name="l06115"></a>06115         }
<a name="l06116"></a>06116 
<a name="l06117"></a>06117         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l06118"></a>06118 }
<a name="l06119"></a>06119 
<a name="l06120"></a>06120 
<a name="l06121"></a>06121 <span class="comment">/*</span>
<a name="l06122"></a>06122 <span class="comment"> *      p r i n t I t e r a t i o n</span>
<a name="l06123"></a>06123 <span class="comment"> */</span>
<a name="l06124"></a><a class="code" href="classQProblem.html#aa42a85afe05309ac3860e44f5bb02864">06124</a> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a> <a class="code" href="classQProblem.html#aa42a85afe05309ac3860e44f5bb02864">QProblem::printIteration</a>(   <span class="keywordtype">int</span> iteration,
<a name="l06125"></a>06125                                                                                 <span class="keywordtype">int</span> BC_idx,     <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> BC_status, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> BC_isBound
<a name="l06126"></a>06126                                                                                 )
<a name="l06127"></a>06127 {
<a name="l06128"></a>06128 <span class="preprocessor">        #ifndef __XPCTARGET__</span>
<a name="l06129"></a>06129 <span class="preprocessor"></span>        <span class="keywordtype">char</span> myPrintfString[80];
<a name="l06130"></a>06130         <span class="keywordtype">char</span> info[8];
<a name="l06131"></a>06131 
<a name="l06132"></a>06132         <span class="comment">/* consistency check */</span>
<a name="l06133"></a>06133         <span class="keywordflow">if</span> ( iteration &lt; 0 )
<a name="l06134"></a>06134                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a8bc2bee847b74e80aeb52a1375945ed4">THROWERROR</a>( <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea85fb8027157a2c6713c2f7c9b9d93bc6">RET_INVALID_ARGUMENTS</a> );
<a name="l06135"></a>06135 
<a name="l06136"></a>06136         <span class="comment">/* nothing to do */</span>
<a name="l06137"></a>06137         <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a3c7327943ce25f36479356d33a0b0723">printLevel</a> != <a class="code" href="Types_8hpp.html#a83ff212f474e3669d8fac2d727f65de5ad4184c636ebb71d54bd55080e3e5a4a4">PL_MEDIUM</a> )
<a name="l06138"></a>06138                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l06139"></a>06139 
<a name="l06140"></a>06140 
<a name="l06141"></a>06141         <span class="comment">/* 1) Print header at first iteration. */</span>
<a name="l06142"></a>06142         <span class="keywordflow">if</span> ( iteration == 0 )
<a name="l06143"></a>06143         {
<a name="l06144"></a>06144                 snprintf( myPrintfString,80,<span class="stringliteral">&quot;\n\n####################   qpOASES  --  QP NO. %3.0d   #####################\n\n&quot;</span>, <a class="code" href="classQProblemB.html#acd42fb385651070ee34d7ad7802e924b">count</a> );
<a name="l06145"></a>06145                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( myPrintfString );
<a name="l06146"></a>06146 
<a name="l06147"></a>06147                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot;    Iter   |    StepLength    |       Info       |   nFX   |   nAC    \n&quot;</span> );
<a name="l06148"></a>06148                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( <span class="stringliteral">&quot; ----------+------------------+------------------+---------+--------- \n&quot;</span> );
<a name="l06149"></a>06149         }
<a name="l06150"></a>06150 
<a name="l06151"></a>06151         <span class="comment">/* 2) Print iteration line. */</span>
<a name="l06152"></a>06152         <span class="keywordflow">if</span> ( BC_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4af5b09f89acd9d344989c2e5eed019ccb">ST_UNDEFINED</a> )
<a name="l06153"></a>06153         {
<a name="l06154"></a>06154                 <span class="keywordflow">if</span> ( <a class="code" href="classQProblemB.html#af288e4e7320b9c47c2c95a230cedcbf4">hessianType</a> == <a class="code" href="Types_8hpp.html#a604cad5cda14e378ce4a77ab28ee9fd9aa41daece61bf96c425863731850060bb">HST_ZERO</a> )
<a name="l06155"></a>06155                         snprintf( info,3,<span class="stringliteral">&quot;LP&quot;</span> );
<a name="l06156"></a>06156                 <span class="keywordflow">else</span>
<a name="l06157"></a>06157                         snprintf( info,3,<span class="stringliteral">&quot;QP&quot;</span> );
<a name="l06158"></a>06158 
<a name="l06159"></a>06159                 snprintf( myPrintfString,80,<span class="stringliteral">&quot;   %5.1d   |   %1.6e   |    %s SOLVED     |  %4.1d   |  %4.1d   \n&quot;</span>, iteration,<a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>,info,<a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>( ),<a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( ) );
<a name="l06160"></a>06160                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( myPrintfString );
<a name="l06161"></a>06161         }
<a name="l06162"></a>06162         <span class="keywordflow">else</span>
<a name="l06163"></a>06163         {
<a name="l06164"></a>06164                 <span class="keywordflow">if</span> ( BC_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4a830e6b358e8a1fe88b26cb221883eacf">ST_INACTIVE</a> )
<a name="l06165"></a>06165                         snprintf( info,5,<span class="stringliteral">&quot;REM &quot;</span> );
<a name="l06166"></a>06166                 <span class="keywordflow">else</span>
<a name="l06167"></a>06167                         snprintf( info,5,<span class="stringliteral">&quot;ADD &quot;</span> );
<a name="l06168"></a>06168 
<a name="l06169"></a>06169                 <span class="keywordflow">if</span> ( BC_isBound == <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a> )
<a name="l06170"></a>06170                         snprintf( &amp;(info[4]),4,<span class="stringliteral">&quot;BND&quot;</span> );
<a name="l06171"></a>06171                 <span class="keywordflow">else</span>
<a name="l06172"></a>06172                         snprintf( &amp;(info[4]),4,<span class="stringliteral">&quot;CON&quot;</span> );
<a name="l06173"></a>06173 
<a name="l06174"></a>06174                 snprintf( myPrintfString,80,<span class="stringliteral">&quot;   %5.1d   |   %1.6e   |   %s %4.1d   |  %4.1d   |  %4.1d   \n&quot;</span>, iteration,<a class="code" href="classQProblemB.html#a382545a2e9cf4591bf372c9297cac294">tau</a>,info,BC_idx,<a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a>( ),<a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a>( ) );
<a name="l06175"></a>06175                 <a class="code" href="Utils_8hpp.html#a03be15fd21d365895333869e3b08446a">myPrintf</a>( myPrintfString );
<a name="l06176"></a>06176         }
<a name="l06177"></a>06177 <span class="preprocessor">        #endif</span>
<a name="l06178"></a>06178 <span class="preprocessor"></span>
<a name="l06179"></a>06179         <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l06180"></a>06180 }
<a name="l06181"></a>06181 
<a name="l06182"></a>06182 
<a name="l06183"></a>06183 
<a name="l06184"></a>06184 
<a name="l06185"></a><a class="code" href="QProblem_8cpp.html#ae7e439b5726e27e54eb619e7d053d1f1">06185</a> <span class="keyword">inline</span> <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> <a class="code" href="QProblem_8cpp.html#ae7e439b5726e27e54eb619e7d053d1f1">abs</a> (<a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> x) { <span class="keywordflow">return</span> (x&gt;0)?x:-x; }
<a name="l06186"></a>06186 
<a name="l06187"></a>06187 <span class="comment">/*</span>
<a name="l06188"></a>06188 <span class="comment"> * d r o p I n f e a s i b l e s</span>
<a name="l06189"></a>06189 <span class="comment"> */</span>
<a name="l06190"></a>06190 <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865e" title="Defines all symbols for global return values.">returnValue</a>
<a name="l06191"></a><a class="code" href="classQProblem.html#adbc81cf7d22c43f5e8459129443abc5a">06191</a> <a class="code" href="classQProblem.html#adbc81cf7d22c43f5e8459129443abc5a">QProblem::dropInfeasibles</a> ( <span class="keywordtype">int</span> BC_number, <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> BC_status, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> BC_isBound,
<a name="l06192"></a>06192                                                         <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *xiB, <a class="code" href="Types_8hpp.html#acfbb1546e581bff0de2fa030397dc14d">real_t</a> *xiC )
<a name="l06193"></a>06193 {
<a name="l06194"></a>06194         <span class="keywordtype">int</span> i;
<a name="l06195"></a>06195         
<a name="l06196"></a>06196         <span class="keywordtype">int</span> nAC                   = <a class="code" href="classQProblem.html#acf6cd80502cceb8f71cbee522260a969">getNAC</a> ();
<a name="l06197"></a>06197         <span class="keywordtype">int</span> nFX                   = <a class="code" href="classQProblemB.html#a4fabb68b173c50bf9fb66e015d8248d6">getNFX</a> ();  
<a name="l06198"></a>06198         <span class="keywordtype">int</span> blockingPriority      = (BC_isBound) ? <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a09b31fc2cc40a0d247688f2cf9d054e8">dropBoundPriority</a> : <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a995f6bd60c5010f5e1c08c5b490485c9">dropIneqConPriority</a>;
<a name="l06199"></a>06199         <span class="keywordtype">int</span> y_min_number          = -1;
<a name="l06200"></a>06200         <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089">BooleanType</a> y_min_isBound = BC_isBound;
<a name="l06201"></a>06201         <span class="keywordtype">int</span> y_min_priority        = blockingPriority;
<a name="l06202"></a>06202 
<a name="l06203"></a>06203         <span class="keywordtype">int</span>* AC_idx;
<a name="l06204"></a>06204         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classConstraints.html#a91743d77bd6720905b9ba75c9fe9c4cf">getActive</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;AC_idx );
<a name="l06205"></a>06205 
<a name="l06206"></a>06206         <span class="keywordtype">int</span>* FX_idx;
<a name="l06207"></a>06207         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classBounds.html#a1819c61019c2b76a77336ac3159759ad">getFixed</a>( )-&gt;<a class="code" href="classIndexlist.html#a0db44282494b4986dc25a5f82acc6255">getNumberArray</a>( &amp;FX_idx );
<a name="l06208"></a>06208         
<a name="l06209"></a>06209         <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aab5750d7a7a8d6da2f151b15f15b93bd">dropEqConPriority</a> &lt;= y_min_priority) 
<a name="l06210"></a>06210         {
<a name="l06211"></a>06211                 <span class="comment">// look for an equality constraint we can drop according to priorities</span>
<a name="l06212"></a>06212                 <span class="keywordflow">for</span> ( i = 0; i &lt; nAC; ++i )
<a name="l06213"></a>06213                         <span class="keywordflow">if</span> ( (<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a> (i) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3a083507944ba3aedb928a8e625459aae0">ST_EQUALITY</a>)
<a name="l06214"></a>06214                                 &amp;&amp; (<a class="code" href="QProblem_8cpp.html#ae7e439b5726e27e54eb619e7d053d1f1">abs</a> (xiC[i]) &gt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>) ) 
<a name="l06215"></a>06215                         {
<a name="l06216"></a>06216                                 y_min_number = AC_idx[i];
<a name="l06217"></a>06217                                 y_min_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l06218"></a>06218                                 y_min_priority = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#aab5750d7a7a8d6da2f151b15f15b93bd">dropEqConPriority</a>;
<a name="l06219"></a>06219                                 <span class="keywordflow">break</span>;
<a name="l06220"></a>06220                         }
<a name="l06221"></a>06221         }
<a name="l06222"></a>06222         
<a name="l06223"></a>06223         <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a995f6bd60c5010f5e1c08c5b490485c9">dropIneqConPriority</a> &lt;= y_min_priority) 
<a name="l06224"></a>06224         {
<a name="l06225"></a>06225                 <span class="comment">// look for an inequality constraint we can drop according to priorities</span>
<a name="l06226"></a>06226                 <span class="keywordflow">for</span> ( i = 0; i &lt; nAC; ++i )
<a name="l06227"></a>06227                         <span class="keywordflow">if</span> ( (<a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#ad6f610e6185373fc9483292807575cb1">getType</a> (i) == <a class="code" href="Types_8hpp.html#a3e65c061dde41562d1aeb2c4453bf1d3ad2ba0f85d1cc4d5ee72baabed496af36">ST_BOUNDED</a>)
<a name="l06228"></a>06228                                 &amp;&amp; (<a class="code" href="QProblem_8cpp.html#ae7e439b5726e27e54eb619e7d053d1f1">abs</a> (xiC[i]) &gt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>) ) 
<a name="l06229"></a>06229                         {
<a name="l06230"></a>06230                                 y_min_number = AC_idx[i];
<a name="l06231"></a>06231                                 y_min_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>;
<a name="l06232"></a>06232                                 y_min_priority = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a995f6bd60c5010f5e1c08c5b490485c9">dropIneqConPriority</a>;
<a name="l06233"></a>06233                                 <span class="keywordflow">break</span>;
<a name="l06234"></a>06234                         }
<a name="l06235"></a>06235         }
<a name="l06236"></a>06236         
<a name="l06237"></a>06237         <span class="keywordflow">if</span> (<a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a09b31fc2cc40a0d247688f2cf9d054e8">dropBoundPriority</a> &lt;= y_min_priority) 
<a name="l06238"></a>06238         {
<a name="l06239"></a>06239                 <span class="comment">// look for a simple bound we can drop according to priorities</span>
<a name="l06240"></a>06240                 <span class="keywordflow">for</span> ( i = 0; i &lt; nFX; ++i )
<a name="l06241"></a>06241                         <span class="keywordflow">if</span> (<a class="code" href="QProblem_8cpp.html#ae7e439b5726e27e54eb619e7d053d1f1">abs</a> (xiB[i]) &gt; <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a982819ac9663847af5c920416192de1b">epsDen</a>) 
<a name="l06242"></a>06242                         {
<a name="l06243"></a>06243                                 y_min_number = FX_idx[i];
<a name="l06244"></a>06244                                 y_min_isBound = <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>;
<a name="l06245"></a>06245                                 y_min_priority = <a class="code" href="classQProblemB.html#a59d8ee93443bc8e7ce509a94ff4330e6">options</a>.<a class="code" href="classOptions.html#a09b31fc2cc40a0d247688f2cf9d054e8">dropBoundPriority</a>;
<a name="l06246"></a>06246                                 <span class="keywordflow">break</span>;
<a name="l06247"></a>06247                         }
<a name="l06248"></a>06248         }
<a name="l06249"></a>06249         
<a name="l06250"></a>06250         <span class="keywordflow">if</span> (y_min_number &gt;= 0) {
<a name="l06251"></a>06251                 
<a name="l06252"></a>06252                 <span class="comment">// drop active equality or active bound we have found</span>
<a name="l06253"></a>06253                 <span class="keywordflow">if</span> (y_min_isBound) {
<a name="l06254"></a>06254                         <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> status_ = <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a> (y_min_number);
<a name="l06255"></a>06255                         <a class="code" href="classQProblem.html#a12931eb86b975a1e3b0537c94c30a290">removeBound</a> (y_min_number, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>);
<a name="l06256"></a>06256                         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a5715375aa525eea0fe5ef54b98bc3f4d">setStatus</a> (y_min_number, (status_ == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>) ? <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ac8720c8c1c59b164e2661101ef805887">ST_INFEASIBLE_LOWER</a> : <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4aba6d460c0037c0df179a4f3843317e9a">ST_INFEASIBLE_UPPER</a>);
<a name="l06257"></a>06257                         <span class="comment">// TODO: fix duals y[]</span>
<a name="l06258"></a>06258                         fprintf (stderr, <span class="stringliteral">&quot;Dropping bounds %d for %s %d\n&quot;</span>, y_min_number, BC_isBound?<span class="stringliteral">&quot;bound&quot;</span>:<span class="stringliteral">&quot;constraint&quot;</span>, BC_number);
<a name="l06259"></a>06259                 } <span class="keywordflow">else</span> {
<a name="l06260"></a>06260                         <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4">SubjectToStatus</a> status_ = <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a04ff21190d9a070f886f03918bb90eb8">getStatus</a> (y_min_number);
<a name="l06261"></a>06261                         <a class="code" href="classQProblem.html#a140f91786436fd1069e932733eba5abd">removeConstraint</a> (y_min_number, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a34c57965bfb07125b09326a69019f9c6">BT_TRUE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>, <a class="code" href="Types_8hpp.html#a20f82124c82b6f5686a7fce454ef9089a85b8a20e72a8bea5dd10a6007fe3071e">BT_FALSE</a>);
<a name="l06262"></a>06262                         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a5715375aa525eea0fe5ef54b98bc3f4d">setStatus</a> (y_min_number, (status_ == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>) ? <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ac8720c8c1c59b164e2661101ef805887">ST_INFEASIBLE_LOWER</a> : <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4aba6d460c0037c0df179a4f3843317e9a">ST_INFEASIBLE_UPPER</a>);
<a name="l06263"></a>06263                         <span class="comment">// TODO: fix duals y[]</span>
<a name="l06264"></a>06264                         fprintf (stderr, <span class="stringliteral">&quot;Dropping constraint %d for %s %d\n&quot;</span>, y_min_number, BC_isBound?<span class="stringliteral">&quot;bound&quot;</span>:<span class="stringliteral">&quot;constraint&quot;</span>, BC_number);
<a name="l06265"></a>06265                 }
<a name="l06266"></a>06266                 
<a name="l06267"></a>06267                 <span class="comment">// ... now return, add the blocking constraint, and continue solving QP with dropped bound/constraint</span>
<a name="l06268"></a>06268                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865eaec77507a25a637aa3a6650ba26875984">SUCCESSFUL_RETURN</a>;
<a name="l06269"></a>06269                 
<a name="l06270"></a>06270         } <span class="keywordflow">else</span> {
<a name="l06271"></a>06271                 
<a name="l06272"></a>06272                 <span class="comment">// nothing found, then drop the blocking (still inactive) constraint</span>
<a name="l06273"></a>06273                 <span class="keywordflow">if</span> (BC_isBound)
<a name="l06274"></a>06274                         <a class="code" href="classQProblemB.html#af0822225676e7ca195a0724a8841c4d9">bounds</a>.<a class="code" href="classSubjectTo.html#a5715375aa525eea0fe5ef54b98bc3f4d">setStatus</a> (BC_number, (BC_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>) ? <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ac8720c8c1c59b164e2661101ef805887">ST_INFEASIBLE_LOWER</a> : <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4aba6d460c0037c0df179a4f3843317e9a">ST_INFEASIBLE_UPPER</a>);
<a name="l06275"></a>06275                 <span class="keywordflow">else</span>
<a name="l06276"></a>06276                         <a class="code" href="classQProblem.html#a0b91803a820d36748ae392bf8f74de64">constraints</a>.<a class="code" href="classSubjectTo.html#a5715375aa525eea0fe5ef54b98bc3f4d">setStatus</a> (BC_number, (BC_status == <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ab8aabf121d848d6194b580b25848bdc1">ST_LOWER</a>) ? <a class="code" href="Types_8hpp.html#a70a6a40d261a015ead8d43aa589383a4ac8720c8c1c59b164e2661101ef805887">ST_INFEASIBLE_LOWER</a> : ST_INFEASIBLE_UPPER);
<a name="l06277"></a>06277                 
<a name="l06278"></a>06278                 fprintf (stderr, <span class="stringliteral">&quot;Dropping %s %d itself\n&quot;</span>, BC_isBound?<span class="stringliteral">&quot;bound&quot;</span>:<span class="stringliteral">&quot;constraint&quot;</span>, BC_number);
<a name="l06279"></a>06279                 
<a name="l06280"></a>06280                 <span class="comment">// ... now return, and continue solving QP with dropped bound/constraint</span>
<a name="l06281"></a>06281                 <span class="keywordflow">return</span> <a class="code" href="MessageHandling_8hpp.html#a81d556f613bfbabd0b1f9488c0fa865ea0671c4114677051c98f8b9ac29df192a">RET_ENSURELI_DROPPED</a>;
<a name="l06282"></a>06282         }       
<a name="l06283"></a>06283 }
<a name="l06284"></a>06284 
<a name="l06285"></a>06285 
<a name="l06286"></a>06286 <a class="code" href="Types_8hpp.html#adee2e4c0805d76ae74d10597f96dd70f">END_NAMESPACE_QPOASES</a>
<a name="l06287"></a>06287 
<a name="l06288"></a>06288 
<a name="l06289"></a>06289 <span class="comment">/*</span>
<a name="l06290"></a>06290 <span class="comment"> *      end of file</span>
<a name="l06291"></a>06291 <span class="comment"> */</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://ros.org/wiki/gdm_tdlas">gdm_tdlas</a><br />
Author(s): Victor Hernandez</br />
<small>autogenerated on Fri Jul 27 2012 16:09:56</small>
</div>
</body>
</html>
